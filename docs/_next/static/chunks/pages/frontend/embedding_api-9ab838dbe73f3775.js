(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[205],{3679:function(p,h,m){(window.__NEXT_P=window.__NEXT_P||[]).push(["/frontend/embedding_api",function(){return m(4582)}])},4582:function(p,h,m){"use strict";m.r(h),m.d(h,{__toc:function(){return A},default:function(){return w}});var g=m(5893),y=m(2673),b=m(9298),v=m(9812);m(6834);var I=m(2643),S=m(7294);m(7660);var viz=function(p){let h=(0,S.useRef)(null),[m,y]=(0,S.useState)(!1),[b,v]=(0,S.useState)("");(0,S.useEffect)(()=>{handleIsClient(),handleVizObj(),handleFirstInteractive()},[p.vizObj,m]);let handleIsClient=()=>(y(!0),()=>{y(!1)}),handleVizObj=()=>(m&&!p.vizObj&&p.setVizObj(h.current),()=>{p.vizObj&&p.setVizObj(null)}),handleFirstInteractive=()=>{if(p.vizObj)return p.vizObj.addEventListener("firstinteractive",async h=>{p.setInteractive(!0)}),()=>p.vizObj.removeEventListener("firstinteractive",async h=>{p.setInteractive(!1)})};return(0,g.jsx)(g.Fragment,{children:m?(0,g.jsx)("tableau-viz",{ref:h,id:"tableauViz",src:p.vizUrl,height:p.height,width:p.width,device:p.device,"hide-tabs":!!p.hideTabs,token:b}):(0,g.jsx)(g.Fragment,{})})},tableau=function(p){let[h,m]=(0,S.useState)(void 0),[y,b]=(0,S.useState)(!1),v="true"===p.hideTabs;return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(viz,{vizObj:h,setVizObj:m,interactive:y,setInteractive:b,vizUrl:p.vizUrl,height:p.height,width:p.width,hideTabs:v,device:p.device,toolbar:p.toolbar})})},_=m(7741);let A=[{depth:2,value:"Using the Embedding API v3",id:"using-the-embedding-api-v3"},{depth:3,value:"Join the Tableau Developer Program",id:"join-the-tableau-developer-program"},{depth:2,value:"Embedding with the JavaScript API v2",id:"embedding-with-the-javascript-api-v2"},{depth:2,value:"Use cases for the JavaScript API and the Embedding API v3",id:"use-cases-for-the-javascript-api-and-the-embedding-api-v3"},{depth:2,value:"Embedding API and JavaScript API Resources",id:"embedding-api-and-javascript-api-resources"}];function _createMdxContent(p){let h=Object.assign({h1:"h1",p:"p",hr:"hr",strong:"strong",h2:"h2",a:"a",code:"code",pre:"pre",span:"span",h3:"h3",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",em:"em"},(0,I.a)(),p.components);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(h.h1,{children:"Embedding Tableau Views"}),"\n",(0,g.jsx)(h.p,{children:"The easiest method for embedding a Tableau view (dashboard or visualization) is with the copy-paste embed code. Navigate to a view on Tableau Server and copy the Embed Code from the Share toolbar option."}),"\n",(0,g.jsx)(h.hr,{}),"\n",(0,g.jsx)(b.zu,{full:!0,children:(0,g.jsx)(tableau,{vizUrl:"https://public.tableau.com/views/Superstore_16963856246520/Overview",height:"900",width:"700",hideTabs:"true",device:"default"})}),"\n",(0,g.jsx)(h.hr,{}),"\n",(0,g.jsx)(_.Z,{alt:"sample embed",src:"/embed_code.png",width:700,height:800}),"\n",(0,g.jsxs)(h.p,{children:["Once acquired, this code can be pasted into HTML.\nThis method is useful for simple embedding, such as embedding into blogs or internal knowledge bases, but ",(0,g.jsx)(h.strong,{children:"only very simple embedding scenarios should use the embed code. Most deployments should instead use the JavaScript API v2 or the Embedding API v3."})," It is not significantly more work to embed with the JavaScript API v2 or the Embedding API v3, and doing so will gain you flexibility and power in your embedded deployment."]}),"\n",(0,g.jsx)(h.h2,{id:"using-the-embedding-api-v3",children:"Using the Embedding API v3"}),"\n",(0,g.jsxs)(h.p,{children:["The ",(0,g.jsx)(h.a,{href:"https://help.tableau.com/current/api/embedding_api/en-us/index.html",children:"Tableau Embedding API v3"})," provides the latest iteration of embedding capabilities for the front-end of your application. It features a modern approach to initializing embedded content using ",(0,g.jsx)(h.a,{href:"https://www.webcomponents.org/introduction",children:"web components"}),". The Embedding API v3 provides improved security and integration capabilities through Connected Apps or with an External Authorization Server (EAS), both based on the JWT standard. The Embedding API v3 will soon support all the functionality of the JavaScript API v2, while providing future enhancements for embedding. If you are starting a new project, we recommend using this API."]}),"\n",(0,g.jsxs)(h.p,{children:["The basic embed code using the Embedding API v3 and the ",(0,g.jsx)(h.code,{children:"<tableau-viz>"})," web component looks something like this:"]}),"\n",(0,g.jsx)(h.pre,{"data-language":"html","data-theme":"default",children:(0,g.jsxs)(h.code,{"data-language":"html","data-theme":"default",children:[(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"<!-- "})}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"This <script> tag links to the Embedding API library as a JavaScript ES6 module. "})}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"To use the library in your web application, you need to set the type attribute to "})}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"module in the <script> tag. "})}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"-->"})}),"\n",(0,g.jsx)(h.span,{className:"line",children:" "}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"<!-- "})}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"Initialize the API as part of your HTML code by using the <tableau-viz> web component. "})}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"After linking to the API library, the following code is all you need to embed a Tableau view into your HTML pages."})}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"-->"})}),"\n",(0,g.jsx)(h.span,{className:"line",children:" "})]})}),"\n",(0,g.jsx)(h.p,{children:"Here's what it looks like when you use the Embedding API v3 code to embed the viz on a web page:"}),"\n",(0,g.jsx)(h.hr,{}),"\n",(0,g.jsx)(h.h3,{id:"join-the-tableau-developer-program",children:"Join the Tableau Developer Program"}),"\n",(0,g.jsxs)(h.p,{children:["The Embedding API v3 is under active development and in future releases will provide full parity with the JavaScript API v2, giving you a rich set of features that you can access in your JavaScript or TypeScript code. To keep up to date with the coming features, join the ",(0,g.jsx)(h.a,{href:"https://www.tableau.com/developer",children:"Tableau Developer Program"})," to gain access to developer previews and demos, as well as your own Tableau Online Developer site."]}),"\n",(0,g.jsx)(h.hr,{}),"\n",(0,g.jsx)(h.h2,{id:"embedding-with-the-javascript-api-v2",children:"Embedding with the JavaScript API v2"}),"\n",(0,g.jsx)(h.p,{children:"The JavaScript API v2 is the established way to embed views. While the Embedding API v3 is recommended for basic embed code and for new embedding projects, you should continue to use the JavaScript API v2 for existing implementations that have a lot of customization."}),"\n",(0,g.jsx)(h.p,{children:"A basic implementation the JavaScript API v2 looks like this:"}),"\n",(0,g.jsx)(h.p,{children:"HTML:"}),"\n",(0,g.jsx)(h.pre,{"data-language":"html","data-theme":"default",children:(0,g.jsxs)(h.code,{"data-language":"html","data-theme":"default",children:[(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"<!-- JS file to enable the JavaScript API. You can point at the"})}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"  version on public.tableau.com, online.tableau.com, or your on-prem Server -->"})}),"\n",(0,g.jsxs)(h.span,{className:"line",children:[(0,g.jsx)(h.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-string-expression)"},children:"script"}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-function)"},children:"src"}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"https://www.example.com/javascripts/api/tableau-2.js"'}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-color-text)"},children:"></"}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-string-expression)"},children:"script"}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-color-text)"},children:">"})]}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-color-text)"},children:"..."})}),"\n",(0,g.jsx)(h.span,{className:"line",children:(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-comment)"},children:"<!-- Empty div where the viz will be placed -->"})}),"\n",(0,g.jsxs)(h.span,{className:"line",children:[(0,g.jsx)(h.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-string-expression)"},children:"div"}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-function)"},children:"id"}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"tableauViz"'}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-color-text)"},children:"></"}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-token-string-expression)"},children:"div"}),(0,g.jsx)(h.span,{style:{color:"var(--shiki-color-text)"},children:">"})]})]})}),"\n",(0,g.jsx)(h.p,{children:"JavaScript:"}),"\n",(0,g.jsx)(h.h2,{id:"use-cases-for-the-javascript-api-and-the-embedding-api-v3",children:"Use cases for the JavaScript API and the Embedding API v3"}),"\n",(0,g.jsx)(h.p,{children:"The JavaScript API v2 and the Embedding API v3 provide access to a large set of capabilities that allow for granular control of interactivity with embedded views, as well as the customization needed to create a seamless analytics experience within custom apps. Common use cases include:"}),"\n",(0,g.jsxs)(h.p,{children:[(0,g.jsx)(h.strong,{children:"Filtering and setting parameters on load"})," -- The options object gives you a clean interface for filtering the visualization as it loads. This is useful for loading the viz with the correct context given where the user is in your application or choices they have made.\nNote: Filtering with the JavaScript API v2 or Embedding API v3 is ",(0,g.jsx)(h.strong,{children:"not"})," a security mechanism. If you wish to have tamper-proof filters applied, you should use ",(0,g.jsx)(h.a,{href:"",children:"user filters or database security"}),"."]}),"\n",(0,g.jsxs)(h.p,{children:[(0,g.jsx)(h.strong,{children:"Custom interfaces for interacting with the view"})," -- Dashboards often have elements for filtering, changing parameters, and switching tabs, amongst other things. When integrating with another application, you may want to match the look and feel of dashboard interfaces with the look and feel of the embedding application. For example, you can create a drop-down with HTML/CSS/JS that matches the style of your application and have that drop-down make JavaScript API calls to filter the viz or change a parameter."]}),"\n",(0,g.jsxs)(h.p,{children:[(0,g.jsx)(h.strong,{children:"Custom interactions"})," -- Because the JavaScript API gives you programmatic control over interaction, you can combine calls to create interactions that would not be possible otherwise. For example, you could create a button that switches to a specific visualization, changes a parameter, and then selects a set of marks all with a single click by the user. Or, when a user clicks a mark on a viz, you could have that drive a parameter change on another sheet. The combination of API calls is limited only by your imagination."]}),"\n",(0,g.jsxs)(h.p,{children:[(0,g.jsx)(h.strong,{children:"Integration with other systems"})," -- If a user finds an insight from a visualization, it is likely the user will want to take action on that insight elsewhere in the embedding application. With the JavaScript API v2 and Embedding API v3, you can query data from the visualization, listen to user events, and execute code to perform an appropriate action. This allows Tableau visual analytics to integrate within your application's workflows."]}),"\n",(0,g.jsx)(h.p,{children:'In the image below, an HR-focused dashboard allows the user to select employees for an audit. When the user is ready, he or she can click "Run Audit" to generate a non-Tableau audit based on the selections made inside the Tableau viz.'}),"\n",(0,g.jsx)(_.Z,{alt:"HR dashboard",src:"/run_audit.png",width:700,height:800}),"\n",(0,g.jsx)(h.h2,{id:"embedding-api-and-javascript-api-resources",children:"Embedding API and JavaScript API Resources"}),"\n",(0,g.jsxs)(h.table,{children:[(0,g.jsx)(h.thead,{children:(0,g.jsxs)(h.tr,{children:[(0,g.jsx)(h.th,{children:"Link"}),(0,g.jsx)(h.th,{children:"Description"})]})}),(0,g.jsxs)(h.tbody,{children:[(0,g.jsxs)(h.tr,{children:[(0,g.jsx)(h.td,{children:(0,g.jsx)(h.a,{href:"https://help.tableau.com/current/api/embedding_api/en-us/index.html",children:"Embedding API v3 Documentaion"})}),(0,g.jsx)(h.td,{children:"Official documentation for the Embedding API v3, including overview, key concepts, and API reference"})]}),(0,g.jsxs)(h.tr,{children:[(0,g.jsx)(h.td,{children:(0,g.jsx)(h.a,{href:"https://www.tableau.com/developer",children:"Tableau Developer Program"})}),(0,g.jsx)(h.td,{children:"Join the Tableau Developer Program and keep up to date with the latest news and previews of developer tools and APIs"})]}),(0,g.jsxs)(h.tr,{children:[(0,g.jsx)(h.td,{children:(0,g.jsx)(h.a,{href:"http://onlinehelp.tableau.com/current/api/js_api/en-us/JavaScriptAPI/js_api.htm#",children:"JavaScript API v2 Documentation"})}),(0,g.jsx)(h.td,{children:"Official documentation for the JavaScript API including an overview, tutorial, samples, explanation of key concepts, and API reference"})]}),(0,g.jsxs)(h.tr,{children:[(0,g.jsx)(h.td,{children:(0,g.jsx)(h.a,{href:"http://onlinehelp.tableau.com/samples/en-us/js_api/tutorial.htm",children:"JavaScript API Tutorial"})}),(0,g.jsx)(h.td,{children:"An interactive tutorial that will walk you through the key concepts of the JavaScript API"})]}),(0,g.jsxs)(h.tr,{children:[(0,g.jsx)(h.td,{children:(0,g.jsx)(h.a,{href:"https://www.youtube.com/watch?v=Geppur9LDnw&list=PL_qx68DwhYA8e_z9k7uoRw0zayoY35nUJ",children:"JavaScript API YouTube Playlist"})}),(0,g.jsx)(h.td,{children:"A series of youtube videos to get you up and running with the JavaScript API"})]}),(0,g.jsxs)(h.tr,{children:[(0,g.jsx)(h.td,{children:(0,g.jsx)(h.a,{href:"https://github.com/tableau/js-api-samples",children:"JavaScript API Samples"})}),(0,g.jsx)(h.td,{children:"Official samples, created and maintained by Tableau"})]})]})]}),"\n",(0,g.jsx)("br",{}),"\n",(0,g.jsx)(h.p,{children:(0,g.jsxs)(h.em,{children:["Next section: ",(0,g.jsx)(h.a,{href:"",children:"Authentication and Single Sign-On"})]})})]})}let T={MDXContent:function(){let p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:h}=Object.assign({},(0,I.a)(),p.components);return h?(0,g.jsx)(h,{...p,children:(0,g.jsx)(_createMdxContent,{...p})}):_createMdxContent(p)},pageOpts:{filePath:"pages/frontend/embedding_api.mdx",route:"/frontend/embedding_api",frontMatter:{title:"Embedding Tableau Views"},timestamp:1696742816e3,pageMap:[{kind:"Meta",data:{"*":{type:"page"},index:{title:"Tableau Embedding Playbook",display:"hidden",theme:{layout:"full"}},architecture:{title:"Architecture",theme:{typesetting:"article"}},security:{title:"Security",theme:{typesetting:"article"}},frontend:{title:"Frontend",theme:{typesetting:"article"}},backend:{title:"Backend",theme:{typesetting:"article"}}}},{kind:"Folder",name:"architecture",route:"/architecture",children:[{kind:"Meta",data:{index:"Getting Started"}},{kind:"MdxPage",name:"index",route:"/architecture",frontMatter:{title:"Tableau Embedded Analytics Playbook",layout:"default"}}]},{kind:"Folder",name:"backend",route:"/backend",children:[{kind:"Meta",data:{restapi:"Tableau REST API",devops:"Devops"}},{kind:"MdxPage",name:"devops",route:"/backend/devops",frontMatter:{title:"Development and Deployment"}},{kind:"MdxPage",name:"restapi",route:"/backend/restapi",frontMatter:{title:"User Management, Content Management, and Display with the REST API"}}]},{kind:"Folder",name:"frontend",route:"/frontend",children:[{kind:"Meta",data:{embedding_api:"Tableau Embedding API",non_views:"Embedding Non-View Content",other_apps:"Embedding into Other Apps"}},{kind:"MdxPage",name:"embedding_api",route:"/frontend/embedding_api",frontMatter:{title:"Embedding Tableau Views"}},{kind:"MdxPage",name:"non_views",route:"/frontend/non_views",frontMatter:{title:"Embedding Analytics Experiences"}},{kind:"MdxPage",name:"other_apps",route:"/frontend/other_apps",frontMatter:{title:"Embedding in SharePoint, Salesforce, and Mobile Apps"}}]},{kind:"MdxPage",name:"index",route:"/",frontMatter:{title:"Tableau Embedded Analytics Playbook",layout:"default"}},{kind:"Folder",name:"security",route:"/security",children:[{kind:"Meta",data:{auth:"Authentication & SSO",rls:"Row-Level Security"}},{kind:"MdxPage",name:"auth",route:"/security/auth",frontMatter:{title:"Authentication and Single Sign-On (SSO)"}},{kind:"MdxPage",name:"rls",route:"/security/rls",frontMatter:{title:"Row-level Security"}}]}],flexsearch:{codeblocks:!0},title:"Embedding Tableau Views",headings:A},pageNextRoute:"/frontend/embedding_api",nextraLayout:b.ZP,themeConfig:v.Z};var w=(0,y.j)(T)},7741:function(p,h,m){"use strict";var g=m(5893),y=m(5675),b=m.n(y);function imageLoader(p){let{src:h,width:m,quality:g}=p,y=new URL("https://tableauembeddingplaybook.imgix.net/".concat(h)),b=y.searchParams;return b.set("auto",b.getAll("auto").join(",")||"format"),b.set("fit",b.get("fit")||"max"),b.set("w",b.get("w")||m.toString()),b.set("q",(g||50).toString()),y.href}h.Z=function(p){return(0,g.jsx)(b(),{loader:imageLoader,alt:p.alt,src:p.src,width:p.width,height:p.height})}},7660:function(p,h,m){"use strict";m.r(h),m.d(h,{AnalyticsObjectType:function(){return v},AnnotationType:function(){return I},ApiMenuType:function(){return S},ClassNameKey:function(){return _},ColumnType:function(){return A},CrosstabFileFormat:function(){return T},DashboardLayoutChange:function(){return w},DashboardObjectType:function(){return P},DataType:function(){return E},DateRangeType:function(){return C},DeviceType:function(){return D},EncodingType:function(){return k},ErrorCodes:function(){return x},FieldAggregationType:function(){return O},FieldRoleType:function(){return V},FilterDomainType:function(){return N},FilterNullOption:function(){return M},FilterType:function(){return F},FilterUpdateType:function(){return R},HierarchicalLevelSelectionState:function(){return z},IncludeDataValuesOption:function(){return j},MarkType:function(){return U},ParameterValueType:function(){return L},PeriodType:function(){return W},PrintOrientation:function(){return H},PrintPageSize:function(){return B},PrintScaling:function(){return G},QuickTableCalcType:function(){return Y},SelectionUpdateType:function(){return Z},SheetSizeBehavior:function(){return K},SheetType:function(){return q},SortDirection:function(){return J},TableauAskData:function(){return Q},TableauAuthoringViz:function(){return X},TableauDialogType:function(){return $},TableauEventType:function(){return ee},TableauViz:function(){return et},Toolbar:function(){return er},TrendLineModelType:function(){return ei},__esModule:function(){return en}});var g={5611:(p,h,m)=>{m(3132);var g=m(9276);p.exports=g.Number.isInteger},2316:(p,h,m)=>{m(4586);var g=m(9276);p.exports=g.Number.isNaN},47:(p,h,m)=>{m(3105);var g=m(9276);p.exports=g.Object.assign},7111:(p,h,m)=>{var g=m(9859),y=m(6733),b=m(9821),v=g.TypeError;p.exports=function(p){if(y(p))return p;throw v(b(p)+" is not a function")}},1176:(p,h,m)=>{var g=m(9859),y=m(5052),b=g.String,v=g.TypeError;p.exports=function(p){if(y(p))return p;throw v(b(p)+" is not an object")}},9540:(p,h,m)=>{var g=m(905),y=m(3231),b=m(9646),o=function(p){return function(h,m,v){var I,S=g(h),_=b(S),A=y(v,_);if(p&&m!=m){for(;_>A;)if((I=S[A++])!=I)return!0}else for(;_>A;A++)if((p||A in S)&&S[A]===m)return p||A||0;return!p&&-1}};p.exports={includes:o(!0),indexOf:o(!1)}},7079:(p,h,m)=>{var g=m(5968),y=g({}.toString),b=g("".slice);p.exports=function(p){return b(y(p),8,-1)}},7081:(p,h,m)=>{var g=m(8270),y=m(4826),b=m(7933),v=m(1787);p.exports=function(p,h){for(var m=y(h),I=v.f,S=b.f,_=0;_<m.length;_++){var A=m[_];g(p,A)||I(p,A,S(h,A))}}},5762:(p,h,m)=>{var g=m(7400),y=m(1787),b=m(5358);p.exports=g?function(p,h,m){return y.f(p,h,b(1,m))}:function(p,h,m){return p[h]=m,p}},5358:p=>{p.exports=function(p,h){return{enumerable:!(1&p),configurable:!(2&p),writable:!(4&p),value:h}}},7400:(p,h,m)=>{var g=m(4229);p.exports=!g(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},2635:(p,h,m)=>{var g=m(9859),y=m(5052),b=g.document,v=y(b)&&y(b.createElement);p.exports=function(p){return v?b.createElement(p):{}}},598:(p,h,m)=>{var g=m(1333);p.exports=g("navigator","userAgent")||""},6358:(p,h,m)=>{var g,y,b=m(9859),v=m(598),I=b.process,S=b.Deno,_=I&&I.versions||S&&S.version,A=_&&_.v8;A&&(y=(g=A.split("."))[0]>0&&g[0]<4?1:+(g[0]+g[1])),!y&&v&&(!(g=v.match(/Edge\/(\d+)/))||g[1]>=74)&&(g=v.match(/Chrome\/(\d+)/))&&(y=+g[1]),p.exports=y},3837:p=>{p.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3103:(p,h,m)=>{var g=m(9859),y=m(7933).f,b=m(5762),v=m(7487),I=m(2079),S=m(7081),_=m(6541);p.exports=function(p,h){var m,A,T,w,P,E=p.target,C=p.global,D=p.stat;if(m=C?g:D?g[E]||I(E,{}):(g[E]||{}).prototype)for(A in h){if(w=h[A],T=p.noTargetGet?(P=y(m,A))&&P.value:m[A],!_(C?A:E+(D?".":"#")+A,p.forced)&&void 0!==T){if(typeof w==typeof T)continue;S(w,T)}(p.sham||T&&T.sham)&&b(w,"sham",!0),v(m,A,w,p)}}},4229:p=>{p.exports=function(p){try{return!!p()}catch(p){return!0}}},266:p=>{var h=Function.prototype.call;p.exports=h.bind?h.bind(h):function(){return h.apply(h,arguments)}},1805:(p,h,m)=>{var g=m(7400),y=m(8270),b=Function.prototype,v=g&&Object.getOwnPropertyDescriptor,I=y(b,"name"),S=I&&(!g||g&&v(b,"name").configurable);p.exports={EXISTS:I,PROPER:I&&"something"===(function(){}).name,CONFIGURABLE:S}},5968:p=>{var h=Function.prototype,m=h.bind,g=h.call,y=m&&m.bind(g);p.exports=m?function(p){return p&&y(g,p)}:function(p){return p&&function(){return g.apply(p,arguments)}}},1333:(p,h,m)=>{var g=m(9859),y=m(6733);p.exports=function(p,h){var m;return arguments.length<2?y(m=g[p])?m:void 0:g[p]&&g[p][h]}},5300:(p,h,m)=>{var g=m(7111);p.exports=function(p,h){var m=p[h];return null==m?void 0:g(m)}},9859:(p,h,m)=>{var n=function(p){return p&&p.Math==Math&&p};p.exports=n("object"==typeof globalThis&&globalThis)||n(window)||n("object"==typeof self&&self)||n("object"==typeof m.g&&m.g)||function(){return this}()||Function("return this")()},8270:(p,h,m)=>{var g=m(5968),y=m(2991),b=g({}.hasOwnProperty);p.exports=Object.hasOwn||function(p,h){return b(y(p),h)}},5977:p=>{p.exports={}},4394:(p,h,m)=>{var g=m(7400),y=m(4229),b=m(2635);p.exports=!g&&!y(function(){return 7!=Object.defineProperty(b("div"),"a",{get:function(){return 7}}).a})},9337:(p,h,m)=>{var g=m(9859),y=m(5968),b=m(4229),v=m(7079),I=g.Object,S=y("".split);p.exports=b(function(){return!I("z").propertyIsEnumerable(0)})?function(p){return"String"==v(p)?S(p,""):I(p)}:I},8511:(p,h,m)=>{var g=m(5968),y=m(6733),b=m(5353),v=g(Function.toString);y(b.inspectSource)||(b.inspectSource=function(p){return v(p)}),p.exports=b.inspectSource},6407:(p,h,m)=>{var g,y,b,v=m(8694),I=m(9859),S=m(5968),_=m(5052),A=m(5762),T=m(8270),w=m(5353),P=m(4399),E=m(5977),C="Object already initialized",D=I.TypeError,k=I.WeakMap;if(v||w.state){var x=w.state||(w.state=new k),O=S(x.get),V=S(x.has),N=S(x.set);g=function(p,h){if(V(x,p))throw new D(C);return h.facade=p,N(x,p,h),h},y=function(p){return O(x,p)||{}},b=function(p){return V(x,p)}}else{var M=P("state");E[M]=!0,g=function(p,h){if(T(p,M))throw new D(C);return h.facade=p,A(p,M,h),h},y=function(p){return T(p,M)?p[M]:{}},b=function(p){return T(p,M)}}p.exports={set:g,get:y,has:b,enforce:function(p){return b(p)?y(p):g(p,{})},getterFor:function(p){return function(h){var m;if(!_(h)||(m=y(h)).type!==p)throw D("Incompatible receiver, "+p+" required");return m}}}},6733:p=>{p.exports=function(p){return"function"==typeof p}},6541:(p,h,m)=>{var g=m(4229),y=m(6733),b=/#|\.prototype\./,o=function(p,h){var m=I[v(p)];return m==_||m!=S&&(y(h)?g(h):!!h)},v=o.normalize=function(p){return String(p).replace(b,".").toLowerCase()},I=o.data={},S=o.NATIVE="N",_=o.POLYFILL="P";p.exports=o},2292:(p,h,m)=>{var g=m(5052),y=Math.floor;p.exports=Number.isInteger||function(p){return!g(p)&&isFinite(p)&&y(p)===p}},5052:(p,h,m)=>{var g=m(6733);p.exports=function(p){return"object"==typeof p?null!==p:g(p)}},4231:p=>{p.exports=!1},9395:(p,h,m)=>{var g=m(9859),y=m(1333),b=m(6733),v=m(1321),I=m(6969),S=g.Object;p.exports=I?function(p){return"symbol"==typeof p}:function(p){var h=y("Symbol");return b(h)&&v(h.prototype,S(p))}},9646:(p,h,m)=>{var g=m(4237);p.exports=function(p){return g(p.length)}},3839:(p,h,m)=>{var g=m(6358),y=m(4229);p.exports=!!Object.getOwnPropertySymbols&&!y(function(){var p=Symbol();return!String(p)||!(Object(p) instanceof Symbol)||!Symbol.sham&&g&&g<41})},8694:(p,h,m)=>{var g=m(9859),y=m(6733),b=m(8511),v=g.WeakMap;p.exports=y(v)&&/native code/.test(b(v))},7888:(p,h,m)=>{var g=m(7400),y=m(5968),b=m(266),v=m(4229),I=m(5632),S=m(894),_=m(9195),A=m(2991),T=m(9337),w=Object.assign,P=Object.defineProperty,E=y([].concat);p.exports=!w||v(function(){if(g&&1!==w({b:1},w(P({},"a",{enumerable:!0,get:function(){P(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var p={},h={},m=Symbol(),y="abcdefghijklmnopqrst";return p[m]=7,y.split("").forEach(function(p){h[p]=p}),7!=w({},p)[m]||I(w({},h)).join("")!=y})?function(p,h){for(var m=A(p),y=arguments.length,v=1,w=S.f,P=_.f;y>v;)for(var C,D=T(arguments[v++]),k=w?E(I(D),w(D)):I(D),x=k.length,O=0;x>O;)C=k[O++],g&&!b(P,D,C)||(m[C]=D[C]);return m}:w},1787:(p,h,m)=>{var g=m(9859),y=m(7400),b=m(4394),v=m(1176),I=m(9310),S=g.TypeError,_=Object.defineProperty;h.f=y?_:function(p,h,m){if(v(p),h=I(h),v(m),b)try{return _(p,h,m)}catch(p){}if("get"in m||"set"in m)throw S("Accessors not supported");return"value"in m&&(p[h]=m.value),p}},7933:(p,h,m)=>{var g=m(7400),y=m(266),b=m(9195),v=m(5358),I=m(905),S=m(9310),_=m(8270),A=m(4394),T=Object.getOwnPropertyDescriptor;h.f=g?T:function(p,h){if(p=I(p),h=S(h),A)try{return T(p,h)}catch(p){}if(_(p,h))return v(!y(b.f,p,h),p[h])}},8151:(p,h,m)=>{var g=m(140),y=m(3837).concat("length","prototype");h.f=Object.getOwnPropertyNames||function(p){return g(p,y)}},894:(p,h)=>{h.f=Object.getOwnPropertySymbols},1321:(p,h,m)=>{var g=m(5968);p.exports=g({}.isPrototypeOf)},140:(p,h,m)=>{var g=m(5968),y=m(8270),b=m(905),v=m(9540).indexOf,I=m(5977),S=g([].push);p.exports=function(p,h){var m,g=b(p),_=0,A=[];for(m in g)!y(I,m)&&y(g,m)&&S(A,m);for(;h.length>_;)y(g,m=h[_++])&&(~v(A,m)||S(A,m));return A}},5632:(p,h,m)=>{var g=m(140),y=m(3837);p.exports=Object.keys||function(p){return g(p,y)}},9195:(p,h)=>{var m={}.propertyIsEnumerable,g=Object.getOwnPropertyDescriptor,y=g&&!m.call({1:2},1);h.f=y?function(p){var h=g(this,p);return!!h&&h.enumerable}:m},2914:(p,h,m)=>{var g=m(9859),y=m(266),b=m(6733),v=m(5052),I=g.TypeError;p.exports=function(p,h){var m,g;if("string"===h&&b(m=p.toString)&&!v(g=y(m,p))||b(m=p.valueOf)&&!v(g=y(m,p))||"string"!==h&&b(m=p.toString)&&!v(g=y(m,p)))return g;throw I("Can't convert object to primitive value")}},4826:(p,h,m)=>{var g=m(1333),y=m(5968),b=m(8151),v=m(894),I=m(1176),S=y([].concat);p.exports=g("Reflect","ownKeys")||function(p){var h=b.f(I(p)),m=v.f;return m?S(h,m(p)):h}},9276:(p,h,m)=>{var g=m(9859);p.exports=g},7487:(p,h,m)=>{var g=m(9859),y=m(6733),b=m(8270),v=m(5762),I=m(2079),S=m(8511),_=m(6407),A=m(1805).CONFIGURABLE,T=_.get,w=_.enforce,P=String(String).split("String");(p.exports=function(p,h,m,S){var _,T=!!S&&!!S.unsafe,E=!!S&&!!S.enumerable,C=!!S&&!!S.noTargetGet,D=S&&void 0!==S.name?S.name:h;y(m)&&("Symbol("===String(D).slice(0,7)&&(D="["+String(D).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!b(m,"name")||A&&m.name!==D)&&v(m,"name",D),(_=w(m)).source||(_.source=P.join("string"==typeof D?D:""))),p!==g?(T?!C&&p[h]&&(E=!0):delete p[h],E?p[h]=m:v(p,h,m)):E?p[h]=m:I(h,m)})(Function.prototype,"toString",function(){return y(this)&&T(this).source||S(this)})},8885:(p,h,m)=>{var g=m(9859).TypeError;p.exports=function(p){if(null==p)throw g("Can't call method on "+p);return p}},2079:(p,h,m)=>{var g=m(9859),y=Object.defineProperty;p.exports=function(p,h){try{y(g,p,{value:h,configurable:!0,writable:!0})}catch(m){g[p]=h}return h}},4399:(p,h,m)=>{var g=m(3036),y=m(1441),b=g("keys");p.exports=function(p){return b[p]||(b[p]=y(p))}},5353:(p,h,m)=>{var g=m(9859),y=m(2079),b="__core-js_shared__",v=g[b]||y(b,{});p.exports=v},3036:(p,h,m)=>{var g=m(4231),y=m(5353);(p.exports=function(p,h){return y[p]||(y[p]=void 0!==h?h:{})})("versions",[]).push({version:"3.19.0",mode:g?"pure":"global",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})},3231:(p,h,m)=>{var g=m(3329),y=Math.max,b=Math.min;p.exports=function(p,h){var m=g(p);return m<0?y(m+h,0):b(m,h)}},905:(p,h,m)=>{var g=m(9337),y=m(8885);p.exports=function(p){return g(y(p))}},3329:p=>{var h=Math.ceil,m=Math.floor;p.exports=function(p){var g=+p;return g!=g||0===g?0:(g>0?m:h)(g)}},4237:(p,h,m)=>{var g=m(3329),y=Math.min;p.exports=function(p){return p>0?y(g(p),9007199254740991):0}},2991:(p,h,m)=>{var g=m(9859),y=m(8885),b=g.Object;p.exports=function(p){return b(y(p))}},2066:(p,h,m)=>{var g=m(9859),y=m(266),b=m(5052),v=m(9395),I=m(5300),S=m(2914),_=m(95),A=g.TypeError,T=_("toPrimitive");p.exports=function(p,h){if(!b(p)||v(p))return p;var m,g=I(p,T);if(g){if(void 0===h&&(h="default"),!b(m=y(g,p,h))||v(m))return m;throw A("Can't convert object to primitive value")}return void 0===h&&(h="number"),S(p,h)}},9310:(p,h,m)=>{var g=m(2066),y=m(9395);p.exports=function(p){var h=g(p,"string");return y(h)?h:h+""}},9821:(p,h,m)=>{var g=m(9859).String;p.exports=function(p){try{return g(p)}catch(p){return"Object"}}},1441:(p,h,m)=>{var g=m(5968),y=0,b=Math.random(),v=g(1..toString);p.exports=function(p){return"Symbol("+(void 0===p?"":p)+")_"+v(++y+b,36)}},6969:(p,h,m)=>{var g=m(3839);p.exports=g&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},95:(p,h,m)=>{var g=m(9859),y=m(3036),b=m(8270),v=m(1441),I=m(3839),S=m(6969),_=y("wks"),A=g.Symbol,T=A&&A.for,w=S?A:A&&A.withoutSetter||v;p.exports=function(p){if(!b(_,p)||!I&&"string"!=typeof _[p]){var h="Symbol."+p;I&&b(A,p)?_[p]=A[p]:_[p]=S&&T?T(h):w(h)}return _[p]}},3132:(p,h,m)=>{m(3103)({target:"Number",stat:!0},{isInteger:m(2292)})},4586:(p,h,m)=>{m(3103)({target:"Number",stat:!0},{isNaN:function(p){return p!=p}})},3105:(p,h,m)=>{var g=m(3103),y=m(7888);g({target:"Object",stat:!0,forced:Object.assign!==y},{assign:y})},2541:p=>{!function(){var h=RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i");function r(p){for(var h="",m=0;m<p;m++)h+=(65536*(1+Math.random())|0).toString(16).substring(1);return h}function n(p){if(!p)throw TypeError("Invalid argument; `value` has no value.");this.value=n.EMPTY,p&&p instanceof n?this.value=p.toString():p&&"[object String]"===Object.prototype.toString.call(p)&&n.isGuid(p)&&(this.value=p),this.equals=function(p){return n.isGuid(p)&&this.value==p},this.isEmpty=function(){return this.value===n.EMPTY},this.toString=function(){return this.value},this.toJSON=function(){return this.value}}n.EMPTY="00000000-0000-0000-0000-000000000000",n.isGuid=function(p){return p&&(p instanceof n||h.test(p.toString()))},n.create=function(){return new n([r(2),r(1),r(1),r(1),r(3)].join("-"))},n.raw=function(){return[r(2),r(1),r(1),r(1),r(3)].join("-")},p.exports?p.exports=n:window.Guid=n}()},8022:(p,h,m)=>{var g=m(4481),y=m(6426);y.v1=g,y.v4=y,p.exports=y},8725:p=>{for(var h=[],m=0;m<256;++m)h[m]=(m+256).toString(16).substr(1);p.exports=function(p,m){var g=m||0;return[h[p[g++]],h[p[g++]],h[p[g++]],h[p[g++]],"-",h[p[g++]],h[p[g++]],"-",h[p[g++]],h[p[g++]],"-",h[p[g++]],h[p[g++]],"-",h[p[g++]],h[p[g++]],h[p[g++]],h[p[g++]],h[p[g++]],h[p[g++]]].join("")}},9157:p=>{var h="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(h){var m=new Uint8Array(16);p.exports=function(){return h(m),m}}else{var g=Array(16);p.exports=function(){for(var p,h=0;h<16;h++)0==(3&h)&&(p=4294967296*Math.random()),g[h]=p>>>((3&h)<<3)&255;return g}}},4481:(p,h,m)=>{var g,y,b=m(9157),v=m(8725),I=0,S=0;p.exports=function(p,h,m){var _=h&&m||0,A=h||[],T=(p=p||{}).node||g,w=void 0!==p.clockseq?p.clockseq:y;if(null==T||null==w){var P=b();null==T&&(T=g=[1|P[0],P[1],P[2],P[3],P[4],P[5]]),null==w&&(w=y=16383&(P[6]<<8|P[7]))}var E=void 0!==p.msecs?p.msecs:(new Date).getTime(),C=void 0!==p.nsecs?p.nsecs:S+1,D=E-I+(C-S)/1e4;if(D<0&&void 0===p.clockseq&&(w=w+1&16383),(D<0||E>I)&&void 0===p.nsecs&&(C=0),C>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");I=E,S=C,y=w;var k=(1e4*(268435455&(E+=122192928e5))+C)%4294967296;A[_++]=k>>>24&255,A[_++]=k>>>16&255,A[_++]=k>>>8&255,A[_++]=255&k;var x=E/4294967296*1e4&268435455;A[_++]=x>>>8&255,A[_++]=255&x,A[_++]=x>>>24&15|16,A[_++]=x>>>16&255,A[_++]=w>>>8|128,A[_++]=255&w;for(var O=0;O<6;++O)A[_+O]=T[O];return h||v(A)}},6426:(p,h,m)=>{var g=m(9157),y=m(8725);p.exports=function(p,h,m){var b=h&&m||0;"string"==typeof p&&(h="binary"===p?Array(16):null,p=null);var v=(p=p||{}).random||(p.rng||g)();if(v[6]=15&v[6]|64,v[8]=63&v[8]|128,h)for(var I=0;I<16;++I)h[b+I]=v[I];return h||y(v)}},53:function(p,h,m){var g=this&&this.__awaiter||function(p,h,m,g){return new(m||(m=Promise))(function(y,b){function o(p){try{l(g.next(p))}catch(p){b(p)}}function s(p){try{l(g.throw(p))}catch(p){b(p)}}function l(p){var h;p.done?y(p.value):((h=p.value)instanceof m?h:new m(function(p){p(h)})).then(o,s)}l((g=g.apply(p,h||[])).next())})};Object.defineProperty(h,"__esModule",{value:!0});let y=m(1750),b=m(5740),v=m(3630),I=m(6809);let l=class l extends I.TableauWebComponent{static get observedAttributes(){return[...super.observedAttributes,...Object.values(y.AskDataAttributes)]}updateRenderingIfInitialized(p){return g(this,void 0,void 0,function*(){if(this._initialized)return v.WebComponentManager.unregisterWebComponent(this._embeddingIdCounter),this.updateRendering(p)})}updateRendering(p){return g(this,void 0,void 0,function*(){try{if(this._initialized=!0,!p)return void console.debug("A src needs to be set on the ".concat(this.tagName.toLowerCase()," element. Skipping rendering."));if((yield this.auth())===I.TableauAuthResponse.Failure)return void console.debug("Authentication failed.");if(!this.src)return void console.debug("A src needs to be set on the ".concat(this.tagName.toLowerCase()," element. Skipping rendering."));if(!this.iframe)return void console.debug("No iframe available to update the src.");let h=this.readCustomParamsFromChildren();this._embeddingIdCounter=v.WebComponentManager.registerWebComponent(this);let m=b.createAskDataUrl(this.src,this.constructOptions(),this._embeddingIdCounter,h).toString();return this.iframe.src=m,void this.raiseIframeSrcUpdatedNotification()}catch(p){console.warn(p)}})}constructOptions(){return{origin:this.origin,showEmbed:this.showEmbed,showPin:this.showPin,showSave:this.showSave,showShare:this.showShare,token:this.token,iframeAuth:this.iframeAuth,debug:this.debug}}get origin(){return this.getAttribute(y.AskDataAttributes.Origin)||void 0}set origin(p){p?this.setAttribute(y.AskDataAttributes.Origin,p):this.removeAttribute(y.AskDataAttributes.Origin)}get showEmbed(){return this.hasAttribute(y.AskDataAttributes.ShowEmbed)}set showEmbed(p){p?this.setAttribute(y.AskDataAttributes.ShowEmbed,""):this.removeAttribute(y.AskDataAttributes.ShowEmbed)}get showPin(){return this.hasAttribute(y.AskDataAttributes.ShowPin)}set showPin(p){p?this.setAttribute(y.AskDataAttributes.ShowPin,""):this.removeAttribute(y.AskDataAttributes.ShowPin)}get showShare(){return this.hasAttribute(y.AskDataAttributes.ShowShare)}set showShare(p){p?this.setAttribute(y.AskDataAttributes.ShowShare,""):this.removeAttribute(y.AskDataAttributes.ShowShare)}get showSave(){return this.hasAttribute(y.AskDataAttributes.ShowSave)}set showSave(p){p?this.setAttribute(y.AskDataAttributes.ShowSave,""):this.removeAttribute(y.AskDataAttributes.ShowSave)}constructor(){super()}};h.TableauAskData=l},123:function(p,h,m){var g=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(null!=p)for(var m in p)Object.hasOwnProperty.call(p,m)&&(h[m]=p[m]);return h.default=p,h};Object.defineProperty(h,"__esModule",{value:!0});let y=g(m(1750)),b=m(4695),v=m(9429),I=m(6801);let l=class l extends I.TableauVizBase{static get observedAttributes(){return[...super.observedAttributes,...Object.values(y.VizAuthoringAttributes)]}getAttributeEvents(){return[[y.VizSharedAttributes.OnEditInDesktopButtonClicked,y.EmbeddingTableauEventType.EditInDesktopButtonClicked],[y.VizSharedAttributes.OnFirstInteractive,y.EmbeddingTableauEventType.FirstInteractive],[y.VizSharedAttributes.OnFirstVizSizeKnown,y.EmbeddingTableauEventType.FirstVizSizeKnown],[y.VizAuthoringAttributes.OnWorkbookPublished,y.EmbeddingTableauEventType.WorkbookPublished],[y.VizAuthoringAttributes.OnWorkbookPublishedAs,y.EmbeddingTableauEventType.WorkbookPublishedAs],[y.VizAuthoringAttributes.OnWorkbookReadyToClose,y.EmbeddingTableauEventType.WorkbookReadyToClose]]}createFrameUrlWithParams(){let p=this.constructVizqlOptions(),h=this.readCustomParamsFromChildren();return v.createVizUrl(this.src,v.EmbeddingUrlMode.Authoring,p,this._embeddingIdCounter,[],[],h)}constructVizqlOptions(){return{token:this.token,touchOptimize:this.touchOptimize,hideEditInDesktopButton:this.hideEditInDesktopButton,suppressDefaultEditBehavior:this.suppressDefaultEditBehavior,hideCloseButton:this.hideCloseButton,debug:this.debug,iframeAuth:this.iframeAuth}}getRegisteredEvents(){return super.getRegisteredEvents().concat([[b.NotificationId.WorkbookPublished,()=>!0,()=>this.dispatchEvent(new CustomEvent(y.EmbeddingTableauEventType.WorkbookPublished))],[b.NotificationId.WorkbookPublishedAs,()=>!0,p=>this.handleWorkbookPublishedAsEvent(p)],[b.NotificationId.WorkbookReadyToClose,()=>!0,()=>this.dispatchEvent(new CustomEvent(y.EmbeddingTableauEventType.WorkbookReadyToClose))]])}handleWorkbookPublishedAsEvent(p){let h={newUrl:p.newUrl};this.dispatchEvent(new CustomEvent(y.EmbeddingTableauEventType.WorkbookPublishedAs,{detail:h}))}set hideCloseButton(p){p?this.setAttribute(y.VizAuthoringAttributes.HideCloseButton,""):this.removeAttribute(y.VizAuthoringAttributes.HideCloseButton)}get hideCloseButton(){return this.hasAttribute(y.VizAuthoringAttributes.HideCloseButton)}};h.TableauAuthoringViz=l},4882:function(p,h,m){var g=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(null!=p)for(var m in p)Object.hasOwnProperty.call(p,m)&&(h[m]=p[m]);return h.default=p,h};Object.defineProperty(h,"__esModule",{value:!0});let y=g(m(1750)),b=m(4695),v=m(4007),I=m(4031),S=m(9973),_=m(8460),A=m(6208),T=m(9288),w=m(3504),P=m(9429),E=m(6451),C=m(3630),D=m(6801);let f=class f extends D.TableauVizBase{readFiltersFromChild(){let p=[];return[].forEach.call(this.children,h=>{h.localName===y.VizChildElements.VizFilter&&h.getAttribute(y.VizChildElementAttributes.Field)&&void 0!==h.getAttribute(y.VizChildElementAttributes.Value)&&p.push({field:h.getAttribute(y.VizChildElementAttributes.Field),value:h.getAttribute(y.VizChildElementAttributes.Value)})}),p}readParametersFromChild(){let p=[];return[].forEach.call(this.children,h=>{h.localName===y.VizChildElements.VizParameter&&h.getAttribute(y.VizChildElementAttributes.Name)&&h.getAttribute(y.VizChildElementAttributes.Value)&&p.push({name:h.getAttribute(y.VizChildElementAttributes.Name),value:h.getAttribute(y.VizChildElementAttributes.Value)})}),p}static get observedAttributes(){return[...super.observedAttributes,...Object.values(y.VizAttributes)]}disconnectedCallback(){this.preInitFilters=[],super.disconnectedCallback()}createFrameUrlWithParams(){let p=this.constructVizqlOptions(),h=this.readFiltersFromChild().concat(this.preInitFilters),m=this.readParametersFromChild(),g=this.readCustomParamsFromChildren();return P.createVizUrl(this.src,P.EmbeddingUrlMode.Viewing,p,this._embeddingIdCounter,h,m,g)}constructVizqlOptions(){return{disableUrlActionsPopups:this.disableUrlActionsPopups,hideTabs:this.hideTabs,toolbar:this.toolbar,instanceIdToClone:this.instanceIdToClone,device:this.device,token:this.token,touchOptimize:this.touchOptimize,hideEditButton:this.hideEditButton,hideEditInDesktopButton:this.hideEditInDesktopButton,suppressDefaultEditBehavior:this.suppressDefaultEditBehavior,debug:this.debug,iframeAuth:this.iframeAuth}}getAttributeEvents(){return[[y.VizAttributes.OnCustomMarkContextMenuEvent,y.EmbeddingTableauEventType.CustomMarkContextMenuEvent],[y.VizAttributes.OnEditButtonClicked,y.EmbeddingTableauEventType.EditButtonClicked],[y.VizSharedAttributes.OnEditInDesktopButtonClicked,y.EmbeddingTableauEventType.EditInDesktopButtonClicked],[y.VizAttributes.OnFilterChanged,y.EmbeddingTableauEventType.FilterChanged],[y.VizSharedAttributes.OnFirstInteractive,y.EmbeddingTableauEventType.FirstInteractive],[y.VizSharedAttributes.OnFirstVizSizeKnown,y.EmbeddingTableauEventType.FirstVizSizeKnown],[y.VizAttributes.OnMarkSelectionChanged,y.EmbeddingTableauEventType.MarkSelectionChanged],[y.VizAttributes.OnParameterChanged,y.EmbeddingTableauEventType.ParameterChanged],[y.VizAttributes.OnTabSwitched,y.EmbeddingTableauEventType.TabSwitched],[y.VizAttributes.OnToolbarStateChanged,y.EmbeddingTableauEventType.ToolbarStateChanged],[y.VizAttributes.OnUrlAction,y.EmbeddingTableauEventType.UrlAction],[y.VizAttributes.OnCustomViewLoaded,y.EmbeddingTableauEventType.CustomViewLoaded],[y.VizAttributes.OnCustomViewRemoved,y.EmbeddingTableauEventType.CustomViewRemoved],[y.VizAttributes.OnCustomViewSaved,y.EmbeddingTableauEventType.CustomViewSaved],[y.VizAttributes.OnCustomViewSetDefault,y.EmbeddingTableauEventType.CustomViewSetDefault],[y.VizAttributes.OnStoryPointSwitched,y.EmbeddingTableauEventType.StoryPointSwitched]]}getRegisteredEvents(){return super.getRegisteredEvents().concat([[b.NotificationId.SelectedMarksChanged,p=>this.shouldNotifyEvent(p),p=>this.handleSelectedMarksChangedEvent(p)],[b.NotificationId.FilterChanged,p=>this.shouldNotifyEvent(p.visualId),p=>this.handleFilterChangedEvent(p)],[b.NotificationId.EditButtonClicked,()=>!0,()=>this.handleEditButtonClicked()],[b.NotificationId.CustomMarkContextMenuClicked,p=>this.shouldNotifyEvent(p.visualId),p=>this.handleCustomMarkClickedContextMenuEvent(p)],[b.NotificationId.ParameterChanged,()=>!0,p=>this.handleParameterChangedEvent(p)],[b.NotificationId.UrlAction,()=>!0,p=>this.handleUrlAction(p)],[b.NotificationId.StoryPointSwitched,()=>!0,p=>this.handleStoryPointSwitch(p)]])}shouldNotifyEvent(p){switch(this.workbook.activeSheet.sheetType){case y.SheetType.Worksheet:return this.workbook.activeSheet.name===p.worksheet;case y.SheetType.Dashboard:return 1===this.workbook.activeSheet.worksheets.filter(h=>h.name===p.worksheet).length;case y.SheetType.Story:{let h=this.workbook.activeSheet.activeStoryPoint.containedSheet;return!!h&&(h.sheetType===y.SheetType.Worksheet?h.name===p.worksheet:h.sheetType===y.SheetType.Dashboard&&1===h.worksheets.filter(h=>h.name===p.worksheet).length)}default:return!1}}handleSelectedMarksChangedEvent(p){let h=new _.MarksSelectedEvent(this.getWorksheetForNotificationHandler(p));this.dispatchEvent(new CustomEvent(y.EmbeddingTableauEventType.MarkSelectionChanged,{detail:h}))}handleFilterChangedEvent(p){let h=new S.FilterChangedEvent(this.getWorksheetForNotificationHandler(p.visualId),p.fieldName,p.fieldId);this.dispatchEvent(new CustomEvent(y.EmbeddingTableauEventType.FilterChanged,{detail:h}))}handleEditButtonClicked(){this.dispatchEvent(new CustomEvent(y.EmbeddingTableauEventType.EditButtonClicked))}handleCustomMarkClickedContextMenuEvent(p){let h=new I.CustomMarkContextMenuEvent(this.getWorksheetForNotificationHandler(p.visualId),p.contextMenuId);this.dispatchEvent(new CustomEvent(y.EmbeddingTableauEventType.CustomMarkContextMenuEvent,{detail:h}))}handleParameterChangedEvent(p){let h=new A.ParameterChangedEvent(p,this.vizImpl.embeddingId);this.dispatchEvent(new CustomEvent(y.EmbeddingTableauEventType.ParameterChanged,{detail:h}))}handleUrlAction(p){let h=new w.UrlActionEvent(p.url,p.target);this.dispatchEvent(new CustomEvent(y.EmbeddingTableauEventType.UrlAction,{detail:h}))}handleStoryPointSwitch(p){let h=this.vizImpl.workbookImpl.activeSheet,m=h.storyPointsInfo.find(p=>!0===p.active);if(h.activeStoryPoint&&m&&h.activeStoryPoint.index!==p.index){h.updateStory(p);let g=new T.StoryPointSwitchedEvent(m,h.activeStoryPoint,this.vizImpl.workbookImpl);this.dispatchEvent(new CustomEvent(y.EmbeddingTableauEventType.StoryPointSwitched,{detail:g}))}}getWorksheetForNotificationHandler(p){let h;switch(this.workbook.activeSheet.sheetType){case y.SheetType.Worksheet:h=this.workbook.activeSheet;break;case y.SheetType.Dashboard:{let m=this.workbook.activeSheet.worksheets.filter(h=>h.name===p.worksheet);if(1!==m.length)throw new v.TableauError(y.EmbeddingErrorCodes.IndexOutOfRange,"Worksheet not found");h=m[0];break}case y.SheetType.Story:{let m=this.workbook.activeSheet.activeStoryPoint.containedSheet;if(!m)throw new v.TableauError(y.EmbeddingErrorCodes.IndexOutOfRange,"Worksheet not found");if(m.sheetType===y.SheetType.Worksheet)h=m;else{if(m.sheetType!==y.SheetType.Dashboard)throw new v.TableauError(y.EmbeddingErrorCodes.ImplementationError,"Could not find sheetType");{let g=m.worksheets.filter(h=>h.name===p.worksheet);if(1!==g.length)throw new v.TableauError(y.EmbeddingErrorCodes.IndexOutOfRange,"Worksheet not found");h=g[0]}}break}default:throw new v.TableauError(y.EmbeddingErrorCodes.ImplementationError,"Could not find sheetType")}return h}get disableUrlActionsPopups(){return this.hasAttribute(y.VizAttributes.DisableUrlActionsPopups)}set disableUrlActionsPopups(p){p?this.setAttribute(y.VizAttributes.DisableUrlActionsPopups,""):this.removeAttribute(y.VizAttributes.DisableUrlActionsPopups)}get hideTabs(){return this.hasAttribute(y.VizAttributes.HideTabs)}set hideTabs(p){p?this.setAttribute(y.VizAttributes.HideTabs,""):this.removeAttribute(y.VizAttributes.HideTabs)}get toolbar(){let p=D.attributeToEnumKey(this.getAttribute(y.VizAttributes.Toolbar));return y.Toolbar[p]||D.TableauVizBase.VizAttributeDefaults.toolbar}set toolbar(p){p&&this.setAttribute(y.VizAttributes.Toolbar,p)}get instanceIdToClone(){let p=this.getAttribute(y.VizAttributes.InstanceIdToClone);if(p)return p}set instanceIdToClone(p){p?this.setAttribute(y.VizAttributes.InstanceIdToClone,p):this.removeAttribute(y.VizAttributes.InstanceIdToClone)}get device(){let p=D.attributeToEnumKey(this.getAttribute(y.VizAttributes.Device));return y.DeviceType[p]||D.TableauVizBase.VizAttributeDefaults.device}set device(p){this.setAttribute(y.VizAttributes.Device,p)}get hideEditButton(){return this.hasAttribute(y.VizAttributes.HideEditButton)}set hideEditButton(p){p?this.setAttribute(y.VizAttributes.HideEditButton,""):this.removeAttribute(y.VizAttributes.HideEditButton)}get automaticUpdatesArePaused(){return this.vizImpl.automaticUpdatesArePaused}pauseAutomaticUpdatesAsync(){return this.vizImpl.pauseAutomaticUpdatesAsync()}resumeAutomaticUpdatesAsync(){return this.vizImpl.resumeAutomaticUpdatesAsync()}toggleAutomaticUpdatesAsync(){return this.vizImpl.toggleAutomaticUpdatesAsync()}revertAllAsync(){return this.vizImpl.revertAllAsync()}refreshDataAsync(){return this.vizImpl.refreshDataAsync()}exportImageAsync(){return this.vizImpl.exportImageAsync()}exportCrosstabAsync(p,h){return this.vizImpl.exportCrosstabAsync(p,h)}exportDataAsync(p,h){return this.vizImpl.exportDataAsync(p,h)}exportPowerPointAsync(p){return this.vizImpl.exportPowerPointAsync(p)}exportPDFAsync(p,h){return this.vizImpl.exportPDFAsync(p,h)}displayDialogAsync(p){return this.vizImpl.displayDialogAsync(p)}redoAsync(){return this.vizImpl.redoAsync()}undoAsync(){return this.vizImpl.undoAsync()}addFilter(p,h){this.preInitFilters.push({field:p,value:h}),C.WebComponentManager.synchronizeRender(this.updateRenderingIfInitialized.bind(this,this.src))}get workbook(){return new E.Workbook(this.vizImpl.workbookImpl)}constructor(){super(...arguments),this.preInitFilters=[]}};h.TableauViz=f},6801:function(p,h,m){var g=this&&this.__awaiter||function(p,h,m,g){return new(m||(m=Promise))(function(y,b){function o(p){try{l(g.next(p))}catch(p){b(p)}}function s(p){try{l(g.throw(p))}catch(p){b(p)}}function l(p){var h;p.done?y(p.value):((h=p.value)instanceof m?h:new m(function(p){p(h)})).then(o,s)}l((g=g.apply(p,h||[])).next())})},y=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(null!=p)for(var m in p)Object.hasOwnProperty.call(p,m)&&(h[m]=p[m]);return h.default=p,h};Object.defineProperty(h,"__esModule",{value:!0});let b=y(m(1750)),v=m(4695),I=m(4007),S=m(416),_=m(3630),A=m(6809);let d=class d extends A.TableauWebComponent{disconnectedCallback(){super.disconnectedCallback(),this._vizImpl&&this._vizImpl.dispose()}static get observedAttributes(){return[...super.observedAttributes,...Object.values(b.VizSharedAttributes)]}updateRenderingIfInitialized(p){return g(this,void 0,void 0,function*(){if(this._initialized)return this._vizImpl&&this._vizImpl.dispose(),_.WebComponentManager.unregisterWebComponent(this._embeddingIdCounter),this.updateRendering(p)})}updateRendering(p){return g(this,void 0,void 0,function*(){try{if(this._initialized=!0,!p)return void console.debug("A src needs to be set on the ".concat(this.tagName.toLowerCase()," element. Skipping rendering."));if((yield this.auth())===A.TableauAuthResponse.Failure)return void console.debug("Authentication failed.");if(!this.src)return void console.debug("A src needs to be set on the ".concat(this.tagName.toLowerCase()," element. Skipping rendering."));if(!this.iframe)return void console.debug("No iframe available to update the src.");this._embeddingIdCounter=_.WebComponentManager.registerWebComponent(this),this.registerAttributeEvents();let h=this.createFrameUrlWithParams();return this._vizImpl=this.createAndInitializeVizImpl(h),this.iframe.src=h.toString(),void this.raiseIframeSrcUpdatedNotification()}catch(p){console.debug(p)}})}createAndInitializeVizImpl(p){let h=new S.VizImpl(this,this.iframe,p,this._embeddingIdCounter);return h.initializeViz(),h}registerAttributeEvents(){this.getAttributeEvents().forEach(p=>{let[h,m]=p;this.registerCallback(h,m)})}initializeEvents(){let p;try{p=I.ApiServiceRegistry.get(this.vizImpl.embeddingId).getService("notification-service")}catch(p){throw new I.TableauError(b.EmbeddingErrorCodes.EventInitializationError,"Event initialization failed")}let h=this.getRegisteredEvents();for(let[m,g,y]of h)p.registerHandler(m,g,y)}getRegisteredEvents(){return[[v.NotificationId.EditInDesktopButtonClicked,()=>!0,()=>this.dispatchEvent(new CustomEvent(b.EmbeddingTableauEventType.EditInDesktopButtonClicked))]]}get touchOptimize(){return this.hasAttribute(b.VizSharedAttributes.TouchOptimize)}set touchOptimize(p){p?this.setAttribute(b.VizSharedAttributes.TouchOptimize,""):this.removeAttribute(b.VizSharedAttributes.TouchOptimize)}get vizImpl(){return this._vizImpl}get hideEditInDesktopButton(){return this.hasAttribute(b.VizSharedAttributes.HideEditInDesktopButton)}set hideEditInDesktopButton(p){p?this.setAttribute(b.VizSharedAttributes.HideEditInDesktopButton,""):this.removeAttribute(b.VizSharedAttributes.HideEditInDesktopButton)}get suppressDefaultEditBehavior(){return this.hasAttribute(b.VizSharedAttributes.SuppressDefaultEditBehavior)}set suppressDefaultEditBehavior(p){p?this.setAttribute(b.VizSharedAttributes.SuppressDefaultEditBehavior,""):this.removeAttribute(b.VizSharedAttributes.SuppressDefaultEditBehavior)}get disableVersionCheck(){return this.hasAttribute(b.VizSharedAttributes.DisableVersionCheck)}set disableVersionCheck(p){p?this.setAttribute(b.VizSharedAttributes.DisableVersionCheck,""):this.removeAttribute(b.VizSharedAttributes.DisableVersionCheck)}getCurrentSrcAsync(){return this.vizImpl.getCurrentSrcAsync()}};h.TableauVizBase=d,d.VizAttributeDefaults={device:b.DeviceType.Default,toolbar:b.Toolbar.Bottom},h.attributeToEnumKey=function(p){if(!p||p.length<1)return"";let h=p.toLowerCase();return h[0].toUpperCase()+h.substring(1)}},6809:function(p,h,m){var g,y,b=this&&this.__awaiter||function(p,h,m,g){return new(m||(m=Promise))(function(y,b){function o(p){try{l(g.next(p))}catch(p){b(p)}}function s(p){try{l(g.throw(p))}catch(p){b(p)}}function l(p){var h;p.done?y(p.value):((h=p.value)instanceof m?h:new m(function(p){p(h)})).then(o,s)}l((g=g.apply(p,h||[])).next())})};Object.defineProperty(h,"__esModule",{value:!0});let v=m(1750),I=m(3101),S=m(2848),_=m(9701),A=m(3630);(g=y=h.TableauAuthResponse||(h.TableauAuthResponse={})).Skip="skip",g.Success="success",g.Failure="failure";let c=class c extends HTMLElement{disconnectedCallback(){var p;this._iframe&&(null===(p=this.shadowRoot)||void 0===p||p.removeChild(this._iframe)),A.WebComponentManager.unregisterWebComponent(this._embeddingIdCounter),this._initialized=!1}connectedCallback(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{this.initialize()}):this.initialize()}attributeChangedCallback(p,h,m){(h||h!==m)&&(p!==v.WebComponentAttributes.Width&&p!==v.WebComponentAttributes.Height?A.WebComponentManager.synchronizeRender(this.updateRenderingIfInitialized.bind(this,this.src)):this.setFrameSize())}static get observedAttributes(){return Object.values(v.WebComponentAttributes)}initialize(){this._initialized||(this.style.display="flex",this.setupFrame(),this.registerAttributeAuthErrorEvent(),A.WebComponentManager.synchronizeRender(this.updateRendering.bind(this,this.src)))}get fixedSize(){return this._fixedSize}readCustomParamsFromChildren(){let p=[];return Array.from(this.children).forEach(h=>{h.localName===v.WebComponentChildElements.CustomParameter&&h.getAttribute(v.WebComponentChildElementAttributes.Name)&&h.getAttribute(v.WebComponentChildElementAttributes.Value)&&p.push({name:h.getAttribute(v.WebComponentChildElementAttributes.Name),value:h.getAttribute(v.WebComponentChildElementAttributes.Value)})}),p}localizedTitle(p){return c.localizedTitles[p]||c.localizedTitles[p.substr(0,2)]||c.localizedTitles.en}setupFrame(){this._iframe=document.createElement("iframe");let p=navigator.language,h=this.localizedTitle(p);this._iframe.setAttribute("title",h),this._iframe.setAttribute("allowTransparency","true"),this._iframe.setAttribute("allowFullScreen","true"),this._iframe.style.margin="0px",this._iframe.style.padding="0px",this._iframe.style.border="none",this._iframe.style.position="relative",this._iframe.id=this.id,this._iframe.name=this.id,this.setFrameSize(),this.shadowRoot&&this.shadowRoot.appendChild(this._iframe)}setFrameSize(){this._iframe&&(this._iframe.style.height=this.height,this._iframe.style.width=this.width)}computeElementSize(){let p=this.getPixelAttribute(v.WebComponentAttributes.Height),h=this.getPixelAttribute(v.WebComponentAttributes.Width);if(p&&h)return this._fixedSize=!0,{height:p,width:h};if(this.parentElement){let{height:p,width:h}=_.HtmlElementHelpers.getContentSize(this.parentElement);if(p&&h)return this._fixedSize=!0,{height:"".concat(p,"px"),width:"".concat(h,"px")}}return this._fixedSize=!1,{height:c.AttributeDefaults.height,width:c.AttributeDefaults.width}}get src(){return this.getAttribute(v.WebComponentAttributes.Src)}set src(p){p&&this.setAttribute(v.WebComponentAttributes.Src,p)}get width(){return this.computeElementSize().width}set width(p){this.setAttribute(v.WebComponentAttributes.Width,p)}get height(){return this.computeElementSize().height}set height(p){this.setAttribute(v.WebComponentAttributes.Height,p)}get debug(){return this.hasAttribute(v.WebComponentAttributes.Debug)}set debug(p){p?this.setAttribute(v.WebComponentAttributes.Debug,""):this.removeAttribute(v.WebComponentAttributes.Debug)}get token(){let p=this.getAttribute(v.WebComponentAttributes.Token);if(p)return p}set token(p){p?this.setAttribute(v.WebComponentAttributes.Token,p):this.removeAttribute(v.WebComponentAttributes.Token)}get iframeAuth(){return this.hasAttribute(v.WebComponentAttributes.IframeAuth)}set iframeAuth(p){p?this.setAttribute(v.WebComponentAttributes.IframeAuth,""):this.removeAttribute(v.WebComponentAttributes.IframeAuth)}getPixelAttribute(p){let h=this.getAttribute(p);return h&&""!==h?isNaN(Number(h))?h:"".concat(Math.round(Number(h)),"px"):""}get iframe(){return this._iframe}registerAttributeAuthErrorEvent(){this.getWebComponentAttributeEvents().forEach(p=>{let[h,m]=p;this.registerCallback(h,m)})}getWebComponentAttributeEvents(){return[[v.WebComponentAttributes.OnVizLoadError,v.EmbeddingTableauEventType.VizLoadError]]}registerCallback(p,h){let m=this.getAttribute(p);m&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(m)&&window[m]&&this.addEventListener(h,window[m])}auth(){return b(this,void 0,void 0,function*(){try{if(!this.src||!this.token||this.iframeAuth)return y.Skip;let p=S.getSiteId(this.src),h="".concat(new URL(this.src).origin.toString(),"/vizportal/api/web/v1/auth/embed/signin"),m={siteName:p,jwt:this.token},g={method:"POST",credentials:"include",headers:{"content-type":"application/json"},body:JSON.stringify(m)},b=yield fetch(h,g);if(b.ok)return y.Success;let I=yield b.text(),_={statusCode:b.status,errorMessage:I};return this.isFallbackToRedirectAuthNeeded(_)?(this.iframeAuth=!0,console.debug("Auth Fallback trigger")):this.raiseVizLoadErrorNotification(v.EmbeddingErrorCodes.AuthFailed,_),y.Failure}catch(p){return this.raiseVizLoadErrorNotification(v.EmbeddingErrorCodes.UnknownAuthError,p),y.Failure}})}isFallbackToRedirectAuthNeeded(p){try{if(404===p.statusCode)return!0;if(401===p.statusCode){let h=JSON.parse(p.errorMessage).result.errors;if(h&&h.length>0&&67===h[0].code)return!0}return!1}catch(p){return console.error("Parsing error: "+p),!1}}raiseIframeSrcUpdatedNotification(){this.dispatchEvent(new CustomEvent(v.EmbeddingTableauEventType.IframeSrcUpdated))}raiseVizLoadErrorNotification(p,h){try{console.error(h);let m=new I.VizLoadErrorEvent(p,JSON.stringify(h));this.dispatchEvent(new CustomEvent(v.EmbeddingTableauEventType.VizLoadError,{detail:m}))}catch(h){let p=new I.VizLoadErrorEvent(v.EmbeddingErrorCodes.UnknownAuthError,"");this.dispatchEvent(new CustomEvent(v.EmbeddingTableauEventType.VizLoadError,{detail:p}))}}constructor(){super(),this._initialized=!1,this._embeddingIdCounter=0,this._fixedSize=!1,this.attachShadow({mode:"open"})}};h.TableauWebComponent=c,c.localizedTitles={en:"Data Visualization","en-GB":"Data Visualisation",fr:"Visualisation de donn\xe9es",es:"Visualizaci\xf3n de datos",it:"Visualizzazione dati",pt:"Visualiza\xe7\xe3o de dados",ja:"データ ビジュアライゼーション",de:"Datenvisualisierung",ko:"데이터 비주얼리제이션","zh-CN":"数据可视化","zh-TW":"資料可視化"},c.AttributeDefaults={width:"800px",height:"600px"}},4031:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(1750),y=m(5408);let a=class a extends y.TableauWorksheetEvent{getContextMenuId(){return this._contextMenuId}getSelectedMarksAsync(){return this.worksheet.getSelectedMarksAsync()}constructor(p,h){super(g.EmbeddingTableauEventType.CustomMarkContextMenuEvent,p),this._contextMenuId=h}};h.CustomMarkContextMenuEvent=a},9973:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(1750),y=m(4007),b=m(5408);let o=class o extends b.TableauWorksheetEvent{get fieldName(){return this._fieldName}get fieldId(){return this._fieldId}getFilterAsync(){return this.worksheet.getFiltersAsync().then(p=>{let h=this.fieldId?p.find(p=>p.fieldId===this.fieldId,this):p.find(p=>p.fieldName===this.fieldName,this);if(!h)throw new y.TableauError(g.EmbeddingErrorCodes.FilterMissingOrNotImplemented,"Cannot find filter: ".concat(this._fieldName,"."));return h})}constructor(p,h,m){super(g.EmbeddingTableauEventType.FilterChanged,p),this._fieldName=h,this._fieldId=m}};h.FilterChangedEvent=o},5538:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.FirstVizSizeKnownEvent=class{get vizSize(){return this._vizSize}constructor(p){this._vizSize=p}}},8460:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(1750),y=m(5408);let a=class a extends y.TableauWorksheetEvent{getMarksAsync(){return this.worksheet.getSelectedMarksAsync()}constructor(p){super(g.EmbeddingTableauEventType.MarkSelectionChanged,p)}};h.MarksSelectedEvent=a},6208:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(1750),y=m(4007),b=m(1062);h.ParameterChangedEvent=class{getParameterAsync(){return y.ApiServiceRegistry.get(this._embeddingId).getService("parameters-service").findParameterByGlobalFieldNameAsync(this._globalFieldName).then(p=>{if(void 0===p)throw new y.TableauError(g.EmbeddingErrorCodes.MissingParameter,"Cannot find parameter: ".concat(this._globalFieldName));return new b.Parameter(p)})}constructor(p,h){this._globalFieldName=p,this._embeddingId=h}}},9288:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(1970),y=m(3440);h.StoryPointSwitchedEvent=class{get oldStoryPointInfo(){return new y.StoryPointInfo(this._oldStoryPointInfoImpl,this._workbookImpl)}get newStoryPoint(){return new g.StoryPoint(this._currStoryPointImpl,this._workbookImpl)}constructor(p,h,m){this._oldStoryPointInfoImpl=p,this._currStoryPointImpl=h,this._workbookImpl=m}}},7722:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.TabSwitchedEvent=class{get oldSheetName(){return this._oldSheetName}get newSheetName(){return this._newSheetName}constructor(p,h){this._oldSheetName=p,this._newSheetName=h}}},696:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.TableauSheetEvent=class{get sheet(){return this._sheet}constructor(p,h){this._sheet=h}}},5408:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(696);let i=class i extends g.TableauSheetEvent{get worksheet(){return this._worksheet}constructor(p,h){super(p,h),this._worksheet=h}};h.TableauWorksheetEvent=i},1912:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.ToolbarStateChangedEvent=class{get canRedo(){return this._canRedo}get canUndo(){return this._canUndo}constructor(p,h){this._canRedo=p,this._canUndo=h}}},3504:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.UrlActionEvent=class{get url(){return this._url}get target(){return this._target}constructor(p,h){this._url=p,this._target=h}}},3101:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.VizLoadErrorEvent=class{get message(){return this._message}get errorCode(){return this._errorCode}constructor(p,h){this._errorCode=p,this._message=h}}},9733:function(p,h,m){var g=this&&this.__awaiter||function(p,h,m,g){return new(m||(m=Promise))(function(y,b){function o(p){try{l(g.next(p))}catch(p){b(p)}}function s(p){try{l(g.throw(p))}catch(p){b(p)}}function l(p){var h;p.done?y(p.value):((h=p.value)instanceof m?h:new m(function(p){p(h)})).then(o,s)}l((g=g.apply(p,h||[])).next())})},y=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(null!=p)for(var m in p)Object.hasOwnProperty.call(p,m)&&(h[m]=p[m]);return h.default=p,h};Object.defineProperty(h,"__esModule",{value:!0});let b=y(m(1750)),v=m(4695),I=m(4007);let l=class l extends I.WorkbookImpl{get activeSheet(){return this._activeSheetImpl}get publishedSheetsInfo(){return this._publishedSheetsInfo}get name(){return this._name}get canDownloadWorkbook(){return this._canDownloadWorkbook}get pendingTabSwitchPromise(){return this._pendingTabSwitchPromise}get pendingShowCustomViewPromise(){return this._pendingShowCustomViewPromise}clearPendingShowCustomViewPromise(){this._pendingShowCustomViewPromise=void 0}get activeCustomView(){return this._currentCustomView}activateSheetAsync(p){I.ErrorHelpers.verifyParameter(p,"sheetNameOrIndex");let h=this.convertSheetIndexToSheetName(p);return I.ErrorHelpers.verifyParameterType(h,"string","sheetNameOrIndex"),this.validatePublishedSheet(h)||this.verifyDashboardSheets(h),this._activeSheetImpl&&h===this._activeSheetImpl.name?new Promise((p,h)=>{p(this)}):(I.ApiServiceRegistry.get(this._registryId).getService("viz-service").activateSheetAsync(h),new Promise((p,h)=>{this._pendingTabSwitchPromise={resolve:p,reject:h}}))}getParametersAsync(){return I.ApiServiceRegistry.get(this._registryId).getService("parameters-service").getAllParametersAsync()}changeParameterValueAsync(p,h){return g(this,void 0,void 0,function*(){I.ErrorHelpers.verifyParameter(p,"parameterName");let m=I.ApiServiceRegistry.get(this._registryId).getService("parameters-service"),g=yield m.findParameterByNameAsync(p);return g?g.changeValueAsync(h).then(()=>g):void 0})}updateExistingActiveSheetReferences(p){this._activeSheetImpl&&this._activeSheetImpl.name!==p&&(this._activeSheetImpl.active=!1,this._publishedSheetsInfo.forEach((p,h)=>{p.name===this._activeSheetImpl.name&&(p.active=!1)}))}processCustomViews(p,h){var m;let g=null===(m=h.currentView)||void 0===m?void 0:m.luid,y=[];switch(p){case v.NotificationId.CustomViewsLoaded:case v.NotificationId.CustomViewSaved:this.refreshCustomViewCache(h),g&&y.push(this._customViews.get(g));break;case v.NotificationId.CustomViewRemoved:{let p=new Map(this._customViews);for(let m of(this._customViews.clear(),h.customViewsList.map(h=>{this._customViews.set(h.luid,new I.CustomViewImpl(h,this._registryId)),p.delete(h.luid)}),p.values()))y.push(m);break}case v.NotificationId.CustomViewSetDefault:{this.refreshCustomViewCache(h);let p=h.customViewsList.find(p=>p.isDefault);p&&y.push(new I.CustomViewImpl(p,this._registryId))}}return this._currentCustomView=g?this._customViews.get(g):void 0,y}refreshCustomViewCache(p){this._customViews.clear(),p.customViewsList.map(p=>{this._customViews.set(p.luid,new I.CustomViewImpl(p,this._registryId))})}revertAllAsync(){return I.ApiServiceRegistry.get(this._registryId).getService("ToolbarService").revertAllAsync()}getCustomViewsAsync(){return I.ApiServiceRegistry.get(this._registryId).getService("viz-service").getCustomViewsAsync()}showCustomViewAsync(p){return I.ApiServiceRegistry.get(this._registryId).getService("viz-service").showCustomViewAsync(p),new Promise((p,h)=>{this._pendingShowCustomViewPromise={resolve:p,reject:h}})}removeCustomViewAsync(p){return I.ApiServiceRegistry.get(this._registryId).getService("viz-service").removeCustomViewAsync(p)}saveCustomViewAsync(p){return I.ApiServiceRegistry.get(this._registryId).getService("viz-service").saveCustomViewAsync(p)}setActiveCustomViewAsDefaultAsync(){return I.ApiServiceRegistry.get(this._registryId).getService("viz-service").setActiveCustomViewAsDefaultAsync()}initializeWorkbook(p){p.publishedSheets.forEach((h,m)=>{let g=I.SheetUtils.getSheetSizeFromSizeConstraints(h.sizeConstraint),y=h.name===p.currWorksheetName,v=I.SheetUtils.getSheetTypeEnum(h.sheetType),S=new I.SheetInfoImpl(h.name,v,g,m,y,!1,h.url);if(this._publishedSheetsInfo.push(S),y)switch(S.sheetType){case b.SheetType.Worksheet:{let p={worksheet:S.name};this._activeSheetImpl=new I.WorksheetImpl(S,this._registryId,p,null,null);break}case b.SheetType.Dashboard:{let h={sheetName:S.name,isDashboard:!0};this._activeSheetImpl=new I.DashboardImpl(S,p.dashboardZones,h,this._registryId,null);break}case b.SheetType.Story:if(!p.story)throw new I.TableauError(b.SharedErrorCodes.ServerError,"Unable to receive story information from Tableau");this._activeSheetImpl=new I.StoryImpl(S,p.story,p.publishedSheets,this._registryId);break;default:throw new I.TableauError(b.SharedErrorCodes.ServerError,"Invalid SheetType")}})}convertSheetIndexToSheetName(p){if("number"==typeof p){if(this.publishedSheetsInfo[p])return this.publishedSheetsInfo[p].name;throw new I.TableauError(b.EmbeddingErrorCodes.IndexOutOfRange,"Index ".concat(p," is out of range."))}return p}validatePublishedSheet(p){return void 0!==this.publishedSheetsInfo.find(h=>h.name===p)}verifyDashboardSheets(p){if(this._activeSheetImpl.sheetType===b.SheetType.Dashboard){let h=this._activeSheetImpl,m=h.worksheetsImpl.findIndex(h=>h.name===p);if(-1!==m){if(h.worksheetsImpl[m].hidden)throw new I.TableauError(b.SharedErrorCodes.ServerError,"Cannot activate hidden sheet");return}}throw new I.TableauError(b.EmbeddingErrorCodes.SheetNotInWorkbook,"Sheet is not found in Workbook")}constructor(p,h){super(),this._registryId=h,this._publishedSheetsInfo=[],this._customViews=new Map,this._name=p.workbookName,this._canDownloadWorkbook=p.canDownloadWorkbook,this.initializeWorkbook(p)}};h.EmbeddingWorkbookImpl=l},416:function(p,h,m){var g=this&&this.__awaiter||function(p,h,m,g){return new(m||(m=Promise))(function(y,b){function o(p){try{l(g.next(p))}catch(p){b(p)}}function s(p){try{l(g.throw(p))}catch(p){b(p)}}function l(p){var h;p.done?y(p.value):((h=p.value)instanceof m?h:new m(function(p){p(h)})).then(o,s)}l((g=g.apply(p,h||[])).next())})},y=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(null!=p)for(var m in p)Object.hasOwnProperty.call(p,m)&&(h[m]=p[m]);return h.default=p,h};Object.defineProperty(h,"__esModule",{value:!0});let b=y(m(1750)),v=m(3069),I=m(4695),S=m(4007),_=m(5538),A=m(7722),T=m(1912),w=m(9733),P=m(206),E=m(9767),C=m(7193),D=m(9701);h.VizImpl=class{get workbookImpl(){return this._workbookImpl}get iframe(){return this._iframe}get embeddingId(){return this._embeddingId}get exportScenariosForPdfAndPowerPoint(){return{currentSheetName:this._workbookImpl.activeSheet.name,exportableSheetNamesFromDashboard:this.exportableSheetNamesFromDashboard,exportableSheetNamesFromWorkbook:this.exportableSheetNamesFromWorkbook}}get exportableSheetNamesFromDashboard(){let p=this._workbookImpl.activeSheet;return p&&p.sheetType===b.SheetType.Dashboard?p.getWorksheetNamesFromZones():[]}get exportableSheetNamesFromWorkbook(){let p=[];if(this._workbookImpl)for(let h of this._workbookImpl.publishedSheetsInfo)p.push(h.name);return p}get automaticUpdatesArePaused(){return this._automaticUpdatesArePaused}set automaticUpdatesArePaused(p){this._automaticUpdatesArePaused=p}getVisualIdForSheetName(p){var h,m,g;let y=this._workbookImpl.activeSheet;switch(y.sheetType){case b.SheetType.Worksheet:if(y.name===p)return y.visualId;break;case b.SheetType.Dashboard:for(let h of y.getWorksheetNamesFromZones())if(h===p)return{worksheet:h,dashboard:y.name};break;case b.SheetType.Story:{let v=null===(h=y.activeStoryPoint)||void 0===h?void 0:h.containedSheet;if(v&&v.sheetType===b.SheetType.Worksheet&&v.name===p){let p=Object.assign({},v.visualId);return p.dashboard=p.worksheet,p.storyboard=y.name,p.storyPointID=null===(m=y.activeStoryPoint)||void 0===m?void 0:m.storyPointId,p}if(v&&v.sheetType===b.SheetType.Dashboard){for(let h of v.getWorksheetNamesFromZones())if(h===p)return{worksheet:h,dashboard:v.name,storyboard:y.name,storyPointID:null===(g=y.activeStoryPoint)||void 0===g?void 0:g.storyPointId}}break}default:throw new S.TableauError(b.SharedErrorCodes.ServerError,"Invalid SheetType")}throw new S.TableauError(b.SharedErrorCodes.InvalidParameter,"sheetName parameter must belong to a worksheet within the current view")}get exportableWorksheetNames(){var p;let h=this._workbookImpl.activeSheet;switch(h.sheetType){case b.SheetType.Worksheet:return[h.name];case b.SheetType.Dashboard:return h.getWorksheetNamesFromZones();case b.SheetType.Story:{let m=null===(p=h.activeStoryPoint)||void 0===p?void 0:p.containedSheet;if(m&&m.sheetType===b.SheetType.Worksheet)return[m.name];if(m&&m.sheetType===b.SheetType.Dashboard)return m.getWorksheetNamesFromZones()}}return[]}initializeViz(){let p=this._iframe.contentWindow;if(!p)throw new S.TableauError(b.EmbeddingErrorCodes.InternalError,"Iframe has not been created yet");try{this._messenger=new I.CrossFrameMessenger(window,p,this._frameUrl.origin),this._dispatcher=new S.CrossFrameDispatcher(this._messenger),C.registerInitializationEmbeddingServices(this._dispatcher,this.embeddingId);let h=S.ApiServiceRegistry.get(this.embeddingId).getService("initialization-service"),m=h.registerHandler(I.NotificationId.FirstVizSizeKnown,()=>!0,p=>{this.handleVizSizeKnownEvent(p),m()}),g=h.registerHandler(I.NotificationId.VizInteractive,()=>!0,p=>{this.handleVizInteractiveEvent(p),g()});h.registerHandler(I.NotificationId.ToolbarStateChanged,()=>!0,p=>this.handleToolbarStateEvent(p)),h.registerHandler(I.NotificationId.TabSwitched,()=>!0,p=>this.handleTabSwitch(p)),h.registerHandler(I.NotificationId.CustomViewsLoaded,()=>!0,p=>this.handleCustomViews(p)),h.registerHandler(I.NotificationId.CustomViewRemoved,()=>!0,p=>this.handleCustomViewRemoved(p)),h.registerHandler(I.NotificationId.CustomViewSaved,()=>!0,p=>this.handleCustomViewSaved(p)),h.registerHandler(I.NotificationId.CustomViewSetDefault,()=>!0,p=>this.handleCustomViewSetDefault(p)),this._messenger.startListening()}catch(p){throw new S.TableauError(b.EmbeddingErrorCodes.InternalError,"Unexpected error during initialization.")}}dispose(){this._messenger&&this._messenger.stopListening(),this.removeWindowResizeHandler()}getCurrentSrcAsync(){return S.ApiServiceRegistry.get(this.embeddingId).getService("viz-service").getCurrentSrcAsync()}revertAllAsync(){return S.ApiServiceRegistry.get(this.embeddingId).getService("ToolbarService").revertAllAsync()}redoAsync(){return S.ApiServiceRegistry.get(this.embeddingId).getService("ToolbarService").redoAsync()}undoAsync(){return S.ApiServiceRegistry.get(this.embeddingId).getService("ToolbarService").undoAsync()}refreshDataAsync(){return S.ApiServiceRegistry.get(this.embeddingId).getService("data-source-service").refreshAsync()}pauseAutomaticUpdatesAsync(){return this._automaticUpdatesArePaused?Promise.resolve():this.setAutoUpdateAsync(!1)}resumeAutomaticUpdatesAsync(){return this._automaticUpdatesArePaused?this.setAutoUpdateAsync(!0):Promise.resolve()}toggleAutomaticUpdatesAsync(){return this.setAutoUpdateAsync(this._automaticUpdatesArePaused)}exportImageAsync(){return S.ApiServiceRegistry.get(this.embeddingId).getService("ToolbarService").exportImageAsync()}exportCrosstabAsync(p,h){return g(this,void 0,void 0,function*(){let m=S.ApiServiceRegistry.get(this.embeddingId).getService("export-service");yield m.exportCrosstabAsync(p,h,this.exportableWorksheetNames,this._workbookImpl.activeSheet.sheetType)})}exportDataAsync(p){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S.ExportHelpers.DefaultDataOptions;return S.ApiServiceRegistry.get(this.embeddingId).getService("export-service").exportDataAsync(this.getVisualIdForSheetName(p),h)}exportPowerPointAsync(){let p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return g(this,void 0,void 0,function*(){let h=S.ApiServiceRegistry.get(this.embeddingId).getService("export-service"),m=this.exportScenariosForPdfAndPowerPoint;0===p.length&&p.push(m.currentSheetName),yield h.exportPowerPointAsync(p,m)})}exportPDFAsync(){let p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S.ExportHelpers.DefaultPDFOptions;return g(this,void 0,void 0,function*(){let m=S.ApiServiceRegistry.get(this.embeddingId).getService("export-service"),g=this.exportScenariosForPdfAndPowerPoint;0===p.length&&p.push(g.currentSheetName),yield m.exportPDFAsync(p,h,g)})}displayDialogAsync(p){let h=S.ApiServiceRegistry.get(this.embeddingId).getService("ToolbarService");switch(p){case v.TableauDialogType.ExportWorkbook:if(!this.workbookImpl.canDownloadWorkbook)throw new S.TableauError(b.EmbeddingErrorCodes.DownloadWorkbookNotAllowed,"Download workbook is not allowed");return h.displayDownloadWorkbookDialogAsync();case v.TableauDialogType.ExportPDF:return h.displayExportPdfDialogAsync();case v.TableauDialogType.ExportPowerPoint:return h.displayExportPowerpointDialogAsync();case v.TableauDialogType.ExportData:return h.displayExportDataDialogAsync();case v.TableauDialogType.ExportCrossTab:return h.displayExportCrosstabDialogAsync();case v.TableauDialogType.Share:return h.displayShareDialogAsync();default:throw new S.TableauError(b.EmbeddingErrorCodes.UnknownDialogType,"Unknown dialog type")}}setAutoUpdateAsync(p){return S.ApiServiceRegistry.get(this.embeddingId).getService("ToolbarService").setAutoUpdateAsync(p).then(()=>{this._automaticUpdatesArePaused=!p})}isVersionCompatible(p){return!!p&&(I.VersionLessThan(I.INTERNAL_CONTRACT_VERSION,p)||I.VersionEqualTo(I.INTERNAL_CONTRACT_VERSION,p))}handleVizInteractiveEvent(p){if(!this._viz.disableVersionCheck&&!this.isVersionCompatible(p.platformVersion))throw this._messenger.stopListening(),new S.TableauError(b.EmbeddingErrorCodes.IncompatibleVersionError,"The version of the Embedding library is not compatible with the version of Tableau. The visualization will load, but the Embedding API methods and events are not available.");S.registerAllSharedServices(this._dispatcher,this.embeddingId),C.registerAllEmbeddingServices(this._dispatcher,this.embeddingId),this._viz.initializeEvents(),this._workbookImpl=new w.EmbeddingWorkbookImpl(p,this.embeddingId);let h=[];this._customViewsTemp&&(h=this._workbookImpl.processCustomViews(I.NotificationId.CustomViewsLoaded,this._customViewsTemp)),this._viz.dispatchEvent(new CustomEvent(b.EmbeddingTableauEventType.FirstInteractive)),this._customViewsTemp&&(this.sendCustomViewEvents(b.EmbeddingTableauEventType.CustomViewLoaded,h),this._customViewsTemp=null)}handleVizSizeKnownEvent(p){let h=S.SheetUtils.getSheetSizeFromSizeConstraints(p.sheetSize);this._vizSize=new E.VizSize(h,p.chromeHeight);let m=new _.FirstVizSizeKnownEvent(this._vizSize);this._viz.dispatchEvent(new CustomEvent(b.EmbeddingTableauEventType.FirstVizSizeKnown,{detail:m})),this._viz.fixedSize||(this.refreshSize(),this.addWindowResizeHandler())}refreshSize(){let{height:p,width:h}=this.calculateLayoutSize();p!==this._vizSize.chromeHeight&&(this._iframe.style.height=p+"px",this._iframe.style.width=h+"px")}calculateLayoutSize(){let p=this._viz.parentElement?D.HtmlElementHelpers.getContentSize(this._viz.parentElement):{height:0,width:0},{chromeHeight:h,sheetSize:m}=this._vizSize,g=0,y=0,v=m.minSize||{height:0,width:0},I=m.maxSize||{height:0,width:0};if(m.behavior===b.SheetSizeBehavior.Exactly)g=I.width,y=I.height+h;else{let _,A,T,w;switch(m.behavior){case b.SheetSizeBehavior.Range:_=v.width,A=I.width,T=v.height+h,w=I.height+h,g=Math.max(_,Math.min(A,p.width)),y=Math.max(T,Math.min(w,p.height));break;case b.SheetSizeBehavior.AtLeast:_=v.width,T=v.height+h,g=Math.max(_,p.width),y=Math.max(T,p.height);break;case b.SheetSizeBehavior.AtMost:A=I.width,w=I.height+h,g=Math.min(A,p.width),y=Math.min(w,p.height);break;case b.SheetSizeBehavior.Automatic:g=p.width,y=Math.max(p.height,h);break;default:throw new S.TableauError(b.EmbeddingErrorCodes.InvalidSizeBehavior,"Unknown SheetSizeBehavior for viz: "+m.behavior)}}return{height:y,width:g}}removeWindowResizeHandler(){this._windowResizeHandler&&window.removeEventListener(this._resizeEventType,this._windowResizeHandler)}addWindowResizeHandler(){this._windowResizeHandler||(this._windowResizeHandler=this.refreshSize.bind(this),window.addEventListener(this._resizeEventType,this._windowResizeHandler))}handleToolbarStateEvent(p){let h=new T.ToolbarStateChangedEvent(p.toolbarState.canRedo,p.toolbarState.canUndo);this._viz.dispatchEvent(new CustomEvent(b.EmbeddingTableauEventType.ToolbarStateChanged,{detail:h}))}handleTabSwitch(p){if(!this._workbookImpl||!p.oldSheetName)return;let h=this._workbookImpl.pendingTabSwitchPromise;this._workbookImpl.updateExistingActiveSheetReferences(p.currWorksheetName),this._workbookImpl=new w.EmbeddingWorkbookImpl(p,this.embeddingId),h&&h.resolve(this._workbookImpl);let m=new A.TabSwitchedEvent(p.oldSheetName,p.currWorksheetName);this._viz.dispatchEvent(new CustomEvent(b.EmbeddingTableauEventType.TabSwitched,{detail:m}))}handleCustomViews(p){if(this._workbookImpl){let h=this._workbookImpl.processCustomViews(I.NotificationId.CustomViewsLoaded,p),m=this._workbookImpl.pendingShowCustomViewPromise;m&&(h[0]?m.resolve(h[0]):m.reject("No custom view."),this._workbookImpl.clearPendingShowCustomViewPromise()),this.sendCustomViewEvents(b.EmbeddingTableauEventType.CustomViewLoaded,h)}else this._customViewsTemp=p}handleCustomViewRemoved(p){let h=this._workbookImpl.processCustomViews(I.NotificationId.CustomViewRemoved,p);this.sendCustomViewEvents(b.EmbeddingTableauEventType.CustomViewRemoved,h)}handleCustomViewSaved(p){let h=this._workbookImpl.processCustomViews(I.NotificationId.CustomViewSaved,p);this.sendCustomViewEvents(b.EmbeddingTableauEventType.CustomViewSaved,h)}handleCustomViewSetDefault(p){let h=this._workbookImpl.processCustomViews(I.NotificationId.CustomViewSetDefault,p);this.sendCustomViewEvents(b.EmbeddingTableauEventType.CustomViewSetDefault,h)}sendCustomViewEvents(p,h){for(let m of h)if(m){let h={customView:new P.CustomView(m,this._workbookImpl)};this._viz.dispatchEvent(new CustomEvent(p,{detail:h}))}}constructor(p,h,m,g){if(this._viz=p,this._iframe=h,this._frameUrl=m,this._embeddingId=g,this._automaticUpdatesArePaused=!1,this._resizeEventType="resize",!this._iframe)throw new S.TableauError(b.EmbeddingErrorCodes.InternalError,"Iframe has not been created yet")}}},206:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(6451);let i=class i{get name(){return this._customViewImpl.name}set name(p){this._customViewImpl.name=p}get shared(){return this._customViewImpl.shared}set shared(p){this._customViewImpl.shared=p}get default(){return this._customViewImpl.isDefault}set default(p){this._customViewImpl.isDefault=p}get ownerName(){return this._customViewImpl.ownerName}get url(){return this._customViewImpl.url}get workbook(){return new g.Workbook(this._workbookImpl)}saveAsync(){return this._customViewImpl.saveAsync().then(p=>new i(p,this._workbookImpl))}constructor(p,h){this._customViewImpl=p,this._workbookImpl=h}};h.CustomView=i},1262:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(6397),y=m(7996),b=m(1970),v=m(5334);let s=class s extends y.Sheet{get objects(){return this._dashboardImpl.objects.map(p=>new g.DashboardObject(p,this._workbookImpl))}get worksheets(){return this._dashboardImpl.worksheetsImpl.map(p=>new v.Worksheet(p,this._workbookImpl))}get parentStoryPoint(){return null==this._dashboardImpl.parentStoryPoint?null:new b.StoryPoint(this._dashboardImpl.parentStoryPoint,this._workbookImpl)}getFiltersAsync(){return this._dashboardImpl.getFiltersAsync()}applyFilterAsync(p,h,m,g){return this._dashboardImpl.applyFilterAsync(p,h,m,g)}constructor(p,h){super(p,h),this._dashboardImpl=p,p.initializeWithPublicInterfaces()}};h.Dashboard=s},6397:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(1262),y=m(5334);h.DashboardObject=class{get dashboard(){return new g.Dashboard(this._dashboardObjectImpl.dashboardImpl,this._workbookImpl)}get type(){return this._dashboardObjectImpl.type}get position(){return this._dashboardObjectImpl.position}get size(){return this._dashboardObjectImpl.size}get worksheet(){if(this._dashboardObjectImpl.worksheetImpl)return new y.Worksheet(this._dashboardObjectImpl.worksheetImpl,this._workbookImpl)}get name(){return this._dashboardObjectImpl.name}get isFloating(){return this._dashboardObjectImpl.isFloating}get isVisible(){return this._dashboardObjectImpl.isVisible}get id(){return this._dashboardObjectImpl.id}constructor(p,h){this._dashboardObjectImpl=p,this._workbookImpl=h}}},5740:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(1750),y=m(4695),b=m(4007),v=m(2848);h.createAskDataUrl=function(p,h,m,I){let S;let _=p.split("?")[0];try{S=new URL(_),v.validateUrl(S)}catch(p){throw new b.TableauError(g.EmbeddingErrorCodes.InvalidUrl,p.message)}let A=function(p,h){let m=new Map,g="".concat(y.INTERNAL_CONTRACT_VERSION.major,".").concat(y.INTERNAL_CONTRACT_VERSION.minor,".").concat(y.INTERNAL_CONTRACT_VERSION.fix);m.set(y.AskDataOptionNames.ApiInternalVersion,g);let v=b.ApiVersion.Instance.formattedValue;return m.set(y.AskDataOptionNames.ApiExternalVersion,v),m.set(y.AskDataOptionNames.ApiID,"embhost".concat(h)),m.set(y.AskDataOptionNames.AskDataWebComponent,"true"),m}(0,m),T=new s(S).appendDefaultParameters(A).appendUserOptions(h).appendCustomParams(I);return h.iframeAuth&&T.setToken(h.token),T.build()};let s=class s extends v.EmbeddingUrlBuilder{sanitizeParameterValue(p,h){return this.sanitizeValue(h)}constructor(p){super(),this._url=p,this._optionNames=y.AskDataOptionNames}};h.EmbeddingAskDataUrlBuilder=s},2848:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.SANITIZED_VALUES={YES_VALUE:"y",NO_VALUE:"n"};let m=new Set(["https:","http:"]);function n(p){let h=p.toString();return h=h.replace("/#/site/","/t/").replace("/#/","/"),new URL(h)}h.EmbeddingUrlBuilder=class{build(){return this._url}appendDefaultParameters(p){for(let h of p.keys()){let m=p.get(h);m&&!this._url.searchParams.has(h)&&this._url.searchParams.append(h,m)}return this}appendUserOptions(p){for(let h of Object.keys(p)){if(null===p[h]||void 0===p[h])continue;let m=this._optionNames[h];if(!m)continue;let g=this.sanitizeParameterValue(m,p[h]);this._url.searchParams.append(m,g)}return this}appendCustomParams(p){for(let h of p)this._url.searchParams.set(h.name,h.value);return this}setToken(p){if(this._token)throw Error("The token has already been set to ".concat(this._token));if(!p)return this;this._token=p;let h=this._url.toString().substring(this._url.origin.length);return this._url=new URL("".concat(this._url.origin,"/vizportal/api/web/v1/auth/embed/target")),this._url.searchParams.append("token",p),this._url.searchParams.append("target",h),this}sanitizeValue(p){let m=String(p);switch(m){case"true":return h.SANITIZED_VALUES.YES_VALUE;case"false":return h.SANITIZED_VALUES.NO_VALUE;default:return m}}},h.validateUrl=function(p){!function(p){let h=p.protocol;if(!m.has(h))throw Error("Invalid protocol in URL '".concat(p,"'. The protocols supported are ").concat(Array.from(m).join(", "),"."))}(p)},h.getSiteId=function(p){let h=n(new URL(p.toString())).pathname.split("/").filter(p=>p);return 0===h.length||"t"!==h[0]||h.length<2?"":h[1]},h.canonicalizeVizPortalRoutingHashes=n},9429:(p,h,m)=>{var g,y;Object.defineProperty(h,"__esModule",{value:!0});let b=m(1750),v=m(4695),I=m(4007),S=m(2848),_=m(909);(y=g=h.EmbeddingUrlMode||(h.EmbeddingUrlMode={}))[y.Viewing=0]="Viewing",y[y.Authoring=1]="Authoring";let A=new Map([[g.Viewing,_.VizUrlMode.Viewing],[g.Authoring,_.VizUrlMode.Authoring]]);let c=class c extends S.EmbeddingUrlBuilder{appendFilters(p){for(let h of p)this._url.searchParams.append(h.field,h.value);return this}appendParams(p){for(let h of p)this._url.searchParams.append(h.name,h.value);return this}sanitizeParameterValue(p,h){let m;switch(p){case v.VizOptionNames.hideTabs:m=this.sanitizeValue(!h);break;case v.VizOptionNames.toolbar:m=this.sanitizeValue(h!==b.Toolbar.Hidden&&h);break;default:m=this.sanitizeValue(h)}return m}constructor(p){super(),this._url=p,this._optionNames=v.VizOptionNames}};h.EmbeddingVizUrlBuilder=c,h.createVizUrl=function(p,h,m,g,y,T,w){let P;if(!p)throw new I.TableauError(b.EmbeddingErrorCodes.InternalError,"We should not have attempted to render the component without a src");let E=A.get(h);if(!E)throw new I.TableauError(b.EmbeddingErrorCodes.InternalError,"'".concat(h,"' is not yet supported."));let C=p.split("?")[0];try{P=new URL(C),S.validateUrl(P)}catch(p){throw new I.TableauError(b.EmbeddingErrorCodes.InvalidUrl,p.message)}try{P=_.VizUrl.create(C).withMode(E).toURL()}catch(p){}let D=function(p,h){let m=new Map;m.set(v.VizOptionNames.Embed,S.SANITIZED_VALUES.YES_VALUE),m.set(v.VizOptionNames.ApiID,"embhost".concat(h)),"public.tableau.com"===p.hostname&&m.set(v.VizOptionNames.ShowVizHome,S.SANITIZED_VALUES.NO_VALUE);let g="".concat(v.INTERNAL_CONTRACT_VERSION.major,".").concat(v.INTERNAL_CONTRACT_VERSION.minor,".").concat(v.INTERNAL_CONTRACT_VERSION.fix);m.set(v.VizOptionNames.ApiInternalVersion,g);let y=I.ApiVersion.Instance.formattedValue;return m.set(v.VizOptionNames.ApiExternalVersion,y),m.set(v.VizOptionNames.NavType,"0"),m.set(v.VizOptionNames.NavSrc,"Opt"),m}(P,g),k=new c(P).appendDefaultParameters(D).appendUserOptions(m).appendFilters(y).appendParams(T).appendCustomParams(w);return m.iframeAuth&&k.setToken(m.token),k.build()}},1062:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.Parameter=class{get name(){return this.parameterImpl.name}get currentValue(){return this.parameterImpl.currentValue}get dataType(){return this.parameterImpl.dataType}get allowableValues(){return this.parameterImpl.allowableValues}get id(){return this.parameterImpl.id}changeValueAsync(p){return this.parameterImpl.changeValueAsync(p)}constructor(p){this.parameterImpl=p}}},7996:function(p,h,m){var g=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(null!=p)for(var m in p)Object.hasOwnProperty.call(p,m)&&(h[m]=p[m]);return h.default=p,h};Object.defineProperty(h,"__esModule",{value:!0});let y=g(m(1750)),b=m(4007),v=m(6451);h.Sheet=class{get isHidden(){return this._sheetImpl.hidden}get isActive(){return this._sheetImpl.active}get name(){return this._sheetImpl.name}get sheetType(){return this._sheetImpl.sheetType}get size(){if(b.SheetUtils.isValidSheetSize(this._sheetImpl.size))return this._sheetImpl.size;throw new b.TableauError(y.EmbeddingErrorCodes.NotImplemented,"Not implemented")}get url(){if(this.isHidden)throw new b.TableauError(y.EmbeddingErrorCodes.NoUrlForHiddenWorksheet,"No URL for hidden worksheet");return this._sheetImpl.url}get index(){return this._sheetImpl.index}get workbook(){return new v.Workbook(this._workbookImpl)}changeSizeAsync(p){return this._sheetImpl.changeSizeAsync(p)}constructor(p,h){this._sheetImpl=p,this._workbookImpl=h}}},8826:function(p,h,m){var g=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(null!=p)for(var m in p)Object.hasOwnProperty.call(p,m)&&(h[m]=p[m]);return h.default=p,h};Object.defineProperty(h,"__esModule",{value:!0});let y=g(m(1750)),b=m(4007),v=m(6451);h.SheetInfo=class{get name(){return this._sheetInfoImpl.name}get sheetType(){return this._sheetInfoImpl.sheetType}get index(){if(void 0!==this._sheetInfoImpl.index)return this._sheetInfoImpl.index;throw new b.TableauError(y.EmbeddingErrorCodes.ImplementationError,"index not implemented")}get isActive(){return!!this._sheetInfoImpl.isActive&&this._sheetInfoImpl.isActive}get isHidden(){return!!this._sheetInfoImpl.isHidden&&this._sheetInfoImpl.isHidden}get workbook(){return new v.Workbook(this._workbookImpl)}get url(){return this._sheetInfoImpl.url?this._sheetInfoImpl.url:""}get size(){if(b.SheetUtils.isValidSheetSize(this._sheetInfoImpl.sheetSize))return this._sheetInfoImpl.sheetSize;throw new b.TableauError(y.EmbeddingErrorCodes.NotImplemented,"Not implemented")}constructor(p,h){this._sheetInfoImpl=p,this._workbookImpl=h}}},8894:function(p,h,m){var g=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(null!=p)for(var m in p)Object.hasOwnProperty.call(p,m)&&(h[m]=p[m]);return h.default=p,h};Object.defineProperty(h,"__esModule",{value:!0});let y=g(m(1750)),b=m(4007),v=m(7996),I=m(1970),S=m(3440);let u=class u extends v.Sheet{get activeStoryPoint(){if(!this._storyImpl.activeStoryPoint)throw new b.TableauError(y.EmbeddingErrorCodes.ImplementationError,"Active story point has not been initialized");return new I.StoryPoint(this._storyImpl.activeStoryPoint,this._workbookImpl)}get storyPointsInfo(){return this._storyImpl.storyPointsInfo.map(p=>new S.StoryPointInfo(p,this._workbookImpl))}activateNextStoryPointAsync(){return this._storyImpl.activateNextStoryPointAsync().then(p=>new I.StoryPoint(p,this._workbookImpl))}activatePreviousStoryPointAsync(){return this._storyImpl.activatePreviousStoryPointAsync().then(p=>new I.StoryPoint(p,this._workbookImpl))}activateStoryPointAsync(p){return this._storyImpl.activateStoryPointAsync(p).then(p=>new I.StoryPoint(p,this._workbookImpl))}revertStoryPointAsync(p){return this._storyImpl.revertStoryPointAsync(p).then(p=>new S.StoryPointInfo(p,this._workbookImpl))}constructor(p,h){super(p,h),this._storyImpl=p}};h.Story=u},1970:function(p,h,m){var g=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(null!=p)for(var m in p)Object.hasOwnProperty.call(p,m)&&(h[m]=p[m]);return h.default=p,h};Object.defineProperty(h,"__esModule",{value:!0});let y=g(m(1750)),b=m(4007),v=m(1262),I=m(8894),S=m(5334);h.StoryPoint=class{get index(){return this._storyPointImpl.index}get caption(){return this._storyPointImpl.caption}get active(){return this._storyPointImpl.active}get updated(){return this._storyPointImpl.updated}get containedSheet(){let p=this._storyPointImpl.containedSheet;if(p)switch(p.sheetType){case y.SheetType.Worksheet:return new S.Worksheet(p,this._workbookImpl);case y.SheetType.Dashboard:return new v.Dashboard(p,this._workbookImpl);case y.SheetType.Story:throw new b.TableauError(y.EmbeddingErrorCodes.ImplementationError,"A story cannot contain another story");default:throw new b.TableauError(y.EmbeddingErrorCodes.ImplementationError,"Unable to initialize contained sheet")}}get parentStory(){return new I.Story(this._storyPointImpl.parentStory,this._workbookImpl)}constructor(p,h){this._storyPointImpl=p,this._workbookImpl=h}}},3440:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(8894);h.StoryPointInfo=class{get index(){return this._storyPointInfoImpl.index}get caption(){return this._storyPointInfoImpl.caption}get active(){return this._storyPointInfoImpl.active}get updated(){return this._storyPointInfoImpl.updated}get parentStory(){return new g.Story(this._storyPointInfoImpl.parentStory,this._workbookImpl)}constructor(p,h){this._storyPointInfoImpl=p,this._workbookImpl=h}}},9767:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.VizSize=class{get sheetSize(){return this._sheetSize}get chromeHeight(){return this._chromeHeight}constructor(p,h){this._sheetSize=p,this._chromeHeight=h}}},909:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(2848);h.VizUrlMode={Viewing:"views",Authoring:"authoring"};let i=class i{get mode(){return this._segments.mode}get siteId(){return this._segments.siteId}get workbookId(){return this._segments.workbookId}get sheetId(){return this._segments.sheetId}get customView(){return this._segments.customView}static create(p){let h=g.canonicalizeVizPortalRoutingHashes(new URL(p.toString())),m=i._parsePathName(h.pathname);return h.pathname=i._buildPathName(m),new i(h,m)}toURL(){return new URL(this.toString())}toString(){return this._url.toString()}withMode(p){if(this._segments.mode===p)return this;let h=this._getSegmentsForMode(p);return this._makeVizUrlFromPathSegments(h)}withCustomView(p){var h;if(p.luid===(null===(h=this.customView)||void 0===h?void 0:h.luid)&&p.name===this.customView.name)return this;let m=this._getSegmentsForMode(this.mode);return m.customView=p,this._makeVizUrlFromPathSegments(m)}withSheetId(p){if(this.sheetId===p)return this;let h=Object.assign(Object.assign({},this._segments),{sheetId:p});return this._makeVizUrlFromPathSegments(h)}withWorkbookId(p){if(this.workbookId===p)return this;let h=Object.assign(Object.assign({},this._segments),{workbookId:p});return this._makeVizUrlFromPathSegments(h)}_getSegmentsForMode(p){return p===h.VizUrlMode.Authoring&&(this._segments.customView=void 0),Object.assign(Object.assign({},this._segments),{mode:p})}_makeVizUrlFromPathSegments(p){let h=i._buildPathName(p),m=new URL(this._url.toString());return m.pathname=h,new i(m,p)}static _parsePathName(p){var m,g,y;let b,v;let I=p.split("/").filter(p=>p);if(0===I.length)throw Error("Invalid path name");if("t"===I[0]){if(I.length<2)throw Error("Invalid site in path '".concat(p,"'"));b=I[1],I.splice(0,2)}let S=I.shift();if(!S)throw Error("Missing mode in path '".concat(p,"'"));if(!Object.values(h.VizUrlMode).includes(S))throw Error("Invalid Viz Url Mode '".concat(S,"' in path '").concat(p,"'"));if(0===I.length)throw Error("Missing workbook/sheet name in path '".concat(p,"'"));let _=null!=(m=I.shift())?m:"",A=I.shift();if(0!==I.length&&2!==I.length)throw Error("Invalid path name: unknown parts after sheet id: '".concat(p,"'"));return 2===I.length&&(v={luid:null!=(g=I.shift())?g:"",name:null!=(y=I.shift())?y:""}),{mode:S,siteId:b,workbookId:_,sheetId:A,customView:v}}static _buildPathName(p){let m=[];return p.siteId&&(m.push("t"),m.push(p.siteId)),m.push(p.mode),p.workbookId&&m.push(p.workbookId),p.sheetId&&m.push(p.sheetId),p.customView&&p.mode===h.VizUrlMode.Viewing&&(m.push(p.customView.luid),m.push(p.customView.name)),m.join("/")}constructor(p,h){this._url=p,this._segments=h}};h.VizUrl=i},6451:function(p,h,m){var g=this&&this.__importStar||function(p){if(p&&p.__esModule)return p;var h={};if(null!=p)for(var m in p)Object.hasOwnProperty.call(p,m)&&(h[m]=p[m]);return h.default=p,h};Object.defineProperty(h,"__esModule",{value:!0});let y=g(m(1750)),b=m(4007),v=m(206),I=m(1262),S=m(1062),_=m(8826),A=m(8894),T=m(5334);h.Workbook=class{get activeSheet(){switch(this._workbookImpl.activeSheet.sheetType){case y.SheetType.Worksheet:return new T.Worksheet(this._workbookImpl.activeSheet,this._workbookImpl);case y.SheetType.Dashboard:return new I.Dashboard(this._workbookImpl.activeSheet,this._workbookImpl);case y.SheetType.Story:return new A.Story(this._workbookImpl.activeSheet,this._workbookImpl);default:throw new b.TableauError(y.EmbeddingErrorCodes.ImplementationError,"Unable to initialize ActiveSheet")}}get publishedSheetsInfo(){return this._workbookImpl.publishedSheetsInfo.map(p=>new _.SheetInfo(p,this._workbookImpl))}get name(){return this._workbookImpl.name}get activeCustomView(){return this._workbookImpl.activeCustomView?new v.CustomView(this._workbookImpl.activeCustomView,this._workbookImpl):void 0}activateSheetAsync(p){return this._workbookImpl.activateSheetAsync(p).then(p=>(this._workbookImpl!==p&&(this._workbookImpl=p),this.activeSheet))}revertAllAsync(){return this._workbookImpl.revertAllAsync()}getCustomViewsAsync(){return this._workbookImpl.getCustomViewsAsync().then(p=>p.map(p=>new v.CustomView(p,this._workbookImpl)))}showCustomViewAsync(p){return this._workbookImpl.showCustomViewAsync(p).then(p=>new v.CustomView(p,this._workbookImpl))}removeCustomViewAsync(p){return this._workbookImpl.removeCustomViewAsync(p).then(p=>new v.CustomView(p,this._workbookImpl))}saveCustomViewAsync(p){return this._workbookImpl.saveCustomViewAsync(p).then(p=>new v.CustomView(p,this._workbookImpl))}setActiveCustomViewAsDefaultAsync(){return this._workbookImpl.setActiveCustomViewAsDefaultAsync()}getParametersAsync(){return this._workbookImpl.getParametersAsync().then(p=>p.map(p=>new S.Parameter(p)))}changeParameterValueAsync(p,h){return this._workbookImpl.changeParameterValueAsync(p,h).then(h=>{if(h)return new S.Parameter(h);throw new b.TableauError(y.EmbeddingErrorCodes.InvalidParameter,"Invalid parameter:  ".concat(p))})}constructor(p){this._workbookImpl=p}}},5334:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(1262),y=m(7996),b=m(1970);let o=class o extends y.Sheet{get parentDashboard(){return null==this._worksheetImpl.parentDashboard?null:new g.Dashboard(this._worksheetImpl.parentDashboard,this._workbookImpl)}get parentStoryPoint(){return null==this._worksheetImpl.parentStoryPoint?null:new b.StoryPoint(this._worksheetImpl.parentStoryPoint,this._workbookImpl)}getDataSourcesAsync(){return this._worksheetImpl.getDataSourcesAsync()}getSummaryDataAsync(p){return this._worksheetImpl.getSummaryDataAsync(p)}getSummaryDataReaderAsync(p,h){return this._worksheetImpl.getSummaryDataReaderAsync(p,h)}getSummaryColumnsInfoAsync(){return this._worksheetImpl.getSummaryColumnsInfoAsync()}getUnderlyingDataAsync(p){return console.warn("Worksheet.getUnderlyingDataAsync is deprecated. Please use Worksheet.getUnderlyingTablesAsync and Worksheet.getUnderlyingTableDataAsync"),this._worksheetImpl.getUnderlyingDataAsync(p)}getUnderlyingTablesAsync(){return this._worksheetImpl.getUnderlyingTablesAsync()}getUnderlyingTableDataAsync(p,h){return this._worksheetImpl.getUnderlyingTableDataAsync(p,h)}getUnderlyingTableDataReaderAsync(p,h,m){return this._worksheetImpl.getUnderlyingTableDataReaderAsync(p,h,m)}getFiltersAsync(){return this._worksheetImpl.getFiltersAsync()}applyFilterAsync(p,h,m,g){return this._worksheetImpl.applyFilterAsync(p,h,m,g)}applyRangeFilterAsync(p,h){return this._worksheetImpl.applyRangeFilterAsync(p,h)}clearFilterAsync(p){return this._worksheetImpl.clearFilterAsync(p)}applyRelativeDateFilterAsync(p,h){return this._worksheetImpl.applyRelativeDateFilterAsync(p,h)}applyHierarchicalFilterAsync(p,h,m,g){return this._worksheetImpl.applyHierarchicalFilterAsync(p,h,m,g)}clearSelectedMarksAsync(){return this._worksheetImpl.clearSelectedMarksAsync()}getSelectedMarksAsync(){return this._worksheetImpl.getSelectedMarksAsync()}annotateMarkAsync(p,h){return this._worksheetImpl.annotateMarkAsync(p,h)}getAnnotationsAsync(){return this._worksheetImpl.getAnnotationsAsync()}removeAnnotationAsync(p){return this._worksheetImpl.removeAnnotationAsync(p)}selectMarksByValueAsync(p,h){return this._worksheetImpl.selectMarksByValueAsync(p,h)}appendContextMenuAsync(p,h){return this._worksheetImpl.appendContextMenuAsync(p,h)}removeContextMenuAsync(p,h){return this._worksheetImpl.removeContextMenuAsync(p,h)}executeContextMenuAsync(p,h){return this._worksheetImpl.executeContextMenuAsync(p,h)}renameContextMenuAsync(p,h,m){return this._worksheetImpl.renameContextMenuAsync(p,h,m)}constructor(p,h){super(p,h),this._worksheetImpl=p}};h.Worksheet=o},8345:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(4007);let i=class i extends g.NotificationServiceImplBase{get serviceName(){return"initialization-service"}};h.InitializationServiceImpl=i},4450:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(4695),y=m(4007);let a=class a extends y.ServiceImplBase{get serviceName(){return"ToolbarService"}revertAllAsync(){let p=g.VerbId.RevertWorkbook,h={[g.ParameterId.FunctionName]:"revertAllAsync"};return this.execute(p,h).then(p=>{})}redoAsync(){let p=g.VerbId.Redo,h={[g.ParameterId.FunctionName]:"redoAsync"};return this.execute(p,h).then(p=>{})}undoAsync(){let p=g.VerbId.Undo,h={[g.ParameterId.FunctionName]:"undoAsync"};return this.execute(p,h).then(p=>{})}exportImageAsync(){let p=g.VerbId.ExportImage,h={[g.ParameterId.FunctionName]:"exportImageAsync"};return this.execute(p,h).then(p=>{})}setAutoUpdateAsync(p){let h=g.VerbId.SetAutoUpdate,m={[g.ParameterId.FunctionName]:"setAutoUpdateAsync",[g.ParameterId.State]:p};return this.execute(h,m).then(()=>{})}displayDownloadWorkbookDialogAsync(){let p=g.VerbId.DownloadWorkbook,h={[g.ParameterId.FunctionName]:"displayDialogAsync(Workbook)"};return this.execute(p,h).then(p=>{})}displayExportPdfDialogAsync(){let p=g.VerbId.ExportPdf,h={[g.ParameterId.FunctionName]:"displayDialogAsync(ExportPDF)"};return this.execute(p,h).then(p=>{})}displayExportPowerpointDialogAsync(){let p=g.VerbId.ExportPowerpoint,h={[g.ParameterId.FunctionName]:"displayDialogAsync(ExportPowerPoint)"};return this.execute(p,h).then(p=>{})}displayExportDataDialogAsync(){let p=g.VerbId.ExportData,h={[g.ParameterId.FunctionName]:"displayDialogAsync(ExportData)"};return this.execute(p,h).then(p=>{})}displayExportCrosstabDialogAsync(){let p=g.VerbId.ExportCrosstab,h={[g.ParameterId.FunctionName]:"displayDialogAsync(ExportCrossTab)"};return this.execute(p,h).then(p=>{})}displayShareDialogAsync(){let p=g.VerbId.Share,h={[g.ParameterId.FunctionName]:"displayDialogAsync(Share)"};return this.execute(p,h).then(p=>{})}};h.ToolbarServiceImpl=a},4104:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(4007),y=m(8345),b=m(4450);h.registerAllEmbeddingServices=function(p,h){let m=g.ApiServiceRegistry.get(h);m.registerService(new g.ClientInfoServiceImpl(p,h)),m.registerService(new g.SizeServiceImpl(p,h)),m.registerService(new g.StoryActivationServiceImpl(p,h)),m.registerService(new b.ToolbarServiceImpl(p,h))},h.registerInitializationEmbeddingServices=function(p,h){g.ApiServiceRegistry.get(h).registerService(new y.InitializationServiceImpl(p))}},7193:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(4104);h.registerAllEmbeddingServices=g.registerAllEmbeddingServices,h.registerInitializationEmbeddingServices=g.registerInitializationEmbeddingServices},9701:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});let r=class r{};h.HtmlElementHelpers=r,r.getContentSize=p=>{let h=window.getComputedStyle(p),m=parseInt(h.paddingLeft,10)||0,g=parseInt(h.paddingTop,10)||0,y=parseInt(h.paddingRight,10)||0,b=parseInt(h.paddingBottom,10)||0;return{width:p.clientWidth-Math.round(m+y),height:p.clientHeight-Math.round(g+b)}}},5620:function(p,h){var m=this&&this.__awaiter||function(p,h,m,g){return new(m||(m=Promise))(function(y,b){function o(p){try{l(g.next(p))}catch(p){b(p)}}function s(p){try{l(g.throw(p))}catch(p){b(p)}}function l(p){var h;p.done?y(p.value):((h=p.value)instanceof m?h:new m(function(p){p(h)})).then(o,s)}l((g=g.apply(p,h||[])).next())})};Object.defineProperty(h,"__esModule",{value:!0}),h.PromiseQueue=class{add(p){return new Promise((h,g)=>{this.queue.push(()=>m(this,void 0,void 0,function*(){try{let m=yield p();h(m)}catch(p){g(p)}finally{this.pending--,this.poll()}}))})}poll(){if(this.pending<this.concurrency&&this.queue.length>0){let p=this.queue.shift();this.pending++,p()}}size(){return this.queue.length}constructor(){this.queue=[],this.pending=0,this.concurrency=1}}},3630:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});let g=m(5620);let i=class i{static registerWebComponent(p){let h=this.embeddingIndex;return this.webComponents.set(h,p),this.embeddingIndex++,h}static unregisterWebComponent(p){this.webComponents.delete(p)}static getWebComponents(){let p=new Map;return this.webComponents.forEach((h,m)=>{p.set(m,h)}),p}static synchronizeRender(p){let h=this.queue.add(p);return this.queue.poll(),h}static clear(){this.webComponents.clear()}};h.WebComponentManager=i,i.embeddingIndex=0,i.webComponents=new Map,i.queue=new g.PromiseQueue},9654:(p,h,m)=>{function n(p){for(var m in p)h.hasOwnProperty(m)||(h[m]=p[m])}Object.defineProperty(h,"__esModule",{value:!0}),n(m(2996));var g=m(3069);h.ApiMenuType=g.ApiMenuType,h.CrosstabFileFormat=g.CrosstabFileFormat,h.DeviceType=g.DeviceType,h.EmbeddingErrorCodes=g.EmbeddingErrorCodes,h.PrintOrientation=g.PrintOrientation,h.PrintPageSize=g.PrintPageSize,h.PrintScaling=g.PrintScaling,h.SheetSizeBehavior=g.SheetSizeBehavior,h.TableauDialogType=g.TableauDialogType,h.EmbeddingTableauEventType=g.TableauEventType,h.Toolbar=g.Toolbar,n(m(7940)),n(m(7154)),n(m(6408))},1615:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(423);h.ErrorCodes=g.ErrorCodes,h.ExtensionContext=g.ExtensionContext,h.ExtensionMode=g.ExtensionMode,h.TableauEventType=g.TableauEventType,h.VizImageEncodingType=g.VizImageEncodingType,h.VizImagePaletteType=g.VizImagePaletteType,h.VizImageSizeSettingAlignmentType=g.VizImageSizeSettingAlignmentType,h.VizImageSizeSettingType=g.VizImageSizeSettingType,h.VizImageSortDirectionType=g.VizImageSortDirectionType,function(p){for(var m in p)h.hasOwnProperty(m)||(h[m]=p[m])}(m(6408))},1750:(p,h,m)=>{function n(p){for(var m in p)h.hasOwnProperty(m)||(h[m]=p[m])}Object.defineProperty(h,"__esModule",{value:!0}),n(m(9654)),n(m(1615))},2996:(p,h)=>{var m;Object.defineProperty(h,"__esModule",{value:!0}),(m=h.AskDataAttributes||(h.AskDataAttributes={})).Origin="origin",m.ShowEmbed="show-embed",m.ShowPin="show-pin",m.ShowSave="show-save",m.ShowShare="show-share"},3069:(p,h)=>{var m,g,y,b,v,I,S,_,A,T,w,P,E;Object.defineProperty(h,"__esModule",{value:!0}),(E=h.CrosstabFileFormat||(h.CrosstabFileFormat={})).CSV="csv",E.Excel="xlsx",(P=h.DeviceType||(h.DeviceType={})).Default="default",P.Desktop="desktop",P.Tablet="tablet",P.Phone="phone",(w=h.EmbeddingErrorCodes||(h.EmbeddingErrorCodes={})).AuthFailed="auth-failed",w.BrowserNotCapable="browser-not-capable",w.DownloadWorkbookNotAllowed="download-workbook-not-allowed",w.FilterCannotBePerformed="filter-cannot-be-performed",w.IndexOutOfRange="index-out-of-range",w.InternalError="internal-error",w.InvalidCustomViewName="invalid-custom-view-name",w.InvalidDateParameter="invalid-date-parameter",w.invalidFilterFieldNameOrValue="invalid-filter-field-name",w.InvalidParameter="invalid-parameter",w.InvalidSize="invalid-size",w.InvalidSizeBehavior="invalid-size-behavior",w.InvalidSizeBehaviorOnWorksheet="invalid-size-behavior-on-worksheet",w.InvalidUrl="invalid-url",w.MissingMaxSize="missing-max-size",w.MissingMinSize="missing-min-size",w.MissingMinMaxSize="missing-min-max-size",w.MissingParameter="missing-parameter",w.MissingRangeNForRelativeDateFilters="missing-range-n-for-relative-date-filters",w.NoUrlForHiddenWorksheet="no-url-for-hidden-worksheet",w.NoUrlOrParentElementNotFound="no-url-or-parent-element-not-found",w.NotActiveSheet="not-active-sheet",w.NullOrEmptyParameter="null-or-empty-parameter",w.SheetNotInWorkbook="sheet-not-in-workbook",w.StaleDataReference="stale-data-reference",w.UnknownAuthError="unknown-auth-error",w.UnsupportedEventName="unsupported-event-name",w.VizAlreadyInManager="viz-already-in-manager",w.ImplementationError="wrong-implementation",w.NotImplemented="not-implemented",w.EventInitializationError="event-initialization-error",w.IncompatibleVersionError="incompatible-version-error",w.UnknownDialogType="unknown-dialog-type",w.FilterMissingOrNotImplemented="filter-missing-not-implemented",w.StoryPointIdMismatch="storypoint-id-mismatch",(T=h.FileFormats||(h.FileFormats={})).PDF="pdf",T.PNG="png",(A=h.PrintOrientation||(h.PrintOrientation={})).Portrait="portrait",A.Landscape="landscape",(_=h.PrintPageSize||(h.PrintPageSize={})).Letter="letter",_.Legal="legal",_.Note="note",_.Folio="folio",_.Tabloid="tabloid",_.Ledger="ledger",_.Statement="statement",_.Executive="executive",_.A3="A3",_.A4="A4",_.A5="A5",_.B4="B4",_.B5="B5",_.Quarto="quarto",_.Unspecified="unspecified",(S=h.PrintScaling||(h.PrintScaling={})).Automatic="automatic",S.Perc25="25%",S.Perc50="50%",S.Perc60="60%",S.Perc75="75%",S.Perc80="80%",S.Perc90="90%",S.Perc100="100%",S.Perc200="200%",S.Perc400="400%",S.AtMost1PageHigh="at-most-1-page-high",S.AtMost2PagesHigh="at-most-2-pages-high",S.AtMost1PageWide="at-most-1-page-wide",S.AtMost2PagesWide="at-most-2-pages-wide",(I=h.RevertVizSelection||(h.RevertVizSelection={})).All="all",I.Axes="axes",I.Filters="filters",I.Sorts="sorts",I.Shelves="shelves",(v=h.ToolbarButtons||(h.ToolbarButtons={})).Alerts="alerts",v.AskData="askData",v.CustomViews="customViews",v.DataDetails="dataDetails",v.Share="share",v.Subscribe="subscribe",(b=h.Toolbar||(h.Toolbar={})).Top="top",b.Bottom="bottom",b.Hidden="hidden",(y=h.SheetSizeBehavior||(h.SheetSizeBehavior={})).Automatic="automatic",y.Exactly="exactly",y.Range="range",y.AtLeast="atleast",y.AtMost="atmost",(g=h.TableauEventType||(h.TableauEventType={})).CustomViewLoaded="customviewloaded",g.CustomViewRemoved="customviewremoved",g.CustomViewSaved="customviewsaved",g.CustomViewSetDefault="customviewsetdefault",g.EditButtonClicked="editbuttonclicked",g.EditInDesktopButtonClicked="editindesktopbuttonclicked",g.FilterChanged="filterchanged",g.FirstVizSizeKnown="firstvizsizeknown",g.FirstInteractive="firstinteractive",g.CustomMarkContextMenuEvent="custommarkcontextmenu",g.MarkSelectionChanged="markselectionchanged",g.ParameterChanged="parameterchanged",g.ToolbarStateChanged="toolbarstatechanged",g.WorkbookReadyToClose="workbookreadytoclose",g.WorkbookPublished="workbookpublished",g.WorkbookPublishedAs="workbookpublishedas",g.UrlAction="urlaction",g.TabSwitched="tabswitched",g.StoryPointSwitched="storypointswitched",g.VizLoadError="vizloaderror",g.IframeSrcUpdated="iframesrcupdated",(h.ApiMenuType||(h.ApiMenuType={})).Ubertip="ubertip",(m=h.TableauDialogType||(h.TableauDialogType={})).ExportPDF="export-pdf",m.ExportPowerPoint="export-powerpoint",m.ExportData="export-data",m.ExportCrossTab="export-cross-tab",m.ExportWorkbook="export-workbook",m.Share="share"},7940:(p,h)=>{var m,g,y,b,v;Object.defineProperty(h,"__esModule",{value:!0}),(v=h.VizSharedAttributes||(h.VizSharedAttributes={})).TouchOptimize="touch-optimize",v.HideEditInDesktopButton="hide-edit-in-desktop-button",v.SuppressDefaultEditBehavior="suppress-default-edit-behavior",v.DisableVersionCheck="disable-version-check",v.OnEditInDesktopButtonClicked="onEditInDesktopButtonClicked",v.OnFirstVizSizeKnown="onFirstVizSizeKnown",v.OnFirstInteractive="onFirstInteractive",(b=h.VizAttributes||(h.VizAttributes={})).DisableUrlActionsPopups="disable-url-actions",b.HideTabs="hide-tabs",b.Toolbar="toolbar",b.InstanceIdToClone="instance-id-to-clone",b.Device="device",b.HideEditButton="hide-edit-button",b.OnEditButtonClicked="onEditButtonClicked",b.OnFilterChanged="onFilterChanged",b.OnCustomMarkContextMenuEvent="onCustomMarkContextMenuEvent",b.OnMarkSelectionChanged="onMarkSelectionChanged",b.OnParameterChanged="onParameterChanged",b.OnToolbarStateChanged="onToolbarStateChanged",b.OnUrlAction="onUrlAction",b.OnTabSwitched="onTabSwitched",b.OnCustomViewLoaded="onCustomViewLoaded",b.OnCustomViewRemoved="onCustomViewRemoved",b.OnCustomViewSaved="onCustomViewSaved",b.OnCustomViewSetDefault="onCustomViewSetDefault",b.OnStoryPointSwitched="onStoryPointSwitched",(y=h.VizAuthoringAttributes||(h.VizAuthoringAttributes={})).OnWorkbookPublished="onWorkbookPublished",y.OnWorkbookPublishedAs="onWorkbookPublishedAs",y.OnWorkbookReadyToClose="onWorkbookReadyToClose",y.HideCloseButton="hide-close-button",(g=h.VizChildElements||(h.VizChildElements={})).VizFilter="viz-filter",g.VizParameter="viz-parameter",g.CustomParameter="custom-parameter",(m=h.VizChildElementAttributes||(h.VizChildElementAttributes={})).Field="field",m.Value="value",m.Name="name"},7154:(p,h)=>{var m,g;Object.defineProperty(h,"__esModule",{value:!0}),(g=h.WebComponentAttributes||(h.WebComponentAttributes={})).Src="src",g.Width="width",g.Height="height",g.Token="token",g.Debug="debug",g.IframeAuth="iframe-auth",g.OnVizLoadError="onvizloaderror",(h.WebComponentChildElements||(h.WebComponentChildElements={})).CustomParameter="custom-parameter",(m=h.WebComponentChildElementAttributes||(h.WebComponentChildElementAttributes={})).Field="field",m.Value="value",m.Name="name"},423:p=>{var h,m,g,y,b,v,I,S,_,A,T;(T=(m=h||(h={})).ErrorCodes||(m.ErrorCodes={})).APINotInitialized="api-not-initialized",T.VisibilityError="visibility-error",T.DialogAlreadyOpen="dialog-already-open",T.DialogClosedByUser="dialog-closed-by-user",T.InternalError="internal-error",T.InvalidDomainDialog="invalid-dialog-domain",T.InvalidParameter="invalid-parameter",T.MissingFilter="missing-filter",T.MissingParameter="missing-parameter",T.ServerError="server-error",T.SettingSaveInProgress="setting-save-in-progress",T.UnsupportedEventName="unsupported-event-name",T.UnsupportedMethodForDataSourceType="unsupported-method-for-data-source-type",(A=m.ExtensionContext||(m.ExtensionContext={})).Desktop="desktop",A.Server="server",(_=m.ExtensionMode||(m.ExtensionMode={})).Authoring="authoring",_.Viewing="viewing",(S=m.TableauEventType||(m.TableauEventType={})).FilterChanged="filter-changed",S.MarkSelectionChanged="mark-selection-changed",S.ParameterChanged="parameter-changed",S.SettingsChanged="settings-changed",S.DashboardLayoutChanged="dashboard-layout-changed",S.WorkbookFormattingChanged="workbook-formatting-changed",(I=m.VizImageEncodingType||(m.VizImageEncodingType={})).Discrete="discrete",I.Continuous="continuous",(v=m.VizImageSortDirectionType||(m.VizImageSortDirectionType={})).Ascending="ascending",v.Descending="descending",(b=m.VizImagePaletteType||(m.VizImagePaletteType={})).CustomDiverging="custom-diverging",b.CustomSequential="custom-sequential",(y=m.VizImageSizeSettingType||(m.VizImageSizeSettingType={})).Fixed="fixed",y.Manual="manual",(g=m.VizImageSizeSettingAlignmentType||(m.VizImageSizeSettingAlignmentType={})).Right="right",g.Left="left",g.Center="center",p.exports=h},6818:(p,h)=>{var m;Object.defineProperty(h,"__esModule",{value:!0}),(m=h.SharedErrorCodes||(h.SharedErrorCodes={})).CrosstabCreationError="crosstab-creation-error",m.DataCreationError="data-creation-error",m.InvalidAggregationFieldName="invalid-aggregation-field-name",m.InvalidFilterFieldName="invalid-filter-name",m.InvalidFilterFieldValue="invalid-filter-fieldValue",m.InvalidSelectionDate="invalid-selection-date",m.InvalidSelectionFieldName="invalid-selection-fieldName",m.InvalidSelectionValue="invalid-selection-value",m.InvalidSelectionSheet="invalid-selection-sheet",m.InternalError="internal-error",m.InvalidParameter="invalid-parameter",m.PDFCreationError="pdf-creation-error",m.PowerPointCreationError="powerpoint-creation-error",m.NotActiveSheet="not-active-sheet",m.ImplementationError="wrong-implementation",m.ApiExecutionError="api-execution-error",m.ServerError="server-error",m.Timeout="timeout"},4953:function(p){var h,m,g,y,b,v,I,S,_,A,T,w,P,E,C,D,k,x,O,V,N,M,F,R,z,j,U,L,W,H,B,G=this&&this.__assign||function(){return(G=Object.assign||function(p){for(var h,m=1,g=arguments.length;m<g;m++)for(var y in h=arguments[m])Object.prototype.hasOwnProperty.call(h,y)&&(p[y]=h[y]);return p}).apply(this,arguments)};(W=(h=B||(B={})).AnalyticsObjectType||(h.AnalyticsObjectType={})).Cluster="cluster",W.Forecast="forecast",W.TrendLine="trend-line",(L=h.AnnotationType||(h.AnnotationType={})).Mark="mark",L.Point="point",L.Area="area",(U=h.ColumnType||(h.ColumnType={})).Discrete="discrete",U.Continuous="continuous",(j=h.ClassNameKey||(h.ClassNameKey={})).WorksheetTitle="tableau-worksheet-title",j.Worksheet="tableau-worksheet",j.Tooltip="tableau-tooltip",j.StoryTitle="tableau-story-title",j.DashboardTitle="tableau-dashboard-title",(z=h.DashboardObjectType||(h.DashboardObjectType={})).Blank="blank",z.Worksheet="worksheet",z.QuickFilter="quick-filter",z.ParameterControl="parameter-control",z.PageFilter="page-filter",z.Legend="legend",z.Title="title",z.Text="text",z.Image="image",z.WebPage="web-page",z.Extension="extension",(H=m=h.DashboardObjectVisibilityType||(h.DashboardObjectVisibilityType={})).Show="show",H.Hide="hide",(R=h.DataType||(h.DataType={})).String="string",R.Int="int",R.Float="float",R.Bool="bool",R.Date="date",R.DateTime="date-time",R.Spatial="spatial",(F=h.DashboardLayoutChange||(h.DashboardLayoutChange={})).Added="added",F.Removed="removed",F.IsFloatingChanged="is-floating-changed",F.IsVisibleChanged="is-visible-changed",F.PositionChanged="position-changed",F.SizeChanged="size-changed",F.NameChanged="name-changed",(M=h.DateRangeType||(h.DateRangeType={})).Last="last",M.LastN="last-n",M.Next="next",M.NextN="next-n",M.Current="current",M.ToDate="to-date",(N=h.DialogStyle||(h.DialogStyle={})).Window="window",N.Modal="modal",N.Modeless="modeless",(V=h.EncodingType||(h.EncodingType={})).Column="column",V.Row="row",V.Page="page",V.Filter="filter",V.MarksType="marks-type",V.MeasureValues="measure-values",V.Color="color",V.Size="size",V.Label="label",V.Detail="detail",V.Tooltip="tooltip",V.Shape="shape",V.Path="path",V.Angle="angle",(O=h.FieldAggregationType||(h.FieldAggregationType={})).Sum="sum",O.Avg="avg",O.Min="min",O.Max="max",O.Stdev="stdev",O.Stdevp="stdevp",O.Var="var",O.Varp="varp",O.Collect="collect",O.Count="count",O.Countd="countd",O.Median="median",O.Attr="attr",O.None="none",O.Year="year",O.Qtr="qtr",O.Month="month",O.Day="day",O.Hour="hour",O.Minute="minute",O.Second="second",O.Week="week",O.Weekday="weekday",O.MonthYear="month-year",O.Mdy="mdy",O.End="end",O.TruncYear="trunc-year",O.TruncQtr="trunc-qtr",O.TruncMonth="trunc-month",O.TruncWeek="trunc-week",O.TruncDay="trunc-day",O.TruncHour="trunc-hour",O.TruncMinute="trunc-minute",O.TruncSecond="trunc-second",O.Quart1="quart1",O.Quart3="quart3",O.Skewness="skewness",O.Kurtosis="kurtosis",O.InOut="in-out",O.User="user",(x=h.FieldRoleType||(h.FieldRoleType={})).Dimension="dimension",x.Measure="measure",x.Unknown="unknown",(k=h.FilterType||(h.FilterType={})).Categorical="categorical",k.Range="range",k.Hierarchical="hierarchical",k.RelativeDate="relative-date",(D=h.FilterUpdateType||(h.FilterUpdateType={})).Add="add",D.All="all",D.Replace="replace",D.Remove="remove",(C=h.FilterDomainType||(h.FilterDomainType={})).Relevant="relevant",C.Database="database",(E=h.FilterNullOption||(h.FilterNullOption={})).NullValues="null-values",E.NonNullValues="non-null-values",E.AllValues="all-values",(P=h.IncludeDataValuesOption||(h.IncludeDataValuesOption={})).AllValues="all-values",P.OnlyNativeValues="only-native-values",P.OnlyFormattedValues="only-formatted-values",(w=h.MarkType||(h.MarkType={})).Bar="bar",w.Line="line",w.Area="area",w.Square="square",w.Circle="circle",w.Shape="shape",w.Text="text",w.Map="map",w.Pie="pie",w.GanttBar="gantt-bar",w.Polygon="polygon",(T=h.ParameterValueType||(h.ParameterValueType={})).All="all",T.List="list",T.Range="range",(A=h.PeriodType||(h.PeriodType={})).Years="years",A.Quarters="quarters",A.Months="months",A.Weeks="weeks",A.Days="days",A.Hours="hours",A.Minutes="minutes",A.Seconds="seconds",(_=h.QuickTableCalcType||(h.QuickTableCalcType={})).RunningTotal="running-total",_.Difference="difference",_.PercentDifference="percent-difference",_.PercentOfTotal="percent-of-total",_.Rank="rank",_.Percentile="percentile",_.MovingAverage="moving-average",_.YTDTotal="ytd-total",_.CompoundGrowthRate="compound-growth-rate",_.YearOverYearGrowth="year-over-year-growth",_.YTDGrowth="ytd-growth",_.Undefined="undefined",(S=h.SelectionUpdateType||(h.SelectionUpdateType={})).Replace="select-replace",S.Add="select-add",S.Remove="select-remove",(I=h.SheetType||(h.SheetType={})).Dashboard="dashboard",I.Story="story",I.Worksheet="worksheet",(v=h.SortDirection||(h.SortDirection={})).Increasing="increasing",v.Decreasing="decreasing",(b=h.TrendLineModelType||(h.TrendLineModelType={})).Linear="linear",b.Logarithmic="logarithmic",b.Exponential="exponential",b.Polynomial="polynomial",(y=h.ReplaySpeedType||(h.ReplaySpeedType={})).Slow="slow",y.Normal="normal",y.Fast="fast",(g=h.HierarchicalLevelSelectionState||(h.HierarchicalLevelSelectionState={})).AllSelected="all-selected",g.NoneSelected="none-selected",g.SomeSelected="some-selected",g.UnknownSelected="unknown-selected",h.ZoneVisibilityType=G({},m),p.exports=B},6408:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0}),function(p){for(var m in p)h.hasOwnProperty(m)||(h[m]=p[m])}(m(6818));var g=m(4953);h.AnalyticsObjectType=g.AnalyticsObjectType,h.AnnotationType=g.AnnotationType,h.ClassNameKey=g.ClassNameKey,h.ColumnType=g.ColumnType,h.DashboardLayoutChange=g.DashboardLayoutChange,h.DashboardObjectType=g.DashboardObjectType,h.DashboardObjectVisibilityType=g.DashboardObjectVisibilityType,h.DataType=g.DataType,h.DateRangeType=g.DateRangeType,h.DialogStyle=g.DialogStyle,h.EncodingType=g.EncodingType,h.FieldAggregationType=g.FieldAggregationType,h.FieldRoleType=g.FieldRoleType,h.FilterDomainType=g.FilterDomainType,h.FilterNullOption=g.FilterNullOption,h.FilterType=g.FilterType,h.FilterUpdateType=g.FilterUpdateType,h.HierarchicalLevelSelectionState=g.HierarchicalLevelSelectionState,h.IncludeDataValuesOption=g.IncludeDataValuesOption,h.MarkType=g.MarkType,h.ParameterValueType=g.ParameterValueType,h.PeriodType=g.PeriodType,h.QuickTableCalcType=g.QuickTableCalcType,h.ReplaySpeedType=g.ReplaySpeedType,h.SelectionUpdateType=g.SelectionUpdateType,h.SheetType=g.SheetType,h.SortDirection=g.SortDirection,h.TrendLineModelType=g.TrendLineModelType,h.ZoneVisibilityType=g.ZoneVisibilityType},4695:(p,h,m)=>{function n(p){for(var m in p)h.hasOwnProperty(m)||(h[m]=p[m])}Object.defineProperty(h,"__esModule",{value:!0}),m(5611),m(2316),m(47);var g=m(2725);h.INTERNAL_CONTRACT_VERSION=g,n(m(7850)),n(m(4063)),n(m(5879)),n(m(5257)),n(m(5681)),n(m(967)),n(m(8075)),n(m(550)),n(m(3590)),n(m(408)),n(m(3526)),n(m(9394)),h.MESSAGING_VERSION={major:1,minor:0,fix:0}},7850:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(4063),y=function(){function e(){}return e.isSpecial=function(p){return p.length>2&&"%"===p[0]&&"%"===p[p.length-1]},e.parseBoolean=function(p){var h=p.toLowerCase();return"true"!==h&&"false"!==h?this.specialValueIndicator:"true"===h},e.parseNumber=function(p){var h=Number(p);return isNaN(h)?this.specialValueIndicator:h},e.parseDate=function(p){var h=new Date(p);return Number.isNaN(h.getTime())?null:h},e.parseDateTime=function(p){var h=p.replace(" ","T").concat("Z"),m=new Date(h);return Number.isNaN(m.getTime())?null:m},e.convertValueAsStringToValue=function(p,h){if(null!=p){if(this.isSpecial(p))return p;switch(h){case g.DataType.Bool:return this.parseBoolean(p);case g.DataType.Int:case g.DataType.Float:return this.parseNumber(p);case g.DataType.Date:return null===this.parseDate(p)?this.specialValueIndicator:p;case g.DataType.DateTime:return null===this.parseDateTime(p)?this.specialValueIndicator:p;case g.DataType.Spatial:case g.DataType.String:default:return p}}},e.convertValueToNativeValue=function(p,h){if(null==p)return null;switch(h){case g.DataType.Bool:case g.DataType.Int:case g.DataType.Float:return"string"==typeof p?null:p;case g.DataType.Date:return this.parseDate(p);case g.DataType.DateTime:return this.parseDateTime(p);case g.DataType.String:return this.isSpecial(p)?null:p;case g.DataType.Spatial:default:return p}},e.convertStringValueToNativeValue=function(p,h){return this.convertValueToNativeValue(this.convertValueAsStringToValue(p,h),h)},e.specialValueIndicator="%null%",e}();h.DataTypeConverter=y},4063:(p,h)=>{var m,g,y,b,v,I,S,_,A,T,w,P,E,C,D,k,x,O,V,N,M,F,R,z,j,U,L,W,H,B,G;Object.defineProperty(h,"__esModule",{value:!0}),(G=h.ExtensionContext||(h.ExtensionContext={})).Desktop="desktop",G.Server="server",G.Unknown="unknown",(B=h.ExtensionMode||(h.ExtensionMode={})).Authoring="authoring",B.Viewing="viewing",B.Unknown="unknown",(H=h.AnnotateEnum||(h.AnnotateEnum={})).Mark="mark",H.Point="point",H.Area="area",(W=h.ColumnType||(h.ColumnType={})).Discrete="discrete",W.Continuous="continuous",(L=h.DashboardObjectType||(h.DashboardObjectType={})).Blank="blank",L.Worksheet="worksheet",L.QuickFilter="quick-filter",L.ParameterControl="parameter-control",L.PageFilter="page-filter",L.Legend="legend",L.Title="title",L.Text="text",L.Image="image",L.WebPage="web-page",L.Extension="extension",(U=h.DataType||(h.DataType={})).String="string",U.Int="int",U.Float="float",U.Bool="bool",U.Date="date",U.DateTime="date-time",U.Spatial="spatial",(j=h.DialogStyle||(h.DialogStyle={})).Window="window",j.Modal="modal",j.Modeless="modeless",(z=h.EncodedDataType||(h.EncodedDataType={})).Number="number",z.String="string",z.Date="date",z.Boolean="boolean",(R=h.ErrorCodes||(h.ErrorCodes={})).INITIALIZATION_ERROR="initialization-error",R.INTERNAL_ERROR="internal-error",R.MISSING_ENUM_MAPPING="missing-enum-mapping",R.MISSING_PARAMETER="missing-parameter",R.PERMISSION_DENIED="permission-denied",R.PRES_MODEL_PARSING_ERROR="pres-model-parsing-error",R.VERSION_NOT_CONFIGURED="version-not-configured",R.VISIBILITY_ERROR="visibility-error",R.UNKNOWN_VERB_ID="unknown-verb-id",(F=h.FieldAggregationType||(h.FieldAggregationType={})).Sum="sum",F.Avg="avg",F.Min="min",F.Max="max",F.Stdev="stdev",F.Stdevp="stdevp",F.Var="var",F.Varp="varp",F.Collect="collect",F.Count="count",F.Countd="countd",F.Median="median",F.Attr="attr",F.None="none",F.Year="year",F.Qtr="qtr",F.Month="month",F.Day="day",F.Hour="hour",F.Minute="minute",F.Second="second",F.Week="week",F.Weekday="weekday",F.MonthYear="month-year",F.Mdy="mdy",F.End="end",F.TruncYear="trunc-year",F.TruncQtr="trunc-qtr",F.TruncMonth="trunc-month",F.TruncWeek="trunc-week",F.TruncDay="trunc-day",F.TruncHour="trunc-hour",F.TruncMinute="trunc-minute",F.TruncSecond="trunc-second",F.Quart1="quart1",F.Quart3="quart3",F.Skewness="skewness",F.Kurtosis="kurtosis",F.InOut="in-out",F.User="user",(M=h.FieldRoleType||(h.FieldRoleType={})).Dimension="dimension",M.Measure="measure",M.Unknown="unknown",(N=h.FilterUpdateType||(h.FilterUpdateType={})).Add="add",N.All="all",N.Replace="replace",N.Remove="remove",(V=h.SheetType||(h.SheetType={})).Dashboard="dashboard",V.Story="story",V.Worksheet="worksheet",(O=h.DomainRestrictionType||(h.DomainRestrictionType={})).All="all",O.List="list",O.Range="range",(x=h.DateStepPeriod||(h.DateStepPeriod={})).Years="years",x.Quarters="quarters",x.Months="months",x.Weeks="weeks",x.Days="days",x.Hours="hours",x.Minutes="minutes",x.Seconds="seconds",(k=h.FilterNullOption||(h.FilterNullOption={})).NullValues="nullvalues",k.NonNullValues="nonnullvalues",k.AllValues="allvalues",(D=h.FilterDomainType||(h.FilterDomainType={})).Relevant="relevant",D.Database="database",(C=h.SelectionUpdateType||(h.SelectionUpdateType={})).Replace="select-replace",C.Add="select-add",C.Remove="select-remove",(E=h.QuantitativeIncludedValues||(h.QuantitativeIncludedValues={})).IncludeNull="include-null",E.IncludeNonNull="include-non-null",E.IncludeAll="include-all",(P=h.HierarchicalLevelSelectionState||(h.HierarchicalLevelSelectionState={})).AllSelected="all-selected",P.NoneSelected="none-selected",P.SomeSelected="some-selected",P.UnknownSelected="unknown-selected",(w=h.MarkType||(h.MarkType={})).Bar="bar",w.Line="line",w.Area="area",w.Square="square",w.Circle="circle",w.Shape="shape",w.Text="text",w.Map="map",w.Pie="pie",w.GanttBar="gantt-bar",w.Polygon="polygon",(T=h.FilterType||(h.FilterType={})).Categorical="categorical",T.Range="range",T.RelativeDate="relativeDate",T.Hierarchical="hierarchical",(A=h.DateRangeType||(h.DateRangeType={})).Last="last",A.LastN="lastN",A.Next="next",A.NextN="nextN",A.Current="current",A.ToDate="toDate",(_=h.ExtensionDialogResult||(h.ExtensionDialogResult={})).DialogAlreadyOpen="dialog-already-open",_.InvalidDomain="invalid-domain",_.Success="success",(S=h.ApiShowDataTableSentinel||(h.ApiShowDataTableSentinel={})).SingleTableId="single-table-id-sentinel",S.SingleTableCaption="Single table id sentinel",(I=h.ApiShowDataTableFormat||(h.ApiShowDataTableFormat={})).NativeValuesOnly="native-values-only",I.FormattedValuesOnly="formatted-values-only",I.NativeAndFormattedValues="native-and-formatted-values",(v=h.PageSizeOption||(h.PageSizeOption={})).Letter="letter",v.Legal="legal",v.Note="note",v.Folio="folio",v.Tabloid="tabloid",v.Ledger="ledger",v.Statement="statement",v.Executive="executive",v.A3="a3",v.A4="a4",v.A5="a5",v.B4="b4",v.B5="b5",v.Quarto="quarto",v.Unspecified="unspecified",(b=h.PageOrientation||(h.PageOrientation={})).Printer="printer",b.Portrait="portrait",b.Landscape="landscape",(y=h.ScaleMode||(h.ScaleMode={})).ScaleAuto="auto",y.ScalePercentage="percent",y.ScaleFitPages="fit-pages",(g=h.PageScalingOption||(h.PageScalingOption={})).ScalePctAuto="auto",g.ScalePct400="pct400",g.ScalePct200="pct200",g.ScalePct100="pct100",g.ScalePct90="pct90",g.ScalePct80="pct80",g.ScalePct75="pct75",g.ScalePct60="pct60",g.ScalePct50="pct50",g.ScalePct25="pct25",(m=h.FitPages||(h.FitPages={})).FitOneHigh="fit0x1",m.FitTwoHigh="fit0x2",m.FitOneWide="fit1x0",m.FitTwoWide="fit2x0"},5879:(p,h)=>{var m;Object.defineProperty(h,"__esModule",{value:!0}),(m=h.NotificationId||(h.NotificationId={})).CustomMarkContextMenuClicked="custom-mark-context-menu-clicked",m.ContextMenuClick="context-menu-click",m.CustomViewRemoved="custom-view-removed",m.CustomViewSaved="custom-view-saved",m.CustomViewSetDefault="custom-view-set-default",m.CustomViewsLoaded="custom-views-loaded",m.DashboardLayoutChanged="dashboard-layout-changed",m.EditButtonClicked="edit-button-clicked",m.EditInDesktopButtonClicked="edit-in-desktop-button-clicked",m.ExtensionDialogUpdate="extension-dialog-update",m.FilterChanged="filter-changed",m.FirstVizSizeKnown="first-viz-size-known",m.ParameterChanged="parameter-changed",m.SelectedMarksChanged="selected-marks-changed",m.SettingsChanged="settings-changed",m.TestConversionNotification="test-conversion-notification",m.ToolbarStateChanged="toolbar-state-changed",m.VizInteractive="viz-interactive",m.AskDataInteractive="ask-data-interactive",m.WorkbookReadyToClose="workbook-ready-to-close",m.WorkbookFormattingChanged="workbook-formatting-changed",m.WorkbookPublished="workbook-published",m.WorkbookPublishedAs="workbook-published-as",m.UrlAction="url-action",m.TabSwitched="tab-switched",m.StoryPointSwitched="story-point-switched"},5257:(p,h)=>{var m;Object.defineProperty(h,"__esModule",{value:!0}),(m=h.ParameterId||(h.ParameterId={})).ActiveTablesInfo="active-tables-info",m.AnchorDate="anchor-date",m.AnnotateEnum="annotate-enum",m.AnnotationList="annotation-list",m.CategoricalDomain="categorical-domain",m.ClickThroughEnabled="click-through-enabled",m.ColumnsToInclude="columns-to-include",m.ColumnsToIncludeById="columns-to-include-by-id",m.ConnectionDescriptionSummaries="connection-description-summaries",m.CurrentSheetType="current-sheet-type",m.CustomView="custom-view",m.CustomViewIsDefault="custom-view-is-default",m.CustomViewIsPublic="custom-view-is-public",m.CustomViewLuid="custom-view-luid",m.CustomViewName="custom-view-name",m.CustomViews="custom-views",m.Dashboard="dashboard",m.DashboardFilters="dashboard-filters",m.DashboardName="dashboard",m.DashboardObjectPositionAndSizeUpdate="dashboard-object-position-and-size-update",m.DashboardObjectPositionAndSizeUpdateList="dashboard-object-position-and-size-update-list",m.DataRowIndex="data-row-index",m.DataSchema="data-schema",m.DataSource="data-source",m.DataSourceDataTable="data-source-data-table",m.DataSourceId="data-source-id",m.DataSourceName="data-source-name",m.DataTable="data-table",m.DataTableReader="data-table-reader",m.DateRangeType="date-range-type",m.DeltaTimeMs="delta-time-ms",m.DimValSelectionModels="dimensionValueSelectionModels",m.DomainType="domain-type",m.EmbeddingBootstrapInfo="embedding-bootstrap-info",m.ExportCrosstabSheetMap="export-crosstab-sheet-map",m.ExportFile="export-file",m.ExportOriginUrl="export-origin-url",m.ExportPdfOptions="export-pdf-options",m.ExtensionBootstrapInfo="extension-bootstrap-info",m.ExtensionContextMenuIds="extension-context-menu-ids",m.ExtensionDialogH="extension-dialog-height",m.ExtensionDialogPayload="extension-dialog-payload",m.ExtensionDialogResult="extension-dialog-result",m.ExtensionDialogStyle="extension-dialog-style",m.ExtensionDialogUrl="extension-dialog-url",m.ExtensionDialogW="extension-dialog-width",m.ExtensionLocator="extension-locator",m.ExtensionSettingsInfo="extension-settings-info",m.ExtensionZoneId="extension-zone-id",m.ExternalMenuDescription="external-menu-description",m.ExternalMenuHeader="external-menu-header",m.ExternalMenuItemDisplayName="external-menu-item-display-name",m.ExternalMenuItemId="external-menu-item-id",m.Field="field",m.FieldId="field-id",m.FieldName="field-name",m.FilterLevels="filter-levels",m.FilterRangeMax="filter-range-max",m.FilterRangeMin="filter-range-min",m.FilterRangeNullOption="filter-range-null-option",m.FilterUpdateType="filter-update-type",m.FilterValues="filter-values",m.FontNameListItems="font-name-list-items",m.FormattedText="formatted-text",m.FunctionName="function-name",m.HierValSelectionModels="hierarchicalValueSelectionModels",m.HighlightedData="highlighted-data",m.IgnoreAliases="ignore-aliases",m.IgnoreSelection="ignore-selection",m.IncludeAllColumns="include-all-columns",m.InvalidAggFieldName="invalid-agg-field-name",m.InvalidDates="invalid-dates",m.InvalidFieldCaption="invalid-field-caption",m.InvalidFields="invalid-fields",m.InvalidValues="invalid-values",m.IsExcludeMode="is-exclude",m.IsExtensionDialog="is-extension-dialog",m.JoinDescription="join-description",m.LogicalTableId="logical-table-id",m.LogicalTableInfoList="logical-table-info-list",m.MaxHeight="max-height",m.MaxRows="max-rows",m.MaxWidth="max-width",m.MinHeight="min-height",m.MinWidth="min-width",m.PageRowCount="page-row-count",m.ParameterCaption="paremeter-caption",m.ParameterError="parameter-error",m.ParameterFieldName="parameter-field-name",m.ParameterInfo="parameter-info",m.ParameterInfos="parameter-infos",m.ParameterValue="parameter-value",m.PeriodType="period-type",m.QuantitativeDomain="quantitative-dmain",m.QuantRangeSelectionModels="quantativeRangeSelectionModels",m.RangeN="range-n",m.ReplaySpeed="replay-speed",m.SelectedData="selected-data",m.SelectedSheetNames="selected-sheet-names",m.Selection="selection",m.SelectionList="selection-list",m.SelectionUpdateType="selectionUpdateType",m.SendNotifications="send-notifications",m.SettingsValues="settings-values",m.SharedFilterSheets="shared-filter-sheets",m.SharedFiltersInfo="shared-filters-info",m.SheetIdentifier="sheet-identifier",m.SheetName="sheet-name",m.SheetPath="sheet-path",m.ShouldRefreshDS="should-refresh-ds",m.ShowDataTableFormat="show-data-table-format",m.State="state",m.StoryPointIndex="story-point-index",m.StoryPointInfo="story-point-info",m.SwitchToSheetName="switch-to-sheet-name",m.TargetPoint="target-point",m.TestConversionParameter="test-conversion-parameter",m.Text="formatted-text",m.UnderlyingDataTable="underlying-data-table",m.UnderlyingSummaryDataTable="underlying-summary-data-table",m.Url="url",m.UseTabDelimiters="use-tab-delimiters",m.ViewDataTableCacheId="view-data-table-cache-id",m.ViewDataTableId="view-data-table-id",m.VisualId="visual-id",m.VizAPIInputJson="vizapi-input-json",m.VizAPISVG="vizapi-svg",m.WorksheetName="worksheet-name",m.WorksheetFilters="worksheet-filters",m.ZoneIdsVisibilityMap="zone-ids-visibility-map"},5681:(p,h)=>{var m;Object.defineProperty(h,"__esModule",{value:!0}),(m=h.VerbId||(h.VerbId={})).ActivateNextStoryPoint="activate-next-story-point",m.ActivatePreviousStoryPoint="activate-previous-story-point",m.ActivateSheet="activateSheet",m.ActivateStoryPoint="activate-story-point",m.AppendExternalMenuItem="append-external-menu-item",m.ApplyCategoricalFilter="categorical-filter",m.ApplyRangeFilter="range-filter",m.ApplyRelativeDateFilter="apply-relative-date-Filter",m.BlockExtension="block-extension",m.ChangeParameterValue="change-parameter-value",m.ChangeSharedFilter="change-shared-filter",m.ClearFilter="clear-filter",m.ClearSelectedMarks="clear-selected-marks",m.CloseDialog="close-dialog",m.CreateAnnotation="create-annotation",m.DashboardCategoricalFilter="dashboard-categorical-filter",m.DisplayDialog="display-dialog",m.DownloadWorkbook="download-workbook",m.ExecuteExternalMenuItem="execute-external-menu-item",m.ExportCrosstab="export-crosstab",m.ExportCrosstabCsvDownload="export-crosstab-csv-download",m.ExportCrosstabExcelDownload="export-crosstab-excel-download",m.ExportData="export-data",m.ExportDataDownload="export-data-download",m.ExportImage="export-image",m.ExportPdf="export-pdf",m.ExportPdfDownload="export-pdf-download",m.ExportPowerpoint="export-powerpoint",m.ExportPowerpointDownload="export-powerpoint-download",m.FindParameter="find-parameter",m.GetActiveTables="get-active-tables",m.GetAllDataSources="get-all-data-sources",m.GetAnnotations="get-annotations",m.GetCategoricalDomain="get-categorical-domain",m.GetConnectionDescriptionSummaries="get-connection-description-summaries",m.GetCurrentSrc="get-current-src",m.GetCustomViews="get-custom-views",m.GetDashboardFilters="get-dashboard-filters",m.GetDataSource="get-datasource",m.GetDataSourceData="get-datasource-data",m.GetDataSources="get-data-sources",m.GetDataSummaryData="get-summary-data",m.GetDataSummaryDataReader="get-summary-data-reader",m.GetDataTableReaderPage="get-data-table-reader-page",m.GetEmbeddingClientInfo="get-embedding-client-info",m.GetExportCrosstabSheetMap="get-export-crosstab-sheet-map",m.GetExportPdfOptions="get-export-pdf-options",m.GetField="get-field",m.GetFieldAndDataSource="get-field-and-datasource",m.GetFilters="get-filters",m.GetFonts="get-fonts",m.GetHighlightedMarks="get-highlighted-marks",m.GetJoinDescription="get-join-description",m.GetLogicalTableData="get-logical-table-data",m.GetLogicalTableDataReader="get-logical-table-data-reader",m.GetLogicalTables="get-logical-tables",m.GetParametersForSheet="get-parameters-for-sheet",m.GetRangeDomain="get-range-domain",m.GetSelectedMarks="get-selected-marks",m.GetSharedFilter="get-shared-filter",m.GetUnderlyingData="get-underlying-data",m.GetUnderlyingTableData="get-underlying-table-data",m.GetUnderlyingTableDataReader="get-underlying-table-data-reader",m.GetUnderlyingTables="get-underlying-tables",m.HierarchicalFilter="hierachical-filter",m.InitializeExtension="initialize-extension",m.MoveAndResizeZones="move-and-resize-zones",m.Redo="redo",m.RefreshDataSource="refresh-data-source",m.ReleaseDataTableReader="release-data-table-reader",m.RemoveAnnotation="remove-annotation",m.RemoveCustomView="remove-custom-view",m.RemoveExternalMenuItem="remove-external-menu-item",m.RenameExternalMenu="rename-external-menu",m.ReplayAnimation="replay-animation",m.RevertStoryPoint="revert-story-point",m.RevertWorkbook="revert-workbook",m.SaveExtensionSettings="save-extension-settings",m.SaveWorkbookAsCustomView="save-workbook-as-custom-view",m.SelectByValue="select-by-value",m.SetActiveCustomViewAsDefault="set-active-custom-view-as-default",m.SetAutoUpdate="set-auto-update",m.SetClickThrough="set-click-through",m.SetSheetSize="set-sheet-size",m.SetZoneVisibility="set-zone-visibility",m.Share="share",m.ShowCustomView="show-custom-view",m.TestConversionVerb="test-conversion-verb",m.Undo="undo",m.UpdateCustomView="update-custom-view",m.VizAPI="viz-api"},967:(p,h)=>{var m;Object.defineProperty(h,"__esModule",{value:!0}),(m=h.AskDataOptionNames||(h.AskDataOptionNames={})).token="token",m.origin="origin",m.showEmbed="showEmbed",m.showPin="showPin",m.showSave="showSave",m.showShare="showShare",m.debug=":jsdebug",m.ApiID=":apiID",m.ApiExternalVersion=":apiExternalVersion",m.ApiInternalVersion=":apiInternalVersion",m.AskDataWebComponent=":askDataWebComponent"},8075:(p,h)=>{var m,g,y,b;Object.defineProperty(h,"__esModule",{value:!0}),(b=m||(m={})).ONE="1",b.ALERTS=":alerts",b.ALIAS="alias",b.ALLOW_DEFERRED_BOOTSTRAP=":allowDeferredBootstrap",b.ALLOW_AUTOGEN_WORKSHEET_PHONE_LAYOUTS="allowAutogenWorksheetPhoneLayouts",b.API_ID=":apiID",b.APP=":app",b.ATTACHMENT="attachment",b.IS_IPAD_APP="app",b.ANIMATE_TRANSITION=":animate_transition",b.ASCENDING="ascending",b.AUTHENTICATION="authentication",b.ATTRIBUTES="attributes",b.AUTHORING_SHEET=":authSheet",b.AXIS="axis",b.BOOTSTRAP_WHEN_NOTIFIED=":bootstrapWhenNotified",b.BROWSER_BACK_BUTTON_UNDO=":browserBackButtonUndo",b.BROWSER_RENDERING_ON="isBrowserRendering",b.BROWSER_RENDERING_THRESHOLD="browserRenderingThreshold",b.CHARSET="charset",b.CLIENT_DIMENSION="clientDimension",b.CLIENT_IP="client_ip",b.CLIENT_NUM="clientNum",b.COLON_EMBEDDED=":embedded",b.COLON_MOBILE=":mobile",b.COLON_DEEP_LINKING_DISABLED=":deepLinkingDisabled",b.COLON_WATERMARK=":watermark",b.COMMENTS=":comments",b.COMMENTING_ENABLED=":commentingEnabled",b.COMMENTING_MENTIONS_ENABLED=":commentingMentions",b.CONNECTION="connection",b.CREATED_BY_FEATURE="createdByFeature",b.CRYPTED_PASSWORD="crypted",b.CSSDEBUG=":cssdebug",b.CSV="csv",b.CUSTOM_VIEWS=":customViews",b.CV=":cv",b.CV_ID="cvId",b.DASHBOARD_PORT_SIZE="dashboardPortSize",b.DATA_DETAILS=":dataDetails",b.DATASOURCE="datasource",b.DEBUG=":debug",b.DELAY=":delay",b.DEPTH="depth",b.DEVICE_TYPE=":device",b.DEVICE_PIXEL_RATIO="devicePixelRatio",b.DEVICE_PREVIEW_MODE=":devicepreviewmode",b.DIMENSIONS=":dimensions",b.DISABLE_SHARED_SESSIONS=":disable_shared_sessions",b.DISABLE_URL_ACTIONS_POPUPS=":disableUrlActionsPopups",b.DIRECTION="direction",b.DISPLAY_OVERLAY=":display_overlay",b.DISPLAY_SHARE=":display_share",b.DISPLAY_SPINNER=":display_spinner",b.DISPLAY_STATIC_IMAGE=":display_static_image",b.DISPLAY_TABS="display_tabs",b.DISPLAY_VIEW_COUNT=":display_count",b.IGNORE_STICKY_SESSION=":ignore_sticky_session",b.INCREMENT_VIEW_COUNT=":increment_view_count",b.DOCMODE="docmode",b.DOMAIN="domain",b.DO_WORK="do_work",b.DX="dx",b.DY="dy",b.EDIT_DATA_ALERT=":editDataAlert",b.EMBED=":embed",b.EMBEDDED="embedded",b.ENCRYPTED="encrypted",b.API_EXTERNAL_VERSION=":apiExternalVersion",b.API_INTERNAL_VERSION=":apiInternalVersion",b.EXCLUDE="exclude",b.EXPORT_FORMAT=":export_format",b.FIELDNAME="fieldname",b.FIELD_NAME="field_name",b.FIELD_SEP="field_sep",b.FILE="file",b.FILTER_TILE_SIZE="filterTileSize",b.FN="fn",b.FOCUS="focus",b.FORCE_CACHE="force_cache",b.FORMAT="format",b.FORMAT_DATA_VALUE_LOCALLY="formatDataValueLocally",b.FROM_WG=":from_wg",b.GRAPHQL_DATABASE_ID=":graphQLDatabaseId",b.GRAPHQL_TABLE_ID=":graphQLTableId",b.GUID=":guid",b.H="h",b.HIDDEN="hidden",b.HIDE_CLOSE_BUTTON=":hideCloseButton",b.HIDE_EDIT_BUTTON=":hideEditButton",b.HIDE_EDIT_IN_DESKTOP_BUTTON=":hideEditInDesktopButton",b.HIGH_DPI=":highdpi",b.IMAGE_SIZE_LIMIT="imageSizeLimit",b.TRANSPARENT_LINE_MARKS_LIMIT="transparentLineMarkLimit",b.CLIENT_RENDER_PIXEL_LIMIT="clientRenderPixelLimit",b.IN="in",b.INSTANCE_ID=":iid",b.IS_GUEST_REDIRECT_FROM_VIZPORTAL=":isGuestRedirectFromVizportal",b.IS_MARK_ANIMATION_ENABLED="isMarkAnimationEnabled",b.IS_VIZPORTAL=":isVizPortal",b.INPUT_="input_string",b.JSDEBUG=":jsdebug",b.JSON="json",b.JSON_ONLY=":jsonOnly",b.KEEPFILE="keepfile",b.KEY="key",b.LANGUAGE="language",b.LANGUAGE_REQUESTED=":language",b.LINKTARGET=":linktarget",b.LOAD_ORDER_ID=":loadOrderID",b.LOAD_NEWEST_REVISION=":loadNewestRevision",b.LOCAL_PATHS=":localPaths",b.LOCALE="locale",b.LOCATION_ID="locationid",b.LOCATION_TYPE="locationtype",b.WORKBOOK_LOCALE="workbookLocale",b.MAXROWS="maxrows",b.MAX_AGE="maxAge",b.MAX_ROWS="maxRows",b.METHOD="method",b.MOBILE="mobile",b.MODIFIER="modifier",b.NAME="name",b.NAV_TYPE="navType",b.NAV_SRC="navSrc",b.NOATTACHMENT="no-attachment",b.NO_OVERWRITE="no_overwrite",b.OPEN_AUTHORING_IN_TOP_WINDOW=":openAuthoringInTopWindow",b.OPENID_HD=":openid_hd",b.OPENID_LOGIN_HINT=":openid_login_hint",b.OAUTHREQUEST="oauthrequest",b.OAUTH_CREDENTIAL_IDS="oauth_credential_ids",b.OFFLINE_MODE=":offlinemode",b.ORIGIN=":origin",b.OVERLAY=":overlay",b.P="p",b.PATH="path",b.PANE_RESOLVER_X="paneResolverX",b.PANE_RESOLVER_Y="paneResolverY",b.PARAM="param",b.PARENT_ID="parent_id",b.PASSWORD="password",b.PATTERN="pattern",b.PIXEL_RATIO=":pixelratio",b.PREFIX=":prefix",b.PREVIEW=":preview",b.PRIMARY_CONTENT_URL="primary_content_url",b.PROJECT="project",b.PROTOCOL="protocol",b.PSEUDO=":pseudo",b.QUERY="query",b.R="r",b.RANGE_TYPE="range_type",b.RECORD_SEP="record_sep",b.RECORD_CLIENT_PERFORMANCE=":record_client_performance",b.RECORD_PERFORMANCE=":record_performance",b.RECOVER_OLD_SESSION_ID=":recover_old_session_id",b.RECOVER_SESSION_STATE_TICKETS=":recover_session_state_tickets",b.REFRESH=":refresh",b.REFRESHUNMODIFIED=":refreshunmodified",b.REGION="region",b.RELOAD_ON_CUSTOM_VIEW_SAVE=":reloadOnCustomViewSave",b.RENDER=":render",b.RENDER_MAPS_CLIENT_SIDE="renderMapsClientSide",b.RETRY=":retry",b.REUSE="reuse",b.REUSE_FOREVER="reuse_forever",b.REVERT=":revert",b.SAVE_DB_PASSWORDS="save_db_passwords",b.SELECT_X="select_x",b.SELECT_Y="select_y",b.SESSION_FEATURE_PREFIX=":ff_",b.SESSION_FLAGS=":session_feature_flags",b.SHARE_BUTTON="share_button",b.SHEET_ID="sheet_id",b.SHARED="shared",b.SHOWALL="showall",b.SHOW_APP_BANNER=":showAppBanner",b.SHOW_ASK_DATA=":showAskData",b.SHOW_PARAMS="showParams",b.SHOW_SHARE_OPTIONS=":showShareOptions",b.SIZE=":size",b.SOURCE="source",b.STATE="state",b.STICKY_SESSION_KEY="stickySessionKey",b.SUBSCRIPTIONS=":subscriptions",b.SUMMARY="summary",b.SUPPRESS_DEFAULT_EDIT_BEHAVIOR=":suppressDefaultEditBehavior",b.SYNC_SESSION=":sync_session",b.SYNC_SESSION_STATE="sync_session_state",b.TABS=":tabs",b.TARGET="target",b.TARGET_SITE="target_site",b.TOOLBAR=":toolbar",b.TOOLTIP=":tooltip",b.TS="ts",b.UNDERLYING_TABLE_ID="underlying_table_id",b.UNDERLYING_TABLE_CAPTION="underlying_table_caption",b.UPDATE_TYPE="update_type",b.USE_GUEST=":useGuest",b.USE_INLINE_IMAGES="use_inline_images",b.USERAGENT="useragent",b.USERNAME="username",b.VALUE="value",b.VERBOSE_MODE="verboseMode",b.VIEW_ID="views_id",b.VIZ_SNAPSHOT_ID="viz_snapshot_id",b.VW=":vw",b.W="w",b.WORKSHEET_PORT_SIZE="worksheetPortSize",b.WATERMARK="watermark",b.WATERMARK_MARGIN=":watermark_margin",b.WB=":wb",b.WHICH="which",b.X="x",b.Y="y",b.ZID="zid",b.ZONE_ID="zone_id",b.KEYCHAIN_VERSION="keychain_version",b.DATASOURCE_ID="datasource_id",b.DATASOURCE_NAME="datasource_name",b.LENS_ID="lens_id",b.WIDTH="width",b.HEIGHT="height",b.LAYOUT_VIEWS="views",b.LAYOUT_MENUS="menus",b.LAYOUT_GEOMETRY="geometry",b.LAYOUT_PAGES="pages",b.LAYOUT_CACHEURL="cacheurl",b.LAYOUT_SHEET="sheet",b.LAYOUT_DEPTH="depth",(g||(g={})).SHOW_VIZ_HOME=":showVizHome",(y=h.VizOptionNames||(h.VizOptionNames={})).Size=":size",y.Embed=":embed",y.ApiInternalVersion=":apiInternalVersion",y.ApiExternalVersion=":apiExternalVersion",y.ShowVizHome=":showVizHome",y.Jsdebug=":jsdebug",y.BootstrapWhenNotified=":bootstrapWhenNotified",y.NavType="navType",y.NavSrc="navSrc",y.debug=":jsdebug",y.ApiID=":apiID",y.disableUrlActionsPopups=":disableUrlActionsPopups",y.hideTabs=":tabs",y.toolbar=":toolbar",y.device=":device",y.instanceIdToClone=":iid",y.touchOptimize="mobile",y.hideEditButton=":hideEditButton",y.hideEditInDesktopButton=":hideEditInDesktopButton",y.suppressDefaultEditBehavior=":suppressDefaultEditBehavior",y.hideCloseButton=":hideCloseButton"},550:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(2541),y=m(4695),b=m(3475),v=m(7443),I=m(3590),S=function(){function e(p,h,m){this.thisWindow=p,this.otherWindow=h,this.otherWindowOrigin=m}return e.prototype.startListening=function(){var p=this;if(!this.unregisterFunction){var h=this.onMessageReceived.bind(this);this.thisWindow.addEventListener("message",h,!0),this.unregisterFunction=function(){return p.thisWindow.removeEventListener("message",h,!0)}}},e.prototype.stopListening=function(){this.unregisterFunction&&(this.unregisterFunction(),this.unregisterFunction=void 0)},e.prototype.setInitializeMessageHandler=function(p){this.initializeMessageHandler=p},e.prototype.setCommandResponseMessageHandler=function(p){this.commandResponseMessageHandler=p},e.prototype.setCommandMessageHandler=function(p){this.commandMessageHandler=p},e.prototype.setNotificationMessageHandler=function(p){this.notificationMessageHandler=p},e.prototype.setHandshakeMessageHandler=function(p){this.handshakeMessageHandler=p},e.prototype.prepareInitializationMessage=function(p,h,m){var y={msgGuid:g.raw(),msgType:I.MessageType.Initialize,crossFrameVersion:h,apiVersion:p,options:m};return this.prepareMessage(y)},e.prototype.prepareCommandMessage=function(p,h){var m={msgGuid:g.raw(),msgType:I.MessageType.Command,verbId:p,parameters:h};return this.prepareMessage(m)},e.prototype.prepareCommandResponseMessage=function(p,h,m){var y={msgGuid:g.raw(),msgType:I.MessageType.CommandResponse,commandGuid:p,data:h,error:m};return m&&(y.error=JSON.parse(JSON.stringify(m))),this.prepareMessage(y)},e.prototype.prepareNotificationMessage=function(p,h){var m={msgGuid:g.raw(),msgType:I.MessageType.Notification,notificationId:p,data:h};return this.prepareMessage(m)},e.prototype.prepareAckMessage=function(){var p={msgGuid:g.raw(),msgType:I.MessageType.Ack,platformVersion:y.INTERNAL_CONTRACT_VERSION};return this.prepareMessage(p)},e.prototype.prepareMessage=function(p){if(!this.otherWindow||!this.otherWindowOrigin)throw"Other window not initialized, cannot dispatch messages";return new b.CrossFramePreparedMessage(p,this.otherWindow,this.otherWindowOrigin)},e.prototype.onMessageReceived=function(p){if((!this.otherWindow||p.source===this.otherWindow)&&p.data){var h=p.data;if(v.isMessage(h))switch(h.msgType){case I.MessageType.Initialize:if(!v.isInitMessage(h)||!this.initializeMessageHandler)return;this.initializeMessageHandler(h,p.source);break;case I.MessageType.CommandResponse:if(!v.isCommandResponseMessage(h)||!this.commandResponseMessageHandler)return;this.commandResponseMessageHandler(h,p.source);break;case I.MessageType.Command:if(!v.isCommandMessage(h)||!this.commandMessageHandler)return;this.commandMessageHandler(h,p.source);break;case I.MessageType.Notification:if(!v.isNotificationMessage(h)||!this.notificationMessageHandler)return;this.notificationMessageHandler(h,p.source);break;case I.MessageType.Handshake:if(!v.isHandshakeMessage(h)||!this.handshakeMessageHandler)return;this.handshakeMessageHandler(h,p.source)}}},e.prototype.setOtherWindow=function(p){this.otherWindow=p},e.prototype.setOtherWindowOrigin=function(p){this.otherWindowOrigin=p},e}();h.CrossFrameMessenger=S},3475:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p,h,m){this._message=p,this._target=h,this._origin=m}return Object.defineProperty(e.prototype,"messageGuid",{get:function(){return this._message.msgGuid},enumerable:!0,configurable:!0}),e.prototype.send=function(){return this._target.postMessage(this._message,this._origin),this},e}();h.CrossFramePreparedMessage=m},7443:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(2541),y=m(5879),b=m(3590),v=new Set([y.NotificationId.EditButtonClicked,y.NotificationId.EditInDesktopButtonClicked,y.NotificationId.WorkbookPublished,y.NotificationId.WorkbookReadyToClose]);function s(p){return!!p&&!(!(p&&p.msgGuid&&p.msgType)||!g.isGuid(p.msgGuid)||"string"!=typeof p.msgType||0>[b.MessageType.Command,b.MessageType.CommandResponse,b.MessageType.Initialize,b.MessageType.Notification,b.MessageType.Handshake].indexOf(p.msgType))}function l(p){return!!p&&"object"==typeof p&&"number"==typeof p.fix&&"number"==typeof p.minor&&"number"==typeof p.major}h.isMessage=s,h.isVersion=l,h.isInitMessage=function(p){return!!s(p)&&!!(p.msgType===b.MessageType.Initialize&&p.apiVersion&&l(p.apiVersion)&&p.crossFrameVersion&&l(p.crossFrameVersion))},h.isCommandResponseMessage=function(p){return!!s(p)&&!(p.msgType!==b.MessageType.CommandResponse||!g.isGuid(p.commandGuid)||!p.data&&!p.error)},h.isCommandMessage=function(p){return!!s(p)&&!(p.msgType!==b.MessageType.Command||!p.parameters||"object"!=typeof p.parameters||!p.verbId||"string"!=typeof p.verbId)},h.isNotificationMessage=function(p){return!!s(p)&&!(p.msgType!==b.MessageType.Notification||!p.data&&!v.has(p.notificationId)||!p.notificationId||"string"!=typeof p.notificationId)},h.isHandshakeMessage=function(p){return!!s(p)&&p.msgType===b.MessageType.Handshake}},3590:(p,h)=>{var m;Object.defineProperty(h,"__esModule",{value:!0}),(m=h.MessageType||(h.MessageType={})).Initialize="initialize",m.Notification="notification",m.Command="command",m.CommandResponse="command-response",m.Handshake="v-handshake",m.Ack="v-ack"},7104:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(){}return e.prototype.upgradeExecuteCall=function(p,h){return{verb:p,parameters:h}},e.prototype.downgradeExecuteReturn=function(p){return p},e.prototype.downgradeNotification=function(p){return p},e}();h.IdentityVersionConverter=m},9415:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p,h,m,g,y){if(this._externalMajorVersion=p,this._platformMajorVersion=h,this._upgradeExecuteTranslations=m,this._downgradeExecuteTranslations=g,this._downgradeNotificationTranslations=y,this._externalMajorVersion>this._platformMajorVersion)throw Error("Cannot convert between external version "+this._externalMajorVersion+" and "+this._platformMajorVersion)}return e.fromData=function(p,h,m,g,y){return new this(p.major,h.major,m,g,y)},e.prototype.upgradeExecuteCall=function(p,h){for(var m={verb:p,parameters:h},g=0,y=this._upgradeExecuteTranslations;g<y.length;g++)m=(0,y[g])(m.verb,m.parameters);return m},e.prototype.downgradeExecuteReturn=function(p){for(var h=p,m=0,g=this._downgradeExecuteTranslations;m<g.length;m++)h=(0,g[m])(h);return h},e.prototype.downgradeNotification=function(p){for(var h=p,m=0,g=this._downgradeNotificationTranslations;m<g.length;m++)h=(0,g[m])(h);return h},e}();h.StackingVersionConverter=m},9394:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(7104),y=m(9415),b=m(5039);function o(p,h){return p.major===h.major&&p.minor===h.minor}function s(p,h,m,b,v){var I=p.major,S=p.minor,_=h.major;if(I>_)throw Error("External version must be less than or equal to platform version.\n    externalMajorVersion="+I+" platformMajorVersion="+_);if(o(p,h))return new g.IdentityVersionConverter;var A=l(I,_,S,m),T=l(I,_,S,b),w=l(I,_,S,v);return T.reverse(),w.reverse(),y.StackingVersionConverter.fromData(p,h,A,T,w)}function l(p,h,m,g){for(var y=[],b=p;b<=h;b++)if(b in g)for(var v=b===p?m:0,I=u(Object.keys(g[b])),S=v;S<=I;S++)S in g[b]&&y.push.apply(y,g[b][S]);return y}function u(p){return p.map(function(p){return Number(p)}).reduce(function(p,h){return p>h?p:h})}h.VersionLessThan=function(p,h){return!(p.major>h.major)&&(p.major<h.major||p.minor<h.minor)},h.VersionEqualTo=o,h.ExecuteMinorUpgrades={1:{9:[]}},h.ExecuteMinorDowngrades={1:{5:[b.DowngradeWorksheetNames],9:[]}},h.NotificationMinorDowngrades={1:{9:[],10:[b.DowngradeFlipboardZoneID]}},h.CreateVersionConverter=function(p,m){return s(p,m,h.ExecuteMinorUpgrades,h.ExecuteMinorDowngrades,h.NotificationMinorDowngrades)},h.CreateVersionConverterWithTranslators=s,h.GetMaximumMinorIndex=u},5039:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(5879);h.DowngradeWorksheetNames=function(p){var h=p.result;return void 0!==h.extensionDashboardInfo&&h.extensionDashboardInfo.zones.forEach(function(p){p.sheetInfo&&(p.name=p.sheetInfo.name)}),p},h.DowngradeFlipboardZoneID=function(p){if(p.notificationId===g.NotificationId.SelectedMarksChanged){var h=p.data;void 0===h.flipboardZoneID&&(h.flipboardZoneID=0)}return p}},408:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(){}return e.prototype.downgradeExecuteCall=function(p,h){return{verb:p,parameters:h}},e.prototype.upgradeExecuteReturn=function(p,h,m){return p},e.prototype.upgradeNotification=function(p){return p},e}();h.ExternalIdentityVersionConverter=m},8241:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p,h,m,g,y){if(this._externalVersion=p,this._platformVersion=h,this._downgradeExecuteCallTranslations=m,this._upgradeExecuteReturnTranslations=g,this._upgradeNotificationTranslations=y,this._externalVersion.major>this._platformVersion.major)throw Error("Cannot convert between external version "+this._externalVersion.major+"\n      and "+this._platformVersion.major)}return e.prototype.downgradeExecuteCall=function(p,h){for(var m={verb:p,parameters:h},g=0,y=this._downgradeExecuteCallTranslations;g<y.length;g++)m=(0,y[g])(m.verb,m.parameters);return m},e.prototype.upgradeExecuteReturn=function(p,h,m){for(var g=p,y=0,b=this._upgradeExecuteReturnTranslations;y<b.length;y++)g=(0,b[y])(g,h,m);return g},e.prototype.upgradeNotification=function(p){for(var h=p,m=0,g=this._upgradeNotificationTranslations;m<g.length;m++)h=(0,g[m])(h);return h},e}();h.ExternalStackingVersionConverter=m},3526:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(9394),y=m(408),b=m(8241),v=m(7354);function s(p,h,m,v,I){var S=p.major,_=h.major,A=h.minor;if(S>_)throw Error("External version must be less than or equal to platform version.\n    externalMajorVersion="+S+" platformMajorVersion="+_);if(S<_||g.VersionEqualTo(p,h))return new y.ExternalIdentityVersionConverter;var T=l(_,A,m),w=l(_,A,v),P=l(_,A,I);return T.reverse(),new b.ExternalStackingVersionConverter(p,h,T,w,P)}function l(p,h,m){var y=[];if(p in m)for(var b=g.GetMaximumMinorIndex(Object.keys(m[p])),v=h;v<=b;v++)v in m[p]&&y.push.apply(y,m[p][v]);return y}h.ExecuteMinorDowngradeCallExternal={1:{9:[],13:[v.DowngradeUnderlyingTableDataAsync,v.DowngradeLogicalTableDataAsync]}},h.ExecuteMinorUpgradeReturnExternal={1:{9:[v.UpgradeDataTableTypes],29:[v.UpgradeDataTableRowsAndColumns]}},h.ExecuteMinorUpgradeNotification={1:{9:[]}},h.CreateExternalCompatibleVersionConverter=function(p,m){return s(p,m,h.ExecuteMinorDowngradeCallExternal,h.ExecuteMinorUpgradeReturnExternal,h.ExecuteMinorUpgradeNotification)},h.CreateExternalCompatibleVersionConverterWithTranslators=s},7354:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(4695);function i(p){void 0!==p&&void 0!==p.dataTable&&Array.isArray(p.dataTable)&&p.dataTable.forEach(function(h){h.forEach(function(h,m){var y=h.value;null!==y&&(h.value=g.DataTypeConverter.convertValueAsStringToValue(y,p.headers[m].dataType))})})}function a(p,h){if(h[g.ParameterId.LogicalTableId]!==g.ApiShowDataTableSentinel.SingleTableId)throw Error("Invalid logical table id passed to "+p+".")}h.UpgradeDataTableTypes=function(p,h,m){if(!p)return p;var g=p.result;if(void 0!==g.data&&void 0!==g.isSummary)return i(g.data),p;var y=p.result;return void 0!==y.data&&Array.isArray(y.data)&&y.data.forEach(function(p){i(p)}),p},h.DowngradeUnderlyingTableDataAsync=function(p,h){return p===g.VerbId.GetUnderlyingTableData&&(a(p,h),p=g.VerbId.GetUnderlyingData),{verb:p,parameters:h}},h.DowngradeLogicalTableDataAsync=function(p,h){return p===g.VerbId.GetLogicalTableData&&(a(p,h),p=g.VerbId.GetDataSourceData),{verb:p,parameters:h}},h.UpgradeDataTableRowsAndColumns=function(p,h,m){var y,b,v;return h===g.VerbId.GetDataSummaryData&&m[g.ParameterId.MaxRows]&&(y=p,b=m[g.ParameterId.MaxRows],(v=y.result).data&&Array.isArray(v.data.dataTable)&&b>0&&b<v.data.dataTable.length&&(v.data.dataTable.length=b),p=y),(h===g.VerbId.GetDataSummaryData||h===g.VerbId.GetUnderlyingTableData||h===g.VerbId.GetLogicalTableData||h===g.VerbId.GetDataSourceData||h===g.VerbId.GetUnderlyingData)&&m[g.ParameterId.ColumnsToIncludeById]&&(p=function(p,h){if(0===h.length)return p;var m=p.result;if(!m.data||!Array.isArray(m.data.dataTable)||!Array.isArray(m.data.headers))return p;var g=m.data.headers.filter(function(p,m){return h.find(function(h){return h===p.fieldName})});m.data.dataTable.forEach(function(p,h){m.data.dataTable[h]=p.filter(function(p,h){return -1!==g.findIndex(function(p){return p.index===h})})});var y=0;return m.data.headers=g.map(function(p){return p.index=y++,p}),p}(p,m[g.ParameterId.ColumnsToIncludeById])),p}},4007:(p,h,m)=>{function n(p){for(var m in p)h.hasOwnProperty(m)||(h[m]=p[m])}Object.defineProperty(h,"__esModule",{value:!0});var g=m(8395);h.ApiVersion=g.ApiVersion;var y=m(2336);h.ExternalToInternalEnumMappings=y.ExternalToInternalEnumMappings,n(m(241));var b=m(8024);h.CrossFrameDispatcher=b.CrossFrameDispatcher;var v=m(6411);h.DataSource=v.DataSource;var I=m(5126);h.InternalToExternalEnumMappings=I.InternalToExternalEnumMappings;var S=m(3682);h.EventListenerManager=S.EventListenerManager;var _=m(2131);h.Field=_.Field;var A=m(2913);h.CustomViewImpl=A.CustomViewImpl;var T=m(4657);h.DashboardImpl=T.DashboardImpl;var w=m(3333);h.DashboardObjectImpl=w.DashboardObjectImpl;var P=m(1234);h.DataSourceImpl=P.DataSourceImpl;var E=m(6560);h.ParameterImpl=E.ParameterImpl;var C=m(1878);h.SheetImpl=C.SheetImpl;var D=m(6749);h.SheetInfoImpl=D.SheetInfoImpl;var k=m(4217);h.SingleEventManagerImpl=k.SingleEventManagerImpl;var x=m(8194);h.StoryImpl=x.StoryImpl;var O=m(757);h.StoryPointImpl=O.StoryPointImpl;var V=m(8519);h.StoryPointInfoImpl=V.StoryPointInfoImpl;var N=m(3826);h.WorkbookImpl=N.WorkbookImpl;var M=m(928);h.WorksheetImpl=M.WorksheetImpl;var F=m(2391);h.Point=F.Point;var R=m(6292);h.ClientInfoServiceImpl=R.ClientInfoServiceImpl;var z=m(2294);h.NotificationServiceImpl=z.NotificationServiceImpl;var j=m(333);h.NotificationServiceImplBase=j.NotificationServiceImplBase,h.Registration=j.Registration;var U=m(1167);h.ServiceImplBase=U.ServiceImplBase;var L=m(8226);h.SizeServiceImpl=L.SizeServiceImpl;var W=m(2812);h.StoryActivationServiceImpl=W.StoryActivationServiceImpl,n(m(7458)),n(m(9887));var H=m(1554);h.TableauError=H.TableauError;var B=m(9685);h.Deferred=B.Deferred;var G=m(316);h.ErrorHelpers=G.ErrorHelpers;var Y=m(2561);h.ExportHelpers=Y.ExportHelpers;var Z=m(489);h.SheetUtils=Z.SheetUtils;var K=m(6081);h.VersionNumber=K.VersionNumber;var q=m(107);h.VersionedExternalApiDispatcher=q.VersionedExternalApiDispatcher},8395:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(6081),y=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return e._instance},enumerable:!0,configurable:!0}),e.SetVersionNumber=function(p,h){e._instance=new g.VersionNumber(p,h)},e}();h.ApiVersion=y},5458:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p){this._connectionInfo=p}return Object.defineProperty(e.prototype,"name",{get:function(){return this._connectionInfo.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._connectionInfo.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverURI",{get:function(){return this._connectionInfo.serverURI},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._connectionInfo.type},enumerable:!0,configurable:!0}),e}();h.ConnectionSummary=m},241:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(4695),y=m(8024);h.doCrossFrameBootstrap=function(p,h,m){return new Promise(function(b,v){(I=!function(p){try{return p.self!==p.parent}catch(p){return!0}}(p)?p.opener:p.parent)||v("This extension is not running inside an iframe, desktop, or popup window. Initialization failed.");var I,S=new g.CrossFrameMessenger(p,I,"*"),_=S.prepareInitializationMessage(h,g.MESSAGING_VERSION,m);S.setCommandResponseMessageHandler(function(p){p.commandGuid===_.messageGuid&&b(function(){return new y.CrossFrameDispatcher(S)})}),S.startListening(),_.send()})}},8024:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=function(){function e(p){if(this._messenger=p,this._pendingPromises={},this._notificationHandlers=[],!this._messenger)throw"Missing messenger object";this._messenger.setCommandResponseMessageHandler(this.onCommandResponse.bind(this)),this._messenger.setNotificationMessageHandler(this.onNotification.bind(this))}return e.prototype.execute=function(p,h){var m=this,g=this._messenger.prepareCommandMessage(p,h),y=new Promise(function(p,h){m._pendingPromises[g.messageGuid]={resolve:p,reject:h}});return g.send(),y},e.prototype.registerNotificationHandler=function(p){this._notificationHandlers.push(p)},e.prototype.unregisterNotificationHandler=function(p){this._notificationHandlers=this._notificationHandlers.filter(function(h){return h!==p})},e.prototype.onCommandResponse=function(p){if(!(0>Object.keys(this._pendingPromises).indexOf(p.commandGuid))){var h=this._pendingPromises[p.commandGuid];p.error&&h.reject(p.error),p.data&&h.resolve({result:p.data}),delete this._pendingPromises[p.commandGuid]}},e.prototype.onNotification=function(p){for(var h=0,m=this._notificationHandlers;h<m.length;h++){var y=m[h];try{y({notificationId:p.notificationId,data:p.data})}catch(p){if(p.errorCode===g.EmbeddingErrorCodes.IncompatibleVersionError)throw p}}},e}();h.CrossFrameDispatcher=y},6411:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p){this._dataSourceImpl=p}return Object.defineProperty(e.prototype,"name",{get:function(){return this._dataSourceImpl.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._dataSourceImpl.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fields",{get:function(){return this._dataSourceImpl.fields},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extractUpdateTime",{get:function(){return this._dataSourceImpl.extractUpdateTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExtract",{get:function(){return this._dataSourceImpl.isExtract},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPublished",{get:function(){return this._dataSourceImpl.isPublished},enumerable:!0,configurable:!0}),e.prototype.publishedUrl=function(){return this._dataSourceImpl.publishedUrl()},e.prototype.refreshAsync=function(){return this._dataSourceImpl.refreshAsync()},e.prototype.getActiveTablesAsync=function(){return console.warn("DataSource.getActiveTablesAsync is deprecated. Please use DataSource.getLogicalTablesAsync."),this._dataSourceImpl.getActiveTablesAsync()},e.prototype.getConnectionSummariesAsync=function(){return this._dataSourceImpl.getConnectionSummariesAsync()},e.prototype.getUnderlyingDataAsync=function(p){return console.warn("DataSource.getUnderlyingDataAsync is deprecated. Please use DataSource.getLogicalTablesAsync and DataSource.getLogicalTableDataAsync."),this._dataSourceImpl.getUnderlyingDataAsync(p)},e.prototype.getLogicalTablesAsync=function(){return this._dataSourceImpl.getLogicalTablesAsync()},e.prototype.getLogicalTableDataAsync=function(p,h){return this._dataSourceImpl.getLogicalTableDataAsync(p,h)},e.prototype.getLogicalTableDataReaderAsync=function(p,h,m){return this._dataSourceImpl.getLogicalTableDataReaderAsync(p,h,m)},e}();h.DataSource=m},2336:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g,y,b,v,I,S,_,A,T,w,P=m(1750),E=m(4695),C=m(4406),D=function(){function e(){}return e.filterDomainType=new C.EnumConverter(((g={})[P.FilterDomainType.Relevant]=E.FilterDomainType.Relevant,g[P.FilterDomainType.Database]=E.FilterDomainType.Database,g)),e.nullOptions=new C.EnumConverter(((y={})[P.FilterNullOption.AllValues]=E.FilterNullOption.AllValues,y[P.FilterNullOption.NonNullValues]=E.FilterNullOption.NonNullValues,y[P.FilterNullOption.NullValues]=E.FilterNullOption.NullValues,y)),e.filterUpdateType=new C.EnumConverter(((b={})[P.FilterUpdateType.Add]=E.FilterUpdateType.Add,b[P.FilterUpdateType.All]=E.FilterUpdateType.All,b[P.FilterUpdateType.Remove]=E.FilterUpdateType.Remove,b[P.FilterUpdateType.Replace]=E.FilterUpdateType.Replace,b)),e.setVisibilityType=new C.EnumConverter(((v={})[P.ZoneVisibilityType.Show]=!0,v[P.ZoneVisibilityType.Hide]=!1,v)),e.setReplaySpeedType=new C.EnumConverter(((I={})[P.ReplaySpeedType.Slow]=2,I[P.ReplaySpeedType.Normal]=1,I[P.ReplaySpeedType.Fast]=.5,I)),e.sheetType=new C.EnumConverter(((S={})[P.SheetType.Dashboard]=E.SheetType.Dashboard,S[P.SheetType.Worksheet]=E.SheetType.Worksheet,S[P.SheetType.Story]=E.SheetType.Story,S)),e.showDataTableFormatType=new C.EnumConverter(((_={})[P.IncludeDataValuesOption.AllValues]=E.ApiShowDataTableFormat.NativeAndFormattedValues,_[P.IncludeDataValuesOption.OnlyNativeValues]=E.ApiShowDataTableFormat.NativeValuesOnly,_[P.IncludeDataValuesOption.OnlyFormattedValues]=E.ApiShowDataTableFormat.FormattedValuesOnly,_)),e.periodType=new C.EnumConverter(((A={})[P.PeriodType.Years]=E.DateStepPeriod.Years,A[P.PeriodType.Quarters]=E.DateStepPeriod.Quarters,A[P.PeriodType.Months]=E.DateStepPeriod.Months,A[P.PeriodType.Weeks]=E.DateStepPeriod.Weeks,A[P.PeriodType.Days]=E.DateStepPeriod.Days,A[P.PeriodType.Hours]=E.DateStepPeriod.Hours,A[P.PeriodType.Minutes]=E.DateStepPeriod.Minutes,A[P.PeriodType.Seconds]=E.DateStepPeriod.Seconds,A)),e.dateRangeType=new C.EnumConverter(((T={})[P.DateRangeType.Last]=E.DateRangeType.Last,T[P.DateRangeType.LastN]=E.DateRangeType.LastN,T[P.DateRangeType.Next]=E.DateRangeType.Next,T[P.DateRangeType.NextN]=E.DateRangeType.NextN,T[P.DateRangeType.Current]=E.DateRangeType.Current,T[P.DateRangeType.ToDate]=E.DateRangeType.ToDate,T)),e.dialogStyles=new C.EnumConverter(((w={})[P.DialogStyle.Window]=E.DialogStyle.Window,w[P.DialogStyle.Modal]=E.DialogStyle.Modal,w[P.DialogStyle.Modeless]=E.DialogStyle.Modeless,w)),e}();h.ExternalToInternalEnumMappings=D},5126:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g,y,b,v,I,S,_,A,T,w,P,E,C,D,k,x,O,V=m(1750),N=m(4695),M=m(4406),F=function(){function e(){}return e.extensionContext=new M.EnumConverter(((g={})[N.ExtensionContext.Desktop]=V.ExtensionContext.Desktop,g[N.ExtensionContext.Server]=V.ExtensionContext.Server,g)),e.extensionMode=new M.EnumConverter(((y={})[N.ExtensionMode.Authoring]=V.ExtensionMode.Authoring,y[N.ExtensionMode.Viewing]=V.ExtensionMode.Viewing,y)),e.columnType=new M.EnumConverter(((b={})[N.ColumnType.Continuous]=V.ColumnType.Continuous,b[N.ColumnType.Discrete]=V.ColumnType.Discrete,b)),e.fieldAggregationType=new M.EnumConverter(((v={})[N.FieldAggregationType.Attr]=V.FieldAggregationType.Attr,v[N.FieldAggregationType.Avg]=V.FieldAggregationType.Avg,v[N.FieldAggregationType.Collect]=V.FieldAggregationType.Collect,v[N.FieldAggregationType.Count]=V.FieldAggregationType.Count,v[N.FieldAggregationType.Countd]=V.FieldAggregationType.Countd,v[N.FieldAggregationType.Day]=V.FieldAggregationType.Day,v[N.FieldAggregationType.End]=V.FieldAggregationType.End,v[N.FieldAggregationType.Hour]=V.FieldAggregationType.Hour,v[N.FieldAggregationType.InOut]=V.FieldAggregationType.InOut,v[N.FieldAggregationType.Kurtosis]=V.FieldAggregationType.Kurtosis,v[N.FieldAggregationType.Max]=V.FieldAggregationType.Max,v[N.FieldAggregationType.Mdy]=V.FieldAggregationType.Mdy,v[N.FieldAggregationType.Median]=V.FieldAggregationType.Median,v[N.FieldAggregationType.Min]=V.FieldAggregationType.Min,v[N.FieldAggregationType.Minute]=V.FieldAggregationType.Minute,v[N.FieldAggregationType.MonthYear]=V.FieldAggregationType.MonthYear,v[N.FieldAggregationType.None]=V.FieldAggregationType.None,v[N.FieldAggregationType.Qtr]=V.FieldAggregationType.Qtr,v[N.FieldAggregationType.Quart1]=V.FieldAggregationType.Quart1,v[N.FieldAggregationType.Quart3]=V.FieldAggregationType.Quart3,v[N.FieldAggregationType.Second]=V.FieldAggregationType.Second,v[N.FieldAggregationType.Skewness]=V.FieldAggregationType.Skewness,v[N.FieldAggregationType.Stdev]=V.FieldAggregationType.Stdev,v[N.FieldAggregationType.Stdevp]=V.FieldAggregationType.Stdevp,v[N.FieldAggregationType.Sum]=V.FieldAggregationType.Sum,v[N.FieldAggregationType.TruncDay]=V.FieldAggregationType.TruncDay,v[N.FieldAggregationType.TruncHour]=V.FieldAggregationType.TruncHour,v[N.FieldAggregationType.TruncMinute]=V.FieldAggregationType.TruncMinute,v[N.FieldAggregationType.TruncMonth]=V.FieldAggregationType.TruncMonth,v[N.FieldAggregationType.TruncQtr]=V.FieldAggregationType.TruncQtr,v[N.FieldAggregationType.TruncSecond]=V.FieldAggregationType.TruncSecond,v[N.FieldAggregationType.TruncWeek]=V.FieldAggregationType.TruncWeek,v[N.FieldAggregationType.TruncYear]=V.FieldAggregationType.TruncYear,v[N.FieldAggregationType.User]=V.FieldAggregationType.User,v[N.FieldAggregationType.Var]=V.FieldAggregationType.Var,v[N.FieldAggregationType.Varp]=V.FieldAggregationType.Varp,v[N.FieldAggregationType.Week]=V.FieldAggregationType.Week,v[N.FieldAggregationType.Weekday]=V.FieldAggregationType.Weekday,v[N.FieldAggregationType.Year]=V.FieldAggregationType.Year,v)),e.fieldRoleType=new M.EnumConverter(((I={})[N.FieldRoleType.Dimension]=V.FieldRoleType.Dimension,I[N.FieldRoleType.Measure]=V.FieldRoleType.Measure,I[N.FieldRoleType.Unknown]=V.FieldRoleType.Unknown,I)),e.sheetType=new M.EnumConverter(((S={})[N.SheetType.Dashboard]=V.SheetType.Dashboard,S[N.SheetType.Story]=V.SheetType.Story,S[N.SheetType.Worksheet]=V.SheetType.Worksheet,S)),e.dashboardObjectType=new M.EnumConverter(((_={})[N.DashboardObjectType.Extension]=V.DashboardObjectType.Extension,_[N.DashboardObjectType.Blank]=V.DashboardObjectType.Blank,_[N.DashboardObjectType.Image]=V.DashboardObjectType.Image,_[N.DashboardObjectType.Legend]=V.DashboardObjectType.Legend,_[N.DashboardObjectType.PageFilter]=V.DashboardObjectType.PageFilter,_[N.DashboardObjectType.ParameterControl]=V.DashboardObjectType.ParameterControl,_[N.DashboardObjectType.QuickFilter]=V.DashboardObjectType.QuickFilter,_[N.DashboardObjectType.Text]=V.DashboardObjectType.Text,_[N.DashboardObjectType.Title]=V.DashboardObjectType.Title,_[N.DashboardObjectType.WebPage]=V.DashboardObjectType.WebPage,_[N.DashboardObjectType.Worksheet]=V.DashboardObjectType.Worksheet,_)),e.dataType=new M.EnumConverter(((A={})[N.DataType.Bool]=V.DataType.Bool,A[N.DataType.Date]=V.DataType.Date,A[N.DataType.DateTime]=V.DataType.DateTime,A[N.DataType.Float]=V.DataType.Float,A[N.DataType.Int]=V.DataType.Int,A[N.DataType.String]=V.DataType.String,A)),e.filterUpdateType=new M.EnumConverter(((T={})[N.FilterUpdateType.Add]=V.FilterUpdateType.Add,T[N.FilterUpdateType.All]=V.FilterUpdateType.All,T[N.FilterUpdateType.Remove]=V.FilterUpdateType.Remove,T[N.FilterUpdateType.Replace]=V.FilterUpdateType.Replace,T)),e.allowableValues=new M.EnumConverter(((w={})[N.DomainRestrictionType.All]=V.ParameterValueType.All,w[N.DomainRestrictionType.List]=V.ParameterValueType.List,w[N.DomainRestrictionType.Range]=V.ParameterValueType.Range,w)),e.dateStepPeriod=new M.EnumConverter(((P={})[N.DateStepPeriod.Years]=V.PeriodType.Years,P[N.DateStepPeriod.Quarters]=V.PeriodType.Quarters,P[N.DateStepPeriod.Months]=V.PeriodType.Months,P[N.DateStepPeriod.Weeks]=V.PeriodType.Weeks,P[N.DateStepPeriod.Days]=V.PeriodType.Days,P[N.DateStepPeriod.Hours]=V.PeriodType.Hours,P[N.DateStepPeriod.Minutes]=V.PeriodType.Minutes,P[N.DateStepPeriod.Seconds]=V.PeriodType.Seconds,P)),e.dateRangeType=new M.EnumConverter(((E={})[N.DateRangeType.Current]=V.DateRangeType.Current,E[N.DateRangeType.Last]=V.DateRangeType.Last,E[N.DateRangeType.LastN]=V.DateRangeType.LastN,E[N.DateRangeType.Next]=V.DateRangeType.Next,E[N.DateRangeType.NextN]=V.DateRangeType.NextN,E[N.DateRangeType.ToDate]=V.DateRangeType.ToDate,E)),e.errorCode=new M.EnumConverter(((C={})[N.ErrorCodes.INITIALIZATION_ERROR]=V.ErrorCodes.InternalError,C[N.ErrorCodes.INTERNAL_ERROR]=V.ErrorCodes.InternalError,C[N.ErrorCodes.MISSING_ENUM_MAPPING]=V.ErrorCodes.InternalError,C[N.ErrorCodes.MISSING_PARAMETER]=V.ErrorCodes.InternalError,C[N.ErrorCodes.PERMISSION_DENIED]=V.ErrorCodes.InternalError,C[N.ErrorCodes.PRES_MODEL_PARSING_ERROR]=V.ErrorCodes.InternalError,C[N.ErrorCodes.UNKNOWN_VERB_ID]=V.ErrorCodes.InternalError,C[N.ErrorCodes.VERSION_NOT_CONFIGURED]=V.ErrorCodes.APINotInitialized,C[N.ErrorCodes.VISIBILITY_ERROR]=V.ErrorCodes.VisibilityError,C),V.ErrorCodes.InternalError),e.filterType=new M.EnumConverter(((D={})[N.FilterType.Categorical]=V.FilterType.Categorical,D[N.FilterType.Range]=V.FilterType.Range,D[N.FilterType.RelativeDate]=V.FilterType.RelativeDate,D[N.FilterType.Hierarchical]=V.FilterType.Hierarchical,D)),e.classNameKey=new M.EnumConverter(((k={})["tableau-dashboard-title"]=V.ClassNameKey.DashboardTitle,k["tableau-story-title"]=V.ClassNameKey.StoryTitle,k["tableau-tooltip"]=V.ClassNameKey.Tooltip,k["tableau-worksheet"]=V.ClassNameKey.Worksheet,k["tableau-worksheet-title"]=V.ClassNameKey.WorksheetTitle,k["dashboard-title"]=V.ClassNameKey.DashboardTitle,k["story-title"]=V.ClassNameKey.StoryTitle,k.tooltip=V.ClassNameKey.Tooltip,k.worksheet=V.ClassNameKey.Worksheet,k["worksheet-title"]=V.ClassNameKey.WorksheetTitle,k)),e.hierarchicalLevelSelectionState=new M.EnumConverter(((x={})[N.HierarchicalLevelSelectionState.AllSelected]=V.HierarchicalLevelSelectionState.AllSelected,x[N.HierarchicalLevelSelectionState.NoneSelected]=V.HierarchicalLevelSelectionState.NoneSelected,x[N.HierarchicalLevelSelectionState.SomeSelected]=V.HierarchicalLevelSelectionState.SomeSelected,x[N.HierarchicalLevelSelectionState.UnknownSelected]=V.HierarchicalLevelSelectionState.UnknownSelected,x)),e.annotationType=new M.EnumConverter(((O={})[N.AnnotateEnum.Area]=V.AnnotationType.Area,O[N.AnnotateEnum.Mark]=V.AnnotationType.Mark,O[N.AnnotateEnum.Point]=V.AnnotationType.Point,O)),e}();h.InternalToExternalEnumMappings=F},3682:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(1554),b=function(){function e(){this._eventListenerManagers={}}return e.prototype.addEventListener=function(p,h){if(!this._eventListenerManagers.hasOwnProperty(p))throw new y.TableauError(g.ErrorCodes.UnsupportedEventName,"Cannot add event, unsupported event type: "+p);return this._eventListenerManagers[p].addEventListener(h)},e.prototype.removeEventListener=function(p,h){if(!this._eventListenerManagers.hasOwnProperty(p))throw new y.TableauError(g.ErrorCodes.UnsupportedEventName,"Cannot remove event, unsupported event type: "+p);return this._eventListenerManagers[p].removeEventListener(h)},e.prototype.addNewEventType=function(p){this._eventListenerManagers[p.eventType]=p},e}();h.EventListenerManager=b},2131:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(316),y=function(){function e(p){this._fieldImpl=p}return Object.defineProperty(e.prototype,"name",{get:function(){return this._fieldImpl.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._fieldImpl.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._fieldImpl.description},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aggregation",{get:function(){return this._fieldImpl.aggregation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._fieldImpl.dataSource},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"role",{get:function(){return this._fieldImpl.role},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHidden",{get:function(){return this._fieldImpl.isHidden},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGenerated",{get:function(){return this._fieldImpl.isGenerated},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCalculatedField",{get:function(){return this._fieldImpl.isCalculatedField},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnType",{get:function(){throw g.ErrorHelpers.apiNotImplemented("Field.columnType")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCombinedField",{get:function(){return this._fieldImpl.isCombinedField},enumerable:!0,configurable:!0}),e}();h.Field=y},2913:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(4007),y=function(){function e(p,h){this._registryId=h,this._luid=p.luid,this._name=p.name,this._shared=p.shared,this._isDefault=p.isDefault,this._ownerName=p.owner.userFriendlyName,this._url=p.url}return Object.defineProperty(e.prototype,"luid",{get:function(){return this._luid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(p){this._name=p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shared",{get:function(){return this._shared},set:function(p){this._shared=p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDefault",{get:function(){return this._isDefault},set:function(p){this._isDefault=p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ownerName",{get:function(){return this._ownerName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),e.prototype.saveAsync=function(){return g.ApiServiceRegistry.get(this._registryId).getService("viz-service").saveAsync(this)},e}();h.CustomViewImpl=y},4657:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(1750),I=m(4695),S=m(5126),_=m(2391),A=m(9887),T=m(1554),w=m(316),P=m(3333),E=m(1878),C=m(6749),D=m(928),k=function(p){function t(h,m,g,y,b){var v=p.call(this,h,y)||this;return v._zones=m,v._sheetPath=g,v._parentStoryPointImpl=b,v}return y(t,p),Object.defineProperty(t.prototype,"worksheetsImpl",{get:function(){return this._worksheetsImpl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"objects",{get:function(){return this._objects},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentStoryPoint",{get:function(){return this._parentStoryPointImpl},enumerable:!0,configurable:!0}),t.prototype.initializeWithPublicInterfaces=function(){this._worksheetsImpl=[],this._objects=[],this.zoneMap=new Map;for(var p=0,h=this._zones;p<h.length;p++){var m=h[p],g=void 0,y={width:m.width,height:m.height};if(m.zoneType===I.DashboardObjectType.Worksheet){var b="",A="",T=!1;m.sheetInfo?(b=m.sheetInfo.name,T=""===(A=m.sheetInfo.url||"")):b=m.name;var w=new C.SheetInfoImpl(b,v.SheetType.Worksheet,y,this._worksheetsImpl.length,!1,T,A),E={worksheet:b,dashboard:this._sheetInfoImpl.name,storyboard:this._sheetPath.storyboard,flipboardZoneID:this._sheetPath.flipboardZoneID,storyPointID:this._sheetPath.storyPointID};g=new D.WorksheetImpl(w,this._registryId,E,this,this._parentStoryPointImpl),this._worksheetsImpl.push(g)}var k=new _.Point(m.x,m.y),x=new P.DashboardObjectImpl(this,S.InternalToExternalEnumMappings.dashboardObjectType.convert(m.zoneType),k,y,g,m.name,void 0!==m.isFloating&&m.isFloating,void 0===m.isVisible||m.isVisible,m.zoneId);this._objects.push(x),this.zoneMap.set(m.zoneId,x)}},t.prototype.setDashboardObjectVisibilityAsync=function(p){return A.ApiServiceRegistry.get(this._registryId).getService("zone-service").setVisibilityAsync(this.name,this.zoneMap,p)},t.prototype.getDashboardObjectById=function(p){return this.zoneMap.get(p)},t.prototype.updateZones=function(p){var h=this,m=this._objects,g=this.zoneMap;this._zones=p,this.initializeWithPublicInterfaces();var y=this._objects,b=this.zoneMap,I=new Map;return m.forEach(function(p){var m=p.id;if(b.has(m)){var g=b.get(m);p.isFloating!==g.isFloating&&h.addChange(m,I,v.DashboardLayoutChange.IsFloatingChanged),p.isVisible!==g.isVisible&&h.addChange(m,I,v.DashboardLayoutChange.IsVisibleChanged),p.name!==g.name&&h.addChange(m,I,v.DashboardLayoutChange.NameChanged),p.position.x===g.position.x&&p.position.y===g.position.y||h.addChange(m,I,v.DashboardLayoutChange.PositionChanged),p.size.width===g.size.width&&p.size.height===g.size.height||h.addChange(m,I,v.DashboardLayoutChange.SizeChanged)}else h.addChange(m,I,v.DashboardLayoutChange.Removed)}),y.forEach(function(p){g.has(p.id)||h.addChange(p.id,I,v.DashboardLayoutChange.Added)}),I},t.prototype.addChange=function(p,h,m){h.has(p)||h.set(p,[]),h.get(p).push(m)},t.prototype.moveAndResizeDashboardObjectsAsync=function(p){return A.ApiServiceRegistry.get(this._registryId).getService("zone-service").moveAndResizeAsync(this.name,this.zoneMap,p)},t.prototype.replayAnimationAsync=function(p){return A.ApiServiceRegistry.get(this._registryId).getService("animation-service").replayAsync(p)},t.prototype.getFiltersAsync=function(){return this.verifyActiveSheetOrEmbeddedInActiveStoryPoint(),A.ApiServiceRegistry.get(this._registryId).getService("filter-service").getDashboardFiltersAsync()},t.prototype.applyFilterAsync=function(p,h,m,g){if(w.ErrorHelpers.verifyEnumValue(m,b.FilterUpdateType,"FilterUpdateType"),w.ErrorHelpers.verifyStringParameter(p,"fieldName"),!Array.isArray(h))throw new T.TableauError(v.ErrorCodes.InvalidParameter,"values parameter for applyDashboardFilterAsync must be an array");return this.verifyActiveSheetOrEmbeddedInActiveStoryPoint(),A.ApiServiceRegistry.get(this._registryId).getService("filter-service").applyDashboardFilterAsync(p,h,m,g)},t.prototype.getWorksheetNamesFromZones=function(){for(var p=[],h=0,m=this._zones;h<m.length;h++){var g=m[h];if(g.zoneType===I.DashboardObjectType.Worksheet){var y=g.sheetInfo?g.sheetInfo.name:g.name;p.push(y)}}return p},t.prototype.verifyActiveSheetOrEmbeddedInActiveStoryPoint=function(){var p=this.active,h=null!=this.parentStoryPoint&&this.parentStoryPoint.active;if(!p&&!h)throw new T.TableauError(v.SharedErrorCodes.NotActiveSheet,"Operation not allowed on non-active sheet")},t}(E.SheetImpl);h.DashboardImpl=k},3333:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p,h,m,g,y,b,v,I,S){this._dashboardImpl=p,this._type=h,this._position=m,this._size=g,this._worksheetImpl=y,this._name=b,this._isFloating=v,this._isVisible=I,this._id=S}return Object.defineProperty(e.prototype,"dashboardImpl",{get:function(){return this._dashboardImpl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"worksheetImpl",{get:function(){return this._worksheetImpl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFloating",{get:function(){return this._isFloating},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),e}();h.DashboardObjectImpl=m},1234:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(5458),b=m(2131),v=m(1110),I=m(9887),S=m(1738),_=m(316),A=m(8695),T=function(){function e(p,h){var m=this;this._dataSourceInfo=p,this._registryId=h,this._fields=p.fields.map(function(p){var h=new A.FieldImpl(p,m);return new b.Field(h)})}return Object.defineProperty(e.prototype,"name",{get:function(){return this._dataSourceInfo.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._dataSourceInfo.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extractUpdateTime",{get:function(){return this._dataSourceInfo.extractUpdateTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fields",{get:function(){return this._fields},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExtract",{get:function(){return this._dataSourceInfo.isExtract},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPublished",{get:function(){return this._dataSourceInfo.isPublished},enumerable:!0,configurable:!0}),e.prototype.publishedUrl=function(){return this._dataSourceInfo.publishedUrl},e.prototype.getMaxPageRowLimit=function(){return 1e4},e.prototype.refreshAsync=function(){return I.ApiServiceRegistry.get(this._registryId).getService("data-source-service").refreshAsync(this._dataSourceInfo.id)},e.prototype.getConnectionSummariesAsync=function(){return I.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getConnectionSummariesAsync(this._dataSourceInfo.id).then(function(p){return p.map(function(p){return new y.ConnectionSummary(p)})})},e.prototype.getActiveTablesAsync=function(){return I.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getActiveTablesAsync(this._dataSourceInfo.id).then(function(p){return p.map(function(p){return new S.TableSummary(p)})})},e.prototype.getUnderlyingDataAsync=function(p){return p=p||{},I.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getDataSourceDataAsync(this.id,!!p.ignoreAliases,p.maxRows||0,p.columnsToInclude||[],p.columnsToIncludeById||[],p.includeDataValuesOption||g.IncludeDataValuesOption.AllValues)},e.prototype.getLogicalTableDataAsync=function(p,h){return h=h||{},I.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getLogicalTableDataAsync(this.id,p,!!h.ignoreAliases,h.maxRows||0,h.columnsToInclude||[],h.columnsToIncludeById||[],h.includeDataValuesOption||g.IncludeDataValuesOption.AllValues)},e.prototype.getLogicalTableDataReaderAsync=function(p,h,m){return m=m||{},I.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getLogicalTableDataReaderAsync(this.id,p,h||this.getMaxPageRowLimit(),!!m.ignoreAliases,m.columnsToIncludeById||[],m.includeDataValuesOption||g.IncludeDataValuesOption.AllValues)},e.prototype.initializeWithPublicInterfaces=function(p){_.ErrorHelpers.verifyInternalValue(p,"dataSource"),this._fields=this._dataSourceInfo.fields.map(function(h){var m=new A.FieldImpl(h,p);return new b.Field(m)})},e.prototype.getLogicalTablesAsync=function(){return I.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getLogicalTablesAsync(this.id).then(function(p){return p.map(function(p){return new v.LogicalTable(p)})})},e}();h.DataSourceImpl=T},8695:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(5126),y=function(){function e(p,h){this._fieldInfo=p,this._parentDataSource=h}return Object.defineProperty(e.prototype,"name",{get:function(){return this._fieldInfo.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._fieldInfo.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._fieldInfo.description},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aggregation",{get:function(){return g.InternalToExternalEnumMappings.fieldAggregationType.convert(this._fieldInfo.aggregation)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._parentDataSource},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"role",{get:function(){return g.InternalToExternalEnumMappings.fieldRoleType.convert(this._fieldInfo.role)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHidden",{get:function(){return this._fieldInfo.isHidden},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGenerated",{get:function(){return this._fieldInfo.isGenerated},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCalculatedField",{get:function(){return this._fieldInfo.isCalculatedField},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCombinedField",{get:function(){return this._fieldInfo.isCombinedField},enumerable:!0,configurable:!0}),e}();h.FieldImpl=y},6560:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(5126),b=m(9887),v=m(8175),I=m(316),S=m(6077),_=function(){function e(p,h){this._registryId=h,this.setParameterInfo(p)}return Object.defineProperty(e.prototype,"name",{get:function(){return this._parameterInfo.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentValue",{get:function(){return v.DataValueFactory.MakeParameterDataValue(this._parameterInfo.currentValue,this._parameterInfo.dataType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return y.InternalToExternalEnumMappings.dataType.convert(this._parameterInfo.dataType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._globalFieldName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowableValues",{get:function(){return this._allowableValues},enumerable:!0,configurable:!0}),e.prototype.changeValueAsync=function(p){var h=this;I.ErrorHelpers.verifyParameter(p,"newValue");var m=S.Param.serializeParameterValue(p);return b.ApiServiceRegistry.get(this._registryId).getService("parameters-service").changeParameterValueAsync(this._globalFieldName,m).then(function(p){return h.setParameterInfo(p),h.currentValue})},e.prototype.setParameterInfo=function(p){this._parameterInfo=p,this._globalFieldName=p.fieldName;var h,m,b,I,S,_=y.InternalToExternalEnumMappings.allowableValues.convert(p.allowableValuesType);_===g.ParameterValueType.List?h=(p.allowableValues||[]).map(function(h){return v.DataValueFactory.MakeParameterDataValue(h,p.dataType)}):_===g.ParameterValueType.Range&&(m=p.minValue&&v.DataValueFactory.MakeParameterDataValue(p.minValue,p.dataType),b=p.maxValue&&v.DataValueFactory.MakeParameterDataValue(p.maxValue,p.dataType),I=p.stepSize,S=p.dateStepPeriod&&y.InternalToExternalEnumMappings.dateStepPeriod.convert(p.dateStepPeriod)),this._allowableValues={type:_,allowableValues:h,minValue:m,maxValue:b,stepSize:I,dateStepPeriod:S}},e}();h.ParameterImpl=_},1878:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(9887),b=m(1554),v=m(316),I=m(6077),S=m(489),_=function(){function e(p,h){this._sheetInfoImpl=p,this._registryId=h}return Object.defineProperty(e.prototype,"name",{get:function(){return this._sheetInfoImpl.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheetType",{get:function(){return this._sheetInfoImpl.sheetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheetPath",{get:function(){return this._sheetInfoImpl.sheetPath},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._sheetInfoImpl.sheetSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hidden",{get:function(){if(void 0!==this._sheetInfoImpl.isHidden)return this._sheetInfoImpl.isHidden;throw new b.TableauError(g.EmbeddingErrorCodes.ImplementationError,"isHidden not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){if(void 0!==this._sheetInfoImpl.isActive)return this._sheetInfoImpl.isActive;throw new b.TableauError(g.EmbeddingErrorCodes.ImplementationError,"active not implemented")},set:function(p){void 0!==this._sheetInfoImpl.isActive&&(this._sheetInfoImpl.active=p)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){if(void 0!==this._sheetInfoImpl.index)return this._sheetInfoImpl.index;throw new b.TableauError(g.EmbeddingErrorCodes.ImplementationError,"index not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){if(void 0!==this._sheetInfoImpl.url)return this._sheetInfoImpl.url;throw new b.TableauError(g.EmbeddingErrorCodes.ImplementationError,"url not implemented")},enumerable:!0,configurable:!0}),e.prototype.getSheetSize=function(){if(!S.SheetUtils.isValidSheetSize(this.size))throw new b.TableauError(g.EmbeddingErrorCodes.InternalError,"size is not of type SheetSize");return this.size},e.prototype.findParameterAsync=function(p){return v.ErrorHelpers.verifyParameter(p,"parameterName"),y.ApiServiceRegistry.get(this._registryId).getService("parameters-service").findParameterByNameAsync(p)},e.prototype.getParametersAsync=function(){return y.ApiServiceRegistry.get(this._registryId).getService("parameters-service").getParametersForSheetAsync(this.sheetPath)},e.prototype.changeSizeAsync=function(p){var h=this,m=new b.TableauError(g.EmbeddingErrorCodes.InvalidSize,"Invalid sheet size parameter");if(!p||!p.behavior)throw m;var v=this.normalizeSheetSize(p),I=v.behavior===g.SheetSizeBehavior.Automatic;if(!I&&!v.minSize&&!v.maxSize)throw m;if(!I&&this.sheetType===g.SheetType.Worksheet)throw new b.TableauError(g.EmbeddingErrorCodes.InvalidSizeBehaviorOnWorksheet,"Only SheetSizeBehavior.Automatic is allowed on Worksheets");if(I&&this.getSheetSize().behavior===v.behavior)return Promise.resolve(p);var _=this.processNewSize(v);return y.ApiServiceRegistry.get(this._registryId).getService("size-service").changeSizeAsync(this.name,_).then(function(){return y.ApiServiceRegistry.get(h._registryId).getService("client-info-service").getClientInfoAsync().then(function(p){var m=p.publishedSheets.find(function(p){return p.name===h.name});if(!m)throw new b.TableauError(g.SharedErrorCodes.InternalError,"Can't find sheet with name "+h.name);var y=S.SheetUtils.getSheetSizeFromSizeConstraints(m.sizeConstraint);return h._sheetInfoImpl.sheetSize=y,y})})},e.prototype.normalizeSheetSize=function(p){var h=p.behavior;return v.ErrorHelpers.verifyEnumValue(h,g.SheetSizeBehavior,"SheetSizeBehavior"),{behavior:h,minSize:e.parseDimensions(p.minSize),maxSize:e.parseDimensions(p.maxSize)}},e.prototype.processNewSize=function(p){var h=p.behavior,m=p.minSize,y=p.maxSize,v=!I.Param.isNullOrUndefined(null==m?void 0:m.width),S=!I.Param.isNullOrUndefined(null==m?void 0:m.height),_=!I.Param.isNullOrUndefined(null==y?void 0:y.width),A=!I.Param.isNullOrUndefined(null==y?void 0:y.height),T=v&&S,w=_&&A;switch(h){case g.SheetSizeBehavior.Automatic:return{behavior:h};case g.SheetSizeBehavior.AtMost:if(!y||!w)throw new b.TableauError(g.EmbeddingErrorCodes.MissingMaxSize,"Missing maxSize for SheetSizeBehavior.AtMost");if((E={width:y.width,height:y.height}).width<0||E.height<0)throw new b.TableauError(g.EmbeddingErrorCodes.InvalidSize,"Size value cannot be less than zero");return{behavior:h,maxSize:E};case g.SheetSizeBehavior.AtLeast:if(!m||!T)throw new b.TableauError(g.EmbeddingErrorCodes.MissingMinSize,"Missing minSize for SheetSizeBehavior.AtLeast");if((P={width:m.width,height:m.height}).width<0||P.height<0)throw new b.TableauError(g.EmbeddingErrorCodes.InvalidSize,"Size value cannot be less than zero");return{behavior:h,minSize:P};case g.SheetSizeBehavior.Range:if(!(m&&y&&T&&w))throw new b.TableauError(g.EmbeddingErrorCodes.MissingMinMaxSize,"Missing minSize or maxSize for SheetSizeBehavior.Range");var P={width:m.width,height:m.height},E={width:y.width,height:y.height};if(P.width<0||P.height<0||E.width<0||E.height<0||P.width>E.width||P.height>E.height)throw new b.TableauError(g.EmbeddingErrorCodes.InvalidSize,"Missing minSize or maxSize for SheetSizeBehavior.Range");return{behavior:h,minSize:P,maxSize:E};case g.SheetSizeBehavior.Exactly:if(m&&y){if(T&&w){if(P={width:m.width,height:m.height},E={width:y.width,height:y.height},P.width!==E.width||P.height!==E.height)throw new b.TableauError(g.EmbeddingErrorCodes.InvalidSize,"Conflicting size values for SheetSizeBehavior.Exactly");return{behavior:h,minSize:P,maxSize:E}}if(T)return{behavior:h,minSize:P={width:m.width,height:m.height},maxSize:P};if(w)return{behavior:h,minSize:E={width:y.width,height:y.height},maxSize:E}}throw new b.TableauError(g.EmbeddingErrorCodes.InvalidSize,"Invalid sheet size parameter");default:throw new b.TableauError(g.SharedErrorCodes.InternalError,"Unsupported sheet size behavior: "+h)}},e.parseDimensions=function(p){var h={width:void 0,height:void 0};if(!p)return h;var m=I.Param.tryParseNumber(p.width),g=m.success,y=m.parsed,b=I.Param.tryParseNumber(p.height),v=b.success,S=b.parsed;return g&&v?{width:y,height:S}:g?{width:y}:v?{height:S}:h},e}();h.SheetImpl=_},6749:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=function(){function e(p,h,m,g,y,b,v){this._name=p,this._sheetType=h,this._sheetSize=m,this._index=g,this._isActive=y,this._isHidden=b,this._url=v}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheetSize",{get:function(){return this._sheetSize},set:function(p){this._sheetSize=p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheetType",{get:function(){return this._sheetType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheetPath",{get:function(){return{sheetName:this.name,isDashboard:this.sheetType===g.SheetType.Dashboard}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isActive",{get:function(){return this._isActive},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active",{set:function(p){this._isActive=p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHidden",{get:function(){return this._isHidden},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),e}();h.SheetInfoImpl=y},4217:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p){this._eventType=p,this._handlers=[]}return Object.defineProperty(e.prototype,"eventType",{get:function(){return this._eventType},enumerable:!0,configurable:!0}),e.prototype.addEventListener=function(p){var h=this;return this._handlers.push(p),function(){return h.removeEventListener(p)}},e.prototype.removeEventListener=function(p){var h=this._handlers.length;return this._handlers=this._handlers.filter(function(h){return h!==p}),h>this._handlers.length},e.prototype.triggerEvent=function(p){for(var h=0,m=this._handlers;h<m.length;h++){var g=m[h];try{g(p())}catch(p){continue}}},e}();h.SingleEventManagerImpl=m},8194:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(9887),I=m(1554),S=m(316),_=m(8634),A=m(1878),T=m(757),w=m(8519),P=function(p){function t(h,m,g,y){var b=p.call(this,h,y)||this;return b._sheetInfoImpl=h,b._publishedSheetInfos=g,b._registryId=y,b._storyPointInfoImpls=[],b._deferred=new _.ShortLivedDeferred,b.initializeStory(m),b}return y(t,p),t.prototype.initializeStory=function(p){var h=this;p.storyPoints.forEach(function(m){var g=m.index===p.activeStoryPointIndex,y=new w.StoryPointInfoImpl(m.caption,m.index,m.storyPointId,g,m.updated,h);h._storyPointInfoImpls.push(y),g&&(h._activeStoryPointImpl=new T.StoryPointImpl(y,h._publishedSheetInfos,h._registryId,m.containedSheetInfo))})},t.prototype.updateStoryInfo=function(p,h){if(this._storyPointInfoImpls){var m=this._storyPointInfoImpls[p];if(m.storyPointId!==h.storyPointId)throw new I.TableauError(b.EmbeddingErrorCodes.StoryPointIdMismatch,"We should not be updating a story point when the IDs don't match. Existing storyPointID="+m.storyPointId+", newStoryPointID="+h.storyPointId);m.caption=h.caption,m.updated=h.updated,this._activeStoryPointImpl.storyPointId===h.storyPointId&&(this._activeStoryPointImpl.updated=m.updated)}},t.prototype.updateStory=function(p){var h=this;this._storyPointInfoImpls&&(this._storyPointInfoImpls.forEach(function(m){m.storyPointId===p.storyPointId?(m.caption=p.caption,m.index=p.index,m.active=!0,m.updated=p.updated,h._activeStoryPointImpl=new T.StoryPointImpl(m,h._publishedSheetInfos,h._registryId,p.containedSheetInfo)):m.active=!1}),this.activeStoryPoint&&this._deferred.resolve(this.activeStoryPoint))},Object.defineProperty(t.prototype,"activeStoryPoint",{get:function(){return this._activeStoryPointImpl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storyPointsInfo",{get:function(){return this._storyPointInfoImpls},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this._sheetInfoImpl.active},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHidden",{get:function(){return!!this._sheetInfoImpl.isHidden},enumerable:!0,configurable:!0}),t.prototype.activateNextStoryPointAsync=function(){if(this._activeStoryPointImpl.index===this._storyPointInfoImpls.length-1)return Promise.resolve(this._activeStoryPointImpl);var p=this._deferred.getNewPromiseOrThrowIfBusy();return v.ApiServiceRegistry.get(this._registryId).getService("story-activation-service").activateNextStoryPointAsync(),p},t.prototype.activatePreviousStoryPointAsync=function(){if(0===this._activeStoryPointImpl.index)return Promise.resolve(this._activeStoryPointImpl);var p=this._deferred.getNewPromiseOrThrowIfBusy();return v.ApiServiceRegistry.get(this._registryId).getService("story-activation-service").activatePreviousStoryPointAsync(),p},t.prototype.activateStoryPointAsync=function(p){if(S.ErrorHelpers.verifyParameter(p,"index"),S.ErrorHelpers.verifyParameterType(p,"number","index"),p<0||p>=this._storyPointInfoImpls.length)throw new I.TableauError(b.EmbeddingErrorCodes.IndexOutOfRange,"The index passed to this command is out of range.");if(p===this._activeStoryPointImpl.index)return Promise.resolve(this._activeStoryPointImpl);var h=this._deferred.getNewPromiseOrThrowIfBusy();return v.ApiServiceRegistry.get(this._registryId).getService("story-activation-service").activateStoryPointAsync(p),h},t.prototype.revertStoryPointAsync=function(p){var h=this;if(S.ErrorHelpers.verifyParameter(p,"index"),S.ErrorHelpers.verifyParameterType(p,"number","index"),p<0||p>=this._storyPointInfoImpls.length)throw new I.TableauError(b.EmbeddingErrorCodes.IndexOutOfRange,"The index passed to this command is out of range.");return v.ApiServiceRegistry.get(this._registryId).getService("story-activation-service").revertStoryPointAsync(p).then(function(p){return h.updateStoryInfo(p.index,p),new w.StoryPointInfoImpl(p.caption,p.index,p.storyPointId,!1,p.updated,h)})},t.prototype.clearPendingPromises=function(){this._deferred&&this._deferred.reject("All pending promises cleared")},t}(A.SheetImpl);h.StoryImpl=P},757:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(1554),b=m(489),v=m(4657),I=m(6749),S=m(928),_=function(){function e(p,h,m,g){this._storyPointInfoImpl=p,g&&(this._containedSheetImpl=this.createContainedSheet(g,h,m))}return Object.defineProperty(e.prototype,"index",{get:function(){return this._storyPointInfoImpl.index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"caption",{get:function(){return this._storyPointInfoImpl.caption},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){return this._storyPointInfoImpl.active},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updated",{get:function(){return this._storyPointInfoImpl.updated},set:function(p){this._storyPointInfoImpl.updated=p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentStory",{get:function(){return this._storyPointInfoImpl.parentStory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containedSheet",{get:function(){return this._containedSheetImpl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storyPointId",{get:function(){return this._storyPointInfoImpl.storyPointId},enumerable:!0,configurable:!0}),e.prototype.createContainedSheet=function(p,h,m){var _,A=b.SheetUtils.getPublishedSheetInfoByName(p.name,h),T=b.SheetUtils.createAutomaticSize(),w=A?A.url:"",P=new I.SheetInfoImpl(p.name,b.SheetUtils.getSheetTypeEnum(p.sheetType),T,-1,!1,void 0===A,w);switch(P.sheetType){case g.SheetType.Worksheet:var E={worksheet:P.name};_=new S.WorksheetImpl(P,m,E,null,this);break;case g.SheetType.Dashboard:var C={sheetName:P.name,isDashboard:!0};_=new v.DashboardImpl(P,p.dashboardZones,C,m,this);break;default:throw new y.TableauError(g.SharedErrorCodes.ServerError,"Invalid SheetType")}return _},e}();h.StoryPointImpl=_},8519:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p,h,m,g,y,b){this._caption=p,this._index=h,this._storyPointId=m,this._active=g,this._updated=y,this._parentStoryImpl=b}return Object.defineProperty(e.prototype,"caption",{get:function(){return this._caption},set:function(p){this._caption=p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},set:function(p){this._index=p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storyPointId",{get:function(){return this._storyPointId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(p){this._active=p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updated",{get:function(){return this._updated},set:function(p){this._updated=p},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentStory",{get:function(){return this._parentStoryImpl},enumerable:!0,configurable:!0}),e}();h.StoryPointInfoImpl=m},3826:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.WorkbookImpl=function(){}},928:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(1750),I=m(6411),S=m(1110),_=m(850),A=m(9887),T=m(1554),w=m(316),P=m(1234),E=function(p){function t(h,m,g,y,b){var v=p.call(this,h,m)||this;return v._visualId=g,v._parentDashboardImpl=y,v._parentStoryPointImpl=b,v}return y(t,p),Object.defineProperty(t.prototype,"parentDashboard",{get:function(){return this._parentDashboardImpl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentStoryPoint",{get:function(){return this._parentStoryPointImpl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visualId",{get:function(){return this._visualId},enumerable:!0,configurable:!0}),t.prototype.getMaxPageRowLimit=function(){return 1e4},t.prototype.applyFilterAsync=function(p,h,m,g){return w.ErrorHelpers.verifyEnumValue(m,b.FilterUpdateType,"Contract.FilterUpdateType"),this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("filter-service").applyFilterAsync(this.visualId,p,h,m,g)},t.prototype.applyRangeFilterAsync=function(p,h){return w.ErrorHelpers.verifyParameter(p,"fieldName"),w.ErrorHelpers.verifyParameter(h,"filterOptions"),h.nullOption?w.ErrorHelpers.verifyEnumValue(h.nullOption,v.FilterNullOption,"FilterNullOption"):w.ErrorHelpers.verifyRangeParamType(h.min,h.max),this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("filter-service").applyRangeFilterAsync(this.visualId,p,h)},t.prototype.applyHierarchicalFilterAsync=function(p,h,m,g){if(w.ErrorHelpers.verifyParameter(p,"fieldName"),w.ErrorHelpers.verifyParameter(h,"values"),w.ErrorHelpers.verifyEnumValue(m,b.FilterUpdateType,"Contract.FilterUpdateType"),!Array.isArray(h)&&!h.levels)throw new T.TableauError(v.ErrorCodes.InvalidParameter,"values parameter for applyHierarchicalFilterAsync must be an array or contain a levels key");return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("filter-service").applyHierarchicalFilterAsync(this.visualId,p,h,m,g)},t.prototype.clearFilterAsync=function(p){return w.ErrorHelpers.verifyParameter(p,"fieldName"),this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("filter-service").clearFilterAsync(this.visualId,p)},t.prototype.applyRelativeDateFilterAsync=function(p,h){return w.ErrorHelpers.verifyStringParameter(p,"fieldName"),w.ErrorHelpers.verifyParameter(h,"options"),w.ErrorHelpers.verifyEnumValue(h.periodType,v.PeriodType,"PeriodType"),w.ErrorHelpers.verifyEnumValue(h.rangeType,v.DateRangeType,"DateRangeType"),this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("filter-service").applyRelativeDateFilterAsync(this.visualId,p,h)},t.prototype.getDataSourcesAsync=function(){var p=this;return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getDataSourcesAsync(this.visualId).then(function(h){var m=h.worksheetDataSchemaMap[p.name],g=[],y=m.primaryDataSource;g.push(p.createDataSourceFromInfo(h.dataSources[y]));for(var b=0,v=m.referencedDataSourceList;b<v.length;b++){var I=v[b];I!==y&&g.push(p.createDataSourceFromInfo(h.dataSources[I]))}return g})},t.prototype.getFiltersAsync=function(){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("filter-service").getFiltersAsync(this.visualId)},t.prototype.getSelectedMarksAsync=function(){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getSelectedMarksAsync(this.visualId)},t.prototype.getHighlightedMarksAsync=function(){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getHighlightedMarksAsync(this.visualId)},t.prototype.getSummaryDataAsync=function(p){return this.verifyActiveSheet(),p=p||{},A.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getUnderlyingDataAsync(this.visualId,_.GetDataType.Summary,!!p.ignoreAliases,!!p.ignoreSelection,!0,p.columnsToIncludeById||[],p.maxRows||0,p.includeDataValuesOption||v.IncludeDataValuesOption.AllValues)},t.prototype.getSummaryDataReaderAsync=function(p,h){return this.verifyActiveSheet(),h=h||{},A.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getSummaryDataReaderAsync(this.visualId,p||this.getMaxPageRowLimit(),!!h.ignoreAliases,!!h.ignoreSelection,!0,h.columnsToIncludeById||[],h.includeDataValuesOption||v.IncludeDataValuesOption.AllValues)},t.prototype.getSummaryColumnsInfoAsync=function(){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getSummaryColumnsInfoAsync(this.visualId)},t.prototype.getUnderlyingDataAsync=function(p){return this.verifyActiveSheet(),p=p||{},A.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getUnderlyingDataAsync(this.visualId,_.GetDataType.Underlying,!!p.ignoreAliases,!!p.ignoreSelection,!!p.includeAllColumns,p.columnsToIncludeById||[],p.maxRows||0,p.includeDataValuesOption||v.IncludeDataValuesOption.AllValues)},t.prototype.getUnderlyingTablesAsync=function(){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getUnderlyingTablesAsync(this.visualId).then(function(p){return p.map(function(p){return new S.LogicalTable(p)})})},t.prototype.getUnderlyingTableDataAsync=function(p,h){return this.verifyActiveSheet(),h=h||{},A.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getUnderlyingTableDataAsync(this.visualId,p,!!h.ignoreAliases,!!h.ignoreSelection,!!h.includeAllColumns,h.columnsToIncludeById||[],h.maxRows||0,h.includeDataValuesOption||v.IncludeDataValuesOption.AllValues)},t.prototype.getUnderlyingTableDataReaderAsync=function(p,h,m){return this.verifyActiveSheet(),m=m||{},A.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getUnderlyingTableDataReaderAsync(this.visualId,p,h||this.getMaxPageRowLimit(),!!m.ignoreAliases,!!m.ignoreSelection,!!m.includeAllColumns,m.columnsToIncludeById||[],m.includeDataValuesOption||v.IncludeDataValuesOption.AllValues)},t.prototype.clearSelectedMarksAsync=function(){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("selection-service").clearSelectedMarksAsync(this.visualId)},t.prototype.selectMarksByValueAsync=function(p,h){return w.ErrorHelpers.verifyParameter(p,"fieldName"),w.ErrorHelpers.verifyEnumValue(h,v.SelectionUpdateType,"SelectionUpdateType"),this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("selection-service").selectMarksByValueAsync(this.visualId,p,h)},t.prototype.selectMarksByIdAsync=function(p,h){return w.ErrorHelpers.verifyParameter(p,"fieldName"),w.ErrorHelpers.verifyEnumValue(h,v.SelectionUpdateType,"SelectionUpdateType"),this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("selection-service").selectMarksByIdAsync(this.visualId,p,h)},t.prototype.annotateMarkAsync=function(p,h){return w.ErrorHelpers.verifyParameter(p,"mark"),this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("annotation-service").annotateMarkAsync(this.visualId,p,h)},t.prototype.getAnnotationsAsync=function(){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("annotation-service").getAnnotationsAsync(this.visualId)},t.prototype.removeAnnotationAsync=function(p){return w.ErrorHelpers.verifyParameter(p,"annotation"),this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("annotation-service").removeAnnotationAsync(this.visualId,p)},t.prototype.appendContextMenuAsync=function(p,h){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("external-context-menu-service").appendContextMenuAsync(this.visualId.worksheet,p,h)},t.prototype.removeContextMenuAsync=function(p,h){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("external-context-menu-service").removeContextMenuAsync(this.visualId.worksheet,p,h)},t.prototype.executeContextMenuAsync=function(p,h){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("external-context-menu-service").executeContextMenuAsync(this.visualId.worksheet,p,h)},t.prototype.renameContextMenuAsync=function(p,h,m){return this.verifyActiveSheet(),A.ApiServiceRegistry.get(this._registryId).getService("external-context-menu-service").renameContextMenuAsync(this.visualId.worksheet,p,h,m)},t.prototype.createDataSourceFromInfo=function(p){var h=new P.DataSourceImpl(p,this._registryId),m=new I.DataSource(h);return h.initializeWithPublicInterfaces(m),m},t.prototype.verifyActiveSheet=function(){var p=this.active,h=this.isInsideActiveDashboard(),m=this.isInsideActiveStoryPoint();if(!p&&!h&&!m)throw new T.TableauError(v.SharedErrorCodes.NotActiveSheet,"Operation not allowed on non-active sheet")},t.prototype.isInsideActiveStoryPoint=function(){return this._parentStoryPointImpl&&this._parentStoryPointImpl.active},t.prototype.isInsideActiveDashboard=function(){return this._parentDashboardImpl&&this._parentDashboardImpl.active},t}(m(1878).SheetImpl);h.WorksheetImpl=E},1110:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p){this._logicalTable=p}return Object.defineProperty(e.prototype,"id",{get:function(){return this._logicalTable.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"caption",{get:function(){return this._logicalTable.caption},enumerable:!0,configurable:!0}),e}();h.LogicalTable=m},3416:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(9887),I=m(316),S=function(){function e(p,h,m,g,y){this._worksheetName=p,this._fieldName=h,this._filterType=m,this._fieldId=g,this._registryId=y}return Object.defineProperty(e.prototype,"worksheetName",{get:function(){return this._worksheetName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldName",{get:function(){return this._fieldName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldId",{get:function(){return this._fieldId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filterType",{get:function(){return this._filterType},enumerable:!0,configurable:!0}),e.prototype.getFieldAsync=function(){return v.ApiServiceRegistry.get(this._registryId).getService("data-source-service").getFieldAsync(this._fieldId)},e.prototype.getAppliedWorksheetsAsync=function(){return v.ApiServiceRegistry.get(this._registryId).getService("filter-service").getAppliedWorksheetsAsync(this._worksheetName,this._fieldId)},e.prototype.setAppliedWorksheetsAsync=function(p){I.ErrorHelpers.verifyParameter(p,"applyToWorksheets");var h=new Set(p);return v.ApiServiceRegistry.get(this._registryId).getService("filter-service").setAppliedWorksheetsAsync(this._worksheetName,this._fieldName,this._fieldId,Array.from(h))},e}();h.Filter=S;var _=function(p){function t(h,m,g,y,b,v,I,S){var _=p.call(this,h,m,y,g,b)||this;return _._appliedValues=v,_._isExcludeMode=I,_._isAllSelected=S,_}return y(t,p),Object.defineProperty(t.prototype,"isAllSelected",{get:function(){return this._isAllSelected},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appliedValues",{get:function(){return this._appliedValues},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isExcludeMode",{get:function(){return this._isExcludeMode},enumerable:!0,configurable:!0}),t.prototype.getDomainAsync=function(p){return p||(p=b.FilterDomainType.Relevant),I.ErrorHelpers.verifyEnumValue(p,b.FilterDomainType,"FilterDomainType"),v.ApiServiceRegistry.get(this._registryId).getService("filter-service").getCategoricalDomainAsync(this._worksheetName,this._fieldId,p)},t}(S);h.CategoricalFilter=_;var A=function(){function e(p,h,m){this._value=p,this._hierarchicalPath=h,this._level=m}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hierarchicalPath",{get:function(){return this._hierarchicalPath},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0}),e}();h.HierarchicalDataValue=A;var T=function(){function e(p,h){this._name=p,this._levelSelectionState=h}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levelSelectionState",{get:function(){return this._levelSelectionState},enumerable:!0,configurable:!0}),e}();h.HierarchicalLevelDetail=T;var w=function(p){function t(h,m,g,y,b,v,I,S,_,A,T){var w=p.call(this,h,m,y,g,b)||this;return w._dimensionName=v,w._hierarchyCaption=I,w._numberOfLevels=S,w._levelDetails=_,w._appliedValues=A,w._isAllSelected=T,w}return y(t,p),t.prototype.getDomainAsync=function(p){throw Error("Method not implemented.")},Object.defineProperty(t.prototype,"dimensionName",{get:function(){return this._dimensionName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hierarchyCaption",{get:function(){return this._hierarchyCaption},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numberOfLevels",{get:function(){return this._numberOfLevels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"levelDetails",{get:function(){return this._levelDetails},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAllSelected",{get:function(){return this._isAllSelected},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appliedValues",{get:function(){return this._appliedValues},enumerable:!0,configurable:!0}),t}(S);h.HierarchicalFilter=w;var P=function(p){function t(h,m,g,y,b,v,I,S){var _=p.call(this,h,m,y,g,b)||this;return _._min=v,_._max=I,_._includeNullValues=S,_}return y(t,p),Object.defineProperty(t.prototype,"minValue",{get:function(){return this._min},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxValue",{get:function(){return this._max},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"includeNullValues",{get:function(){return this._includeNullValues},enumerable:!0,configurable:!0}),t.prototype.getDomainAsync=function(p){var h=v.ApiServiceRegistry.get(this._registryId).getService("filter-service");return p||(p=b.FilterDomainType.Relevant),I.ErrorHelpers.verifyEnumValue(p,b.FilterDomainType,"FilterDomainType"),h.getRangeDomainAsync(this._worksheetName,this._fieldId,p)},t}(S);h.RangeFilter=P;var E=function(p){function t(h,m,g,y,b,v,I,S,_){var A=p.call(this,h,m,y,g,b)||this;return A._anchorDate=v,A._periodType=I,A._rangeType=S,A._rangeN=_,A}return y(t,p),Object.defineProperty(t.prototype,"anchorDate",{get:function(){return this._anchorDate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"periodType",{get:function(){return this._periodType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rangeType",{get:function(){return this._rangeType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rangeN",{get:function(){return this._rangeN},enumerable:!0,configurable:!0}),t}(S);h.RelativeDateFilter=E;var C=function(){function e(p,h){this._values=p,this._domainType=h}return Object.defineProperty(e.prototype,"values",{get:function(){return this._values},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._domainType},enumerable:!0,configurable:!0}),e}();h.CategoricalDomain=C;var D=function(){function e(p,h,m){this._min=p,this._max=h,this._domainType=m}return Object.defineProperty(e.prototype,"type",{get:function(){return this._domainType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._min},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},enumerable:!0,configurable:!0}),e}();h.RangeDomain=D},4284:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p,h,m,g,y,b){this._data=p,this._columns=h,this._totalRowCount=m,this._isTotalRowCountLimited=g,this._isSummaryData=y,this._marksInfo=b,this._name=y?"Summary Data Table":"Underlying Data Table"}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this._columns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marksInfo",{get:function(){return this._marksInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalRowCount",{get:function(){return this._totalRowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTotalRowCountLimited",{get:function(){return this._isTotalRowCountLimited},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSummaryData",{get:function(){return this._isSummaryData},enumerable:!0,configurable:!0}),e}();h.DataTable=m;var g=function(){function e(p,h,m){this._type=p,this._color=h,this._tupleId=m}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tupleId",{get:function(){return this._tupleId},enumerable:!0,configurable:!0}),e}();h.MarkInfo=g;var y=function(){function e(p,h,m,g,y){this._fieldName=p,this._fieldId=h,this._dataType=m,this._isReferenced=g,this._index=y}return Object.defineProperty(e.prototype,"fieldName",{get:function(){return this._fieldName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldId",{get:function(){return this._fieldId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return this._dataType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReferenced",{get:function(){return this._isReferenced},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),e}();h.Column=y;var b=function(){function e(p,h,m){this._value=p,this._nativeValue=h,this._formattedValue=m}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nativeValue",{get:function(){return this._nativeValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedValue",{get:function(){return this._formattedValue},enumerable:!0,configurable:!0}),e}();h.DataValue=b},2513:function(p,h,m){var g=this&&this.__awaiter||function(p,h,m,g){return new(m||(m=Promise))(function(y,b){function o(p){try{l(g.next(p))}catch(p){b(p)}}function s(p){try{l(g.throw(p))}catch(p){b(p)}}function l(p){var h;p.done?y(p.value):((h=p.value)instanceof m?h:new m(function(p){p(h)})).then(o,s)}l((g=g.apply(p,h||[])).next())})},y=this&&this.__generator||function(p,h){var m,g,y,b,v={label:0,sent:function(){if(1&y[0])throw y[1];return y[1]},trys:[],ops:[]};return b={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(b[Symbol.iterator]=function(){return this}),b;function s(b){return function(I){return function(b){if(m)throw TypeError("Generator is already executing.");for(;v;)try{if(m=1,g&&(y=2&b[0]?g.return:b[0]?g.throw||((y=g.return)&&y.call(g),0):g.next)&&!(y=y.call(g,b[1])).done)return y;switch(g=0,y&&(b=[2&b[0],y.value]),b[0]){case 0:case 1:y=b;break;case 4:return v.label++,{value:b[1],done:!1};case 5:v.label++,g=b[1],b=[0];continue;case 7:b=v.ops.pop(),v.trys.pop();continue;default:if(!((y=(y=v.trys).length>0&&y[y.length-1])||6!==b[0]&&2!==b[0])){v=0;continue}if(3===b[0]&&(!y||b[1]>y[0]&&b[1]<y[3])){v.label=b[1];break}if(6===b[0]&&v.label<y[1]){v.label=y[1],y=b;break}if(y&&v.label<y[2]){v.label=y[2],v.ops.push(b);break}y[2]&&v.ops.pop(),v.trys.pop();continue}b=h.call(p,v)}catch(p){b=[6,p],g=0}finally{m=y=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([b,I])}}};Object.defineProperty(h,"__esModule",{value:!0});var b=m(9887),v=m(316),I=function(){function e(p,h,m,g){this._id=p,this._totalRowCount=h,this._pageRowCount=m,this._registryId=g,this._pageCount=Math.ceil(h/m)}return Object.defineProperty(e.prototype,"totalRowCount",{get:function(){return this._totalRowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageCount",{get:function(){return this._pageCount},enumerable:!0,configurable:!0}),e.prototype.getPageAsync=function(p){return v.ErrorHelpers.verifyRange(p,0,this._pageCount),b.ApiServiceRegistry.get(this._registryId).getService("get-data-service").getPageAsync(this._id,p,this._pageRowCount)},e.prototype.getAllPagesAsync=function(p){return g(this,void 0,void 0,function(){var h,m,g,b,v,I,S,_,A,T;return y(this,function(y){switch(y.label){case 0:return[4,this.getPageAsync(0)];case 1:h=y.sent(),v=(b=Math.min(g=Math.ceil((m=Math.min(p=p||this.totalRowCount,this.totalRowCount))/this._pageRowCount),400))<g,I=[],S=1,y.label=2;case 2:return S<b?[4,this.getPageAsync(S)]:[3,5];case 3:_=y.sent(),I.push(_.data),y.label=4;case 4:return S++,[3,2];case 5:return(A=(T=h.data).concat.apply(T,I)).length=m,[2,{name:h.name,data:A,columns:h.columns,totalRowCount:v?b*this._pageRowCount:m,isTotalRowCountLimited:v,isSummaryData:h.isSummaryData}]}})})},e.prototype.releaseAsync=function(){return b.ApiServiceRegistry.get(this._registryId).getService("get-data-service").releaseAsync(this._id)},e}();h.DataTableReader=I},1426:function(p,h){var m,g=this&&this.__extends||(m=function(p,h){return(m=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function n(){this.constructor=p}m(p,h),p.prototype=null===h?Object.create(h):(n.prototype=h.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0});var i=function(){};h.SelectionModel=i;var y=function(p){function t(){var h=null!==p&&p.apply(this,arguments)||this;return h.selectValues=[],h}return g(t,p),t}(i);h.ValueSelectionModel=y;var b=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return g(t,p),t}(y);h.HierarchicalSelectionModel=b;var v=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return g(t,p),t}(i);h.RangeSelectionModel=v;var I=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return g(t,p),t}(y);h.DimensionSelectionModel=I,h.TupleSelectionModel=function(){this.objectIds=[]},h.SelectionModelsContainer=function(){this.hierModelArr=[],this.dimModelArr=[],this.quantModelArr=[]}},2391:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p,h){this._x=p,this._y=h}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e}();h.Point=m},850:(p,h)=>{var m;Object.defineProperty(h,"__esModule",{value:!0}),(m=h.GetDataType||(h.GetDataType={})).Summary="summary",m.Underlying="underlying"},7458:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(8929),y=m(903),b=m(194),v=m(4886),I=m(2429),S=m(879),_=m(5210),A=m(2294),T=m(7658),w=m(7132),P=m(8226),E=m(8434),C=m(8009),D=m(9887);h.registerAllSharedServices=function(p,h,m){D.ApiServiceRegistry.get(h).registerService(new g.AnimationServiceImpl(p,h)),D.ApiServiceRegistry.get(h).registerService(new b.DataSourceServiceImpl(p,h,m)),D.ApiServiceRegistry.get(h).registerService(new v.ExportServiceImpl(p,h)),D.ApiServiceRegistry.get(h).registerService(new _.GetDataServiceImpl(p,h)),D.ApiServiceRegistry.get(h).registerService(new S.FilterServiceImpl(p,h)),D.ApiServiceRegistry.get(h).registerService(new A.NotificationServiceImpl(p)),D.ApiServiceRegistry.get(h).registerService(new T.ParametersServiceImpl(p,h)),D.ApiServiceRegistry.get(h).registerService(new w.SelectionServiceImpl(p,h)),D.ApiServiceRegistry.get(h).registerService(new y.AnnotationServiceImpl(p,h)),D.ApiServiceRegistry.get(h).registerService(new C.ZoneServiceImpl(p,h)),D.ApiServiceRegistry.get(h).registerService(new P.SizeServiceImpl(p,h)),D.ApiServiceRegistry.get(h).registerService(new E.VizServiceImpl(p,h)),D.ApiServiceRegistry.get(h).registerService(new I.ExternalContextMenuServiceImpl(p,h))}},9887:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(1554);window.__tableauApiServiceRegistry=window.__tableauApiServiceRegistry||{};var b=function(){function e(){this._services={}}return e.prototype.registerService=function(p){this._services[p.serviceName]=p},e.prototype.getService=function(p){if(!this._services.hasOwnProperty(p))throw new y.TableauError(g.ErrorCodes.InternalError,"Service not registered: "+p);return this._services[p]},e}(),v=function(){function e(){}return e.get=function(p){if(window.__tableauApiServiceRegistry&&window.__tableauApiServiceRegistry[p]||e.setInstance(p,new b),!window.__tableauApiServiceRegistry[p])throw new y.TableauError(g.ErrorCodes.InternalError,"Service registry failed");return window.__tableauApiServiceRegistry[p]},e.setInstance=function(p,h){window.__tableauApiServiceRegistry||(window.__tableauApiServiceRegistry={}),window.__tableauApiServiceRegistry[p]=h},e.clearRegistry=function(){window.__tableauApiServiceRegistry={}},e}();h.ApiServiceRegistry=v},8929:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(4695),I=m(2336),S=m(316),_=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"animation-service"},enumerable:!0,configurable:!0}),t.prototype.replayAsync=function(p){var h,m=((h={})[v.ParameterId.ReplaySpeed]=1,h);return S.ErrorHelpers.verifyEnumValue(p,b.ReplaySpeedType,"ReplaySpeedType"),m[v.ParameterId.ReplaySpeed]=I.ExternalToInternalEnumMappings.setReplaySpeedType.convert(p),this.execute(v.VerbId.ReplayAnimation,m).then(function(p){})},t}(m(1167).ServiceImplBase);h.AnimationServiceImpl=_},903:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(4695),I=m(5126),S=m(1426),_=m(1554),A=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"annotation-service"},enumerable:!0,configurable:!0}),t.prototype.annotateMarkAsync=function(p,h,m){var g,y=this.parseMarkSelectionIds([h]),b=((g={})[v.ParameterId.FunctionName]="annotateMarkAsync",g[v.ParameterId.VisualId]=p,g[v.ParameterId.AnnotateEnum]=v.AnnotateEnum.Mark,g[v.ParameterId.TargetPoint]={x:0,y:0},g[v.ParameterId.SelectionList]=[y.selection],g[v.ParameterId.FormattedText]="<formatted-text><run>"+m+"</run></formatted-text>",g);return this.execute(v.VerbId.CreateAnnotation,b).then(function(p){})},t.prototype.getAnnotationsAsync=function(p){var h,m=this,g=((h={})[v.ParameterId.FunctionName]="getAnnotationsAsync",h[v.ParameterId.VisualId]=p,h);return this.execute(v.VerbId.GetAnnotations,g).then(function(p){var h=p.result;return m.annotationFilterMap(h)})},t.prototype.removeAnnotationAsync=function(p,h){var m,g=this.parseAnnotationSelectionIds([h]),y=((m={})[v.ParameterId.FunctionName]="removeAnnotationAsync",m[v.ParameterId.VisualId]=p,m[v.ParameterId.SelectionList]=[g.selection],m);return this.execute(v.VerbId.RemoveAnnotation,y).then(function(p){})},t.prototype.parseMarkSelectionIds=function(p){var h=[],m=new S.SelectionModelsContainer;if(p.forEach(function(p){var m=p.tupleId;if(!(null!=m&&m>0))throw new _.TableauError(b.ErrorCodes.InternalError,"invalid tupleId");h.push(m.toString())}),0!==h.length){var g=new S.TupleSelectionModel;g.selectionType="tuples",g.objectIds=h,m.selection=g}return m},t.prototype.parseAnnotationSelectionIds=function(p){var h=[],m=new S.SelectionModelsContainer;if(p.forEach(function(p){var m=p.annotationId;if(!(null!=m&&m>=0))throw new _.TableauError(b.ErrorCodes.InternalError,"invalid annotationId");h.push(m.toString())}),0!==h.length){var g=new S.TupleSelectionModel;g.selectionType="annotations",g.objectIds=h,m.selection=g}return m},t.prototype.mapAnnotation=function(p){return{annotationHTML:p.annotationText,annotationId:p.annotationId,annotationText:p.annotationPlainText,annotationType:I.InternalToExternalEnumMappings.annotationType.convert(p.annotateEnum),tupleId:p.tupleId}},t.prototype.annotationFilterMap=function(p){var h=this;return p.map(function(p){return h.mapAnnotation(p)})},t}(m(1167).ServiceImplBase);h.AnnotationServiceImpl=A},6292:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(4695),v=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"client-info-service"},enumerable:!0,configurable:!0}),t.prototype.getClientInfoAsync=function(){var p,h=b.VerbId.GetEmbeddingClientInfo,m=((p={})[b.ParameterId.FunctionName]="getClientInfoAsync",p);return this.execute(h,m).then(function(p){return p.result})},t}(m(1167).ServiceImplBase);h.ClientInfoServiceImpl=v},194:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(4695),I=m(4695),S=m(6411),_=m(2131),A=m(1234),T=m(8695),w=m(1554),P=m(1167);h.SENTINEL_LOGICAL_TABLE_INFO={id:v.ApiShowDataTableSentinel.SingleTableId,caption:v.ApiShowDataTableSentinel.SingleTableCaption};var E={major:1,minor:20,fix:1},C=function(p){function r(h,m,g){void 0===g&&(g=E);var y=p.call(this,h,m)||this;return y._platformVersion=g,y}return y(r,p),Object.defineProperty(r.prototype,"serviceName",{get:function(){return"data-source-service"},enumerable:!0,configurable:!0}),r.prototype.refreshAsync=function(p){var h,m=((h={})[I.ParameterId.FunctionName]="refreshAsync",h[I.ParameterId.DeltaTimeMs]=0,h[I.ParameterId.ShouldRefreshDS]=!0,h);return p&&(m[I.ParameterId.DataSourceId]=p),this.execute(I.VerbId.RefreshDataSource,m).then(function(p){})},r.prototype.getActiveTablesAsync=function(p){var h,m=((h={})[I.ParameterId.FunctionName]="getActiveTablesAsync",h[I.ParameterId.DataSourceId]=p,h);return this.execute(I.VerbId.GetActiveTables,m).then(function(h){var m=h.result;if(0===m.tables.length)throw new w.TableauError(b.ErrorCodes.UnsupportedMethodForDataSourceType,"getActiveTables is not supported for: "+p);return m.tables})},r.prototype.getDataSourcesAsync=function(p){var h,m=((h={})[I.ParameterId.FunctionName]="getDataSourcesAsync",h[I.ParameterId.VisualId]=p,h);return this.execute(I.VerbId.GetDataSources,m).then(function(p){return p.result})},r.prototype.getAllDataSourcesAsync=function(){var p,h=((p={})[I.ParameterId.FunctionName]="getAllDataSourcesAsync",p);return this.execute(I.VerbId.GetAllDataSources,h).then(function(p){return p.result})},r.prototype.getConnectionSummariesAsync=function(p){var h,m=((h={})[I.ParameterId.FunctionName]="getConnectionSummariesAsync",h[I.ParameterId.DataSourceId]=p,h);return this.execute(I.VerbId.GetConnectionDescriptionSummaries,m).then(function(p){return p.result})},r.prototype.getFieldAsync=function(p){var h,m=this,g=I.VerbId.GetFieldAndDataSource,y=((h={})[I.ParameterId.FunctionName]="getFieldAsync",h[I.ParameterId.FieldId]=p,h);return this.execute(g,y).then(function(p){var h=p.result[I.ParameterId.DataSource],g=p.result[I.ParameterId.Field];return m.convertField(g,m.convertDataSource(h))})},r.prototype.getLogicalTablesAsync=function(p){if(!this.isObjectModelSupportedByPlatform())return new Promise(function(p){return p([h.SENTINEL_LOGICAL_TABLE_INFO])});var m,g=((m={})[I.ParameterId.FunctionName]="getLogicalTablesAsync",m[I.ParameterId.DataSourceId]=p,m);return this.execute(I.VerbId.GetLogicalTables,g).then(function(p){return p.result})},r.prototype.getUnderlyingTablesAsync=function(p){if(!this.isObjectModelSupportedByPlatform())return new Promise(function(p){return p([h.SENTINEL_LOGICAL_TABLE_INFO])});var m,g=((m={})[I.ParameterId.FunctionName]="getUnderlyingTablesAsync",m[I.ParameterId.VisualId]=p,m);return this.execute(I.VerbId.GetUnderlyingTables,g).then(function(p){return p.result})},r.prototype.convertField=function(p,h){return new _.Field(new T.FieldImpl(p,h))},r.prototype.convertDataSource=function(p){return new S.DataSource(new A.DataSourceImpl(p,this._registryId))},r.prototype.isObjectModelSupportedByPlatform=function(){return v.VersionLessThan({major:1,minor:13,fix:0},this._platformVersion)},r}(P.ServiceImplBase);h.DataSourceServiceImpl=C},4886:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)}),b=this&&this.__awaiter||function(p,h,m,g){return new(m||(m=Promise))(function(y,b){function o(p){try{l(g.next(p))}catch(p){b(p)}}function s(p){try{l(g.throw(p))}catch(p){b(p)}}function l(p){var h;p.done?y(p.value):((h=p.value)instanceof m?h:new m(function(p){p(h)})).then(o,s)}l((g=g.apply(p,h||[])).next())})},v=this&&this.__generator||function(p,h){var m,g,y,b,v={label:0,sent:function(){if(1&y[0])throw y[1];return y[1]},trys:[],ops:[]};return b={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(b[Symbol.iterator]=function(){return this}),b;function s(b){return function(I){return function(b){if(m)throw TypeError("Generator is already executing.");for(;v;)try{if(m=1,g&&(y=2&b[0]?g.return:b[0]?g.throw||((y=g.return)&&y.call(g),0):g.next)&&!(y=y.call(g,b[1])).done)return y;switch(g=0,y&&(b=[2&b[0],y.value]),b[0]){case 0:case 1:y=b;break;case 4:return v.label++,{value:b[1],done:!1};case 5:v.label++,g=b[1],b=[0];continue;case 7:b=v.ops.pop(),v.trys.pop();continue;default:if(!((y=(y=v.trys).length>0&&y[y.length-1])||6!==b[0]&&2!==b[0])){v=0;continue}if(3===b[0]&&(!y||b[1]>y[0]&&b[1]<y[3])){v.label=b[1];break}if(6===b[0]&&v.label<y[1]){v.label=y[1],y=b;break}if(y&&v.label<y[2]){v.label=y[2],v.ops.push(b);break}y[2]&&v.ops.pop(),v.trys.pop();continue}b=h.call(p,v)}catch(p){b=[6,p],g=0}finally{m=y=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([b,I])}}};Object.defineProperty(h,"__esModule",{value:!0});var I=m(4695),S=m(1750),_=m(2336),A=m(2561),T=m(316),w=m(1554),P=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"export-service"},enumerable:!0,configurable:!0}),t.prototype.getExportCrosstabSheetMapAsync=function(p){var h,m=I.VerbId.GetExportCrosstabSheetMap,g=((h={})[I.ParameterId.FunctionName]="getExportCrosstabSheetMapAsync",h[I.ParameterId.CurrentSheetType]=_.ExternalToInternalEnumMappings.sheetType.convert(p),h);return this.execute(m,g).then(function(p){return p.result})},t.prototype.exportCrosstabAsync=function(p,h,m,g){return b(this,void 0,void 0,function(){var y,b,_,A;return v(this,function(v){switch(v.label){case 0:return T.ErrorHelpers.verifySheetName(m,p),T.ErrorHelpers.verifyEnumValue(h,S.CrosstabFileFormat,"CrosstabFileFormat"),[4,this.getExportCrosstabSheetMapAsync(g)];case 1:if(!(y=v.sent())[p])throw new w.TableauError(S.SharedErrorCodes.InternalError,"missing sheet doc id from sheetMap");switch((A={})[I.ParameterId.FunctionName]="exportCrosstabAsync",A[I.ParameterId.SheetIdentifier]=y[p],A[I.ParameterId.SendNotifications]=!0,b=A,h){case S.CrosstabFileFormat.CSV:_=I.VerbId.ExportCrosstabCsvDownload,b[I.ParameterId.UseTabDelimiters]=!0;break;case S.CrosstabFileFormat.Excel:_=I.VerbId.ExportCrosstabExcelDownload;break;default:throw new w.TableauError(S.SharedErrorCodes.InternalError,"unsupported Crosstab file format.")}return[2,this.execute(_,b).then(function(p){return p.result}).catch(function(){throw new w.TableauError(S.SharedErrorCodes.CrosstabCreationError,"An unexpected error occurred while generating the document.")})]}})})},t.prototype.exportDataAsync=function(p,h){T.ErrorHelpers.verifyExportDataOptions(h);var m,g,y=Array.from(new Set(h.columnsToIncludeById)),b=I.VerbId.ExportDataDownload,v=((m={})[I.ParameterId.FunctionName]="exportDataAsync",m[I.ParameterId.VisualId]=p,m[I.ParameterId.IgnoreAliases]=null!=(g=h.ignoreAliases)&&g,m[I.ParameterId.ColumnsToIncludeById]=y,m);return this.execute(b,v).then(function(){}).catch(function(){throw new w.TableauError(S.SharedErrorCodes.DataCreationError,"An unexpected error occurred while generating the document.")})},t.prototype.exportPowerPointAsync=function(p,h){T.ErrorHelpers.verifySheetNamesForPDFAndPPT(p,h);var m,g=I.VerbId.ExportPowerpointDownload,y=((m={})[I.ParameterId.FunctionName]="exportPowerPointAsync",m[I.ParameterId.ExportOriginUrl]="",m[I.ParameterId.SelectedSheetNames]=p,m);return this.execute(g,y).then(function(p){return p.result}).catch(function(){throw new w.TableauError(S.SharedErrorCodes.PowerPointCreationError,"An error occured while attempting to generate the PowerPoint file.")})},t.prototype.exportPDFAsync=function(p,h,m){return b(this,void 0,void 0,function(){var g,y,b,_;return v(this,function(v){switch(v.label){case 0:return T.ErrorHelpers.verifyExportPDFOptions(h),T.ErrorHelpers.verifySheetNamesForPDFAndPPT(p,m),[4,this.getExportPDFOptionsAsync()];case 1:return g=v.sent(),A.ExportHelpers.updateInternalExportPDFOptions(g,h,p),y=I.VerbId.ExportPdfDownload,(_={})[I.ParameterId.FunctionName]="exportPDFAsync",_[I.ParameterId.ExportPdfOptions]=g,b=_,[2,this.execute(y,b).then(function(p){return p.result}).catch(function(){throw new w.TableauError(S.SharedErrorCodes.PDFCreationError,"Unable to create PDF because something went wrong. Try again.")})]}})})},t.prototype.getExportPDFOptionsAsync=function(){var p,h=I.VerbId.GetExportPdfOptions,m=((p={})[I.ParameterId.FunctionName]="getExportPdfOptionsAsync",p);return this.execute(h,m).then(function(p){return p.result})},t}(m(1167).ServiceImplBase);h.ExportServiceImpl=P},2429:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(4695),v=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"external-context-menu-service"},enumerable:!0,configurable:!0}),t.prototype.appendContextMenuAsync=function(p,h,m){var g,y=b.VerbId.AppendExternalMenuItem,v=((g={})[b.ParameterId.FunctionName]="appendContextMenuAsync",g[b.ParameterId.WorksheetName]=p,g[b.ParameterId.ExternalMenuItemDisplayName]=m.displayName,g);return this.execute(y,v).then(function(p){return p.result})},t.prototype.removeContextMenuAsync=function(p,h,m){var g,y=b.VerbId.RemoveExternalMenuItem,v=((g={})[b.ParameterId.FunctionName]="removeContextMenuAsync",g[b.ParameterId.WorksheetName]=p,g[b.ParameterId.ExternalMenuItemId]=m,g);return this.execute(y,v).then(function(p){})},t.prototype.executeContextMenuAsync=function(p,h,m){var g,y=b.VerbId.ExecuteExternalMenuItem,v=((g={})[b.ParameterId.FunctionName]="executeContextMenuAsync",g[b.ParameterId.WorksheetName]=p,g[b.ParameterId.ExternalMenuItemId]=m,g);return this.execute(y,v).then(function(p){})},t.prototype.renameContextMenuAsync=function(p,h,m,g){var y,v=b.VerbId.RenameExternalMenu,I=((y={})[b.ParameterId.FunctionName]="renameContextMenuAsync",y[b.ParameterId.WorksheetName]=p,y[b.ParameterId.ExternalMenuHeader]=m,y[b.ParameterId.ExternalMenuDescription]=g,y);return this.execute(v,I).then(function(p){})},t}(m(1167).ServiceImplBase);h.ExternalContextMenuServiceImpl=v},879:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)}),b=this&&this.__awaiter||function(p,h,m,g){return new(m||(m=Promise))(function(y,b){function o(p){try{l(g.next(p))}catch(p){b(p)}}function s(p){try{l(g.throw(p))}catch(p){b(p)}}function l(p){var h;p.done?y(p.value):((h=p.value)instanceof m?h:new m(function(p){p(h)})).then(o,s)}l((g=g.apply(p,h||[])).next())})},v=this&&this.__generator||function(p,h){var m,g,y,b,v={label:0,sent:function(){if(1&y[0])throw y[1];return y[1]},trys:[],ops:[]};return b={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(b[Symbol.iterator]=function(){return this}),b;function s(b){return function(I){return function(b){if(m)throw TypeError("Generator is already executing.");for(;v;)try{if(m=1,g&&(y=2&b[0]?g.return:b[0]?g.throw||((y=g.return)&&y.call(g),0):g.next)&&!(y=y.call(g,b[1])).done)return y;switch(g=0,y&&(b=[2&b[0],y.value]),b[0]){case 0:case 1:y=b;break;case 4:return v.label++,{value:b[1],done:!1};case 5:v.label++,g=b[1],b=[0];continue;case 7:b=v.ops.pop(),v.trys.pop();continue;default:if(!((y=(y=v.trys).length>0&&y[y.length-1])||6!==b[0]&&2!==b[0])){v=0;continue}if(3===b[0]&&(!y||b[1]>y[0]&&b[1]<y[3])){v.label=b[1];break}if(6===b[0]&&v.label<y[1]){v.label=y[1],y=b;break}if(y&&v.label<y[2]){v.label=y[2],v.ops.push(b);break}y[2]&&v.ops.pop(),v.trys.pop();continue}b=h.call(p,v)}catch(p){b=[6,p],g=0}finally{m=y=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([b,I])}}};Object.defineProperty(h,"__esModule",{value:!0});var I=m(1750),S=m(4695),_=m(4695),A=m(4007),T=m(2336),w=m(5126),P=m(3416),E=m(8175),C=m(6077),D=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"filter-service"},enumerable:!0,configurable:!0}),t.prototype.applyFilterAsync=function(p,h,m,g,y){var b,v=_.VerbId.ApplyCategoricalFilter,S=((b={})[_.ParameterId.FunctionName]="applyFilterAsync",b);if(S[_.ParameterId.VisualId]=p,S[_.ParameterId.FieldName]=h,!Array.isArray(m))throw new A.TableauError(I.ErrorCodes.InvalidParameter,"values parameter for applyFilterAsync must be an array");return S[_.ParameterId.FilterValues]=m,S[_.ParameterId.FilterUpdateType]=T.ExternalToInternalEnumMappings.filterUpdateType.convert(g),S[_.ParameterId.IsExcludeMode]=void 0!==y&&void 0!==y.isExcludeMode&&y.isExcludeMode,this.execute(v,S).then(function(p){return h})},t.prototype.applyRangeFilterAsync=function(p,h,m){var g,y,b,v=this,I=_.VerbId.ApplyRangeFilter,S=((b={})[_.ParameterId.FunctionName]="applyRangeFilterAsync",b);return void 0!==m.min&&null!==m.min&&(g=m.min instanceof Date?C.Param.serializeDateForPlatform(m.min):m.min,S[_.ParameterId.FilterRangeMin]=g),void 0!==m.max&&null!==m.max&&(y=m.max instanceof Date?C.Param.serializeDateForPlatform(m.max):m.max,S[_.ParameterId.FilterRangeMax]=y),m.nullOption&&(S[_.ParameterId.FilterRangeNullOption]=T.ExternalToInternalEnumMappings.nullOptions.convert(m.nullOption)),S[_.ParameterId.FieldName]=h,S[_.ParameterId.VisualId]=p,this.execute(I,S).then(function(p){return v.apiFilterHandlerCheckForCommandError(p.result),h})},t.prototype.applyHierarchicalFilterAsync=function(p,h,m,g,y){var b,v=_.VerbId.HierarchicalFilter,I=((b={})[_.ParameterId.FunctionName]="applyHierarchicalFilterAsync",b);I[_.ParameterId.VisualId]=p,I[_.ParameterId.FieldName]=h;var S=m.levels;return Array.isArray(S)&&S.length>0?I[_.ParameterId.FilterLevels]=S:m.length>0?I[_.ParameterId.FilterValues]=m:I[_.ParameterId.FilterLevels]=[],I[_.ParameterId.FilterUpdateType]=T.ExternalToInternalEnumMappings.filterUpdateType.convert(g),I[_.ParameterId.IsExcludeMode]=y&&!!y.isExcludeMode,this.execute(v,I).then(function(p){return h})},t.prototype.clearFilterAsync=function(p,h){var m,g=_.VerbId.ClearFilter,y=((m={})[_.ParameterId.FunctionName]="clearFilterAsync",m);return y[_.ParameterId.VisualId]=p,y[_.ParameterId.FieldName]=h,this.execute(g,y).then(function(p){return h})},t.prototype.applyRelativeDateFilterAsync=function(p,h,m){var g,y=_.VerbId.ApplyRelativeDateFilter,b=((g={})[_.ParameterId.FunctionName]="applyRelativeDateFilterAsync",g);if(b[_.ParameterId.VisualId]=p,b[_.ParameterId.FieldName]=h,b[_.ParameterId.PeriodType]=T.ExternalToInternalEnumMappings.periodType.convert(m.periodType),b[_.ParameterId.DateRangeType]=T.ExternalToInternalEnumMappings.dateRangeType.convert(m.rangeType),m.rangeType===I.DateRangeType.LastN||m.rangeType===I.DateRangeType.NextN){if(void 0===m.rangeN||null===m.rangeN)throw new A.TableauError(I.EmbeddingErrorCodes.MissingRangeNForRelativeDateFilters,"Missing rangeN field for a relative date filter of LASTN or NEXTN.");b[_.ParameterId.RangeN]=m.rangeN}return void 0!==m.anchorDate&&null!==m.anchorDate&&(b[_.ParameterId.AnchorDate]=this.convertAnchorDate(m.anchorDate)),this.execute(y,b).then(function(p){return p.result})},t.prototype.getFiltersAsync=function(p){var h,m=this,g=_.VerbId.GetFilters,y=((h={})[_.ParameterId.FunctionName]="getFiltersAsync",h);return y[_.ParameterId.VisualId]=p,this.execute(g,y).then(function(p){var h=p.result;return m.convertDomainFilters(h)})},t.prototype.getCategoricalDomainAsync=function(p,h,m){var g,y=this,b=_.VerbId.GetCategoricalDomain,v=((g={})[_.ParameterId.FunctionName]="getCategoricalDomainAsync",g);return v[_.ParameterId.VisualId]={worksheet:p},v[_.ParameterId.FieldId]=h,v[_.ParameterId.DomainType]=T.ExternalToInternalEnumMappings.filterDomainType.convert(m),this.execute(b,v).then(function(p){var h=p.result;return y.convertCategoricalDomain(h,m)})},t.prototype.getRangeDomainAsync=function(p,h,m){var g,y=this,b=_.VerbId.GetRangeDomain,v=((g={})[_.ParameterId.FunctionName]="getRangeDomainAsync",g);return v[_.ParameterId.VisualId]={worksheet:p},v[_.ParameterId.FieldId]=h,v[_.ParameterId.DomainType]=T.ExternalToInternalEnumMappings.filterDomainType.convert(m),this.execute(b,v).then(function(p){var h=p.result;return y.convertRangeDomain(h,m)})},t.prototype.getDashboardFiltersAsync=function(){var p,h=this,m=_.VerbId.GetDashboardFilters,g=((p={})[_.ParameterId.FunctionName]="getDashboardFiltersAsync",p);return this.execute(m,g).then(function(p){var m=p.result;return h.convertDomainFilters(m)})},t.prototype.applyDashboardFilterAsync=function(p,h,m,g){var y,b=_.VerbId.DashboardCategoricalFilter,v=((y={})[_.ParameterId.FunctionName]="applyDashboardFilterAsync",y);return v[_.ParameterId.FieldName]=p,v[_.ParameterId.FilterValues]=h,v[_.ParameterId.FilterUpdateType]=T.ExternalToInternalEnumMappings.filterUpdateType.convert(m),v[_.ParameterId.IsExcludeMode]=g&&!!g.isExcludeMode,this.execute(b,v).then(function(p){return p.result})},t.prototype.getAppliedWorksheetsAsync=function(p,h){var m;return b(this,void 0,void 0,function(){var g,y;return v(this,function(b){switch(b.label){case 0:return[4,this.executeGetAppliedWorksheets(p,h,"getAppliedWorksheetsAsync")];case 1:return g=b.sent(),y=[],null===(m=g.worksheets)||void 0===m||m.map(function(p){p.isSelected&&y.push(p.worksheetName)}),[2,y]}})})},t.prototype.setAppliedWorksheetsAsync=function(p,h,m,g){return b(this,void 0,void 0,function(){var y,b,S,T,w;return v(this,function(v){switch(v.label){case 0:return[4,this.executeGetAppliedWorksheets(p,m,"getAppliedWorksheetsAsyncInternal")];case 1:if(!(y=v.sent())||!y.worksheets)throw new A.TableauError(I.SharedErrorCodes.InternalError,"This filter does not apply to multiple worksheets");if(b=[],S="",y.worksheets.forEach(function(p){p.isActive&&(S=p.worksheetName),(p.isSelected||p.isEnabled)&&b.push(p.worksheetName)}),""===S)throw new A.TableauError(I.SharedErrorCodes.InternalError,"No active worksheet");if(!g.includes(S))throw new A.TableauError(I.SharedErrorCodes.InternalError,S+" must be included in the applied worksheets");return g.forEach(function(p){if(!b.includes(p))throw new A.TableauError(I.SharedErrorCodes.InternalError,"The field "+h+" isn't applicable to the worksheet "+p)}),T=_.VerbId.ChangeSharedFilter,(w={})[_.ParameterId.FunctionName]="setAppliedWorksheetsAsync",w[_.ParameterId.VisualId]={worksheet:p},w[_.ParameterId.FieldId]=m,w[_.ParameterId.SharedFilterSheets]=g,[2,this.execute(T,w).then(function(p){return g})]}})})},t.prototype.executeGetAppliedWorksheets=function(p,h,m){var g=_.VerbId.GetSharedFilter,y={};return y[_.ParameterId.FunctionName]=m,y[_.ParameterId.VisualId]={worksheet:p},y[_.ParameterId.FieldId]=h,this.execute(g,y).then(function(p){return p.result})},t.prototype.convertDomainFilters=function(p){var h=this,m=[];return p.forEach(function(p){switch(p.filterType){case _.FilterType.Categorical:if(!(g=p))throw Error("Invalid Categorical Filter");m.push(h.convertCategoricalFilter(g));break;case _.FilterType.Hierarchical:if(!(g=p))throw Error("Invalid Hierarchical Filter");m.push(h.convertHierarchicalFilter(g));break;case _.FilterType.Range:if(!(g=p))throw Error("Invalid Range Filter");m.push(h.convertRangeFilter(g));break;case _.FilterType.RelativeDate:var g;if(!(g=p))throw Error("Invalid Relative Date Filter");m.push(h.convertRelativeDateFilter(g))}}),m},t.prototype.convertCategoricalFilter=function(p){var h=p.values.map(function(p){return E.DataValueFactory.MakeFilterDataValue(p)});return new P.CategoricalFilter(p.visualId.worksheet,p.fieldCaption,p.fieldName,_.FilterType.Categorical,this._registryId,h,p.isExclude,p.isAllSelected)},t.prototype.convertHierarchicalFilter=function(p){var h=p.values.map(function(p){return new P.HierarchicalDataValue(E.DataValueFactory.MakeFilterDataValue(p.value),p.hierarchicalPath,p.level)}),m=p.levelInfo.map(function(p){return new P.HierarchicalLevelDetail(p.name,w.InternalToExternalEnumMappings.hierarchicalLevelSelectionState.convert(p.levelSelectionState))});return new P.HierarchicalFilter(p.visualId.worksheet,p.fieldCaption,p.fieldName,_.FilterType.Hierarchical,this._registryId,p.dimensionName,p.hierarchyCaption,p.levels,m,h,p.isAllSelected)},t.prototype.convertRangeFilter=function(p){var h=E.DataValueFactory.MakeFilterDataValue(p.min),m=E.DataValueFactory.MakeFilterDataValue(p.max);return new P.RangeFilter(p.visualId.worksheet,p.fieldCaption,p.fieldName,_.FilterType.Range,this._registryId,h,m,p.includeNullValues)},t.prototype.convertRelativeDateFilter=function(p){var h=E.DataValueFactory.MakeFilterDataValue(p.anchorDate);return new P.RelativeDateFilter(p.visualId.worksheet,p.fieldCaption,p.fieldName,I.FilterType.RelativeDate,this._registryId,h,w.InternalToExternalEnumMappings.dateStepPeriod.convert(p.periodType),w.InternalToExternalEnumMappings.dateRangeType.convert(p.rangeType),p.rangeN)},t.prototype.convertCategoricalDomain=function(p,h){var m=p.values.map(function(p){return E.DataValueFactory.MakeFilterDataValue(p)});return new P.CategoricalDomain(m,h)},t.prototype.convertRangeDomain=function(p,h){var m=E.DataValueFactory.MakeFilterDataValue(p.min),g=E.DataValueFactory.MakeFilterDataValue(p.max);return new P.RangeDomain(m,g,h)},t.prototype.convertAnchorDate=function(p){var h=p.getUTCFullYear(),m=p.getUTCMonth()+1,g=p.getUTCDate(),y=p.getUTCHours(),b=p.getUTCMinutes(),v=p.getUTCSeconds();if(isNaN(h)||isNaN(m)||isNaN(g)||isNaN(y)||isNaN(b)||isNaN(v))throw new A.TableauError(I.EmbeddingErrorCodes.InvalidDateParameter,"Invalid date parameter: anchorDate");return h+"-"+m+"-"+g+" "+y+":"+b+":"+v},t.prototype.apiFilterHandlerCheckForCommandError=function(p){if(p[S.ParameterId.ParameterError]){if(p[S.ParameterId.InvalidFieldCaption])throw new A.TableauError(I.SharedErrorCodes.InvalidFilterFieldName,p[S.ParameterId.InvalidFieldCaption]);if(p[S.ParameterId.InvalidValues])throw new A.TableauError(I.SharedErrorCodes.InvalidFilterFieldValue,p[S.ParameterId.InvalidValues]);if(p[S.ParameterId.InvalidAggFieldName])throw new A.TableauError(I.SharedErrorCodes.InvalidAggregationFieldName,p[S.ParameterId.InvalidAggFieldName]);throw new A.TableauError(I.SharedErrorCodes.ServerError,"Server Error")}},t}(m(1167).ServiceImplBase);h.FilterServiceImpl=D},5210:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(4695),I=m(8022),S=m(4007),_=m(2336),A=m(4284),T=m(2513),w=m(8175),P=m(850),E=function(p){function t(){var h=null!==p&&p.apply(this,arguments)||this;return h.viewDataTableCacheId=I.v4(),h}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"get-data-service"},enumerable:!0,configurable:!0}),t.prototype.getMaxRowLimit=function(){return 1e4},t.prototype.getViewDataTableCacheId=function(){return this.viewDataTableCacheId},t.prototype.getLimitedMaxRows=function(p){var h=this.getMaxRowLimit()+1;return p>0&&p<h?p:h},t.prototype.getUnderlyingDataAsync=function(p,h,m,g,y,b,I,S){var A,T=this,w=h===P.GetDataType.Summary,E=w?v.VerbId.GetDataSummaryData:v.VerbId.GetUnderlyingData,C=E===v.VerbId.GetUnderlyingData?this.getLimitedMaxRows(I):I,D=((A={})[v.ParameterId.FunctionName]=w?"getSummaryDataAsync":"getUnderlyingDataAsync",A);return D[v.ParameterId.VisualId]=p,D[v.ParameterId.IgnoreAliases]=m,D[v.ParameterId.IgnoreSelection]=g,D[v.ParameterId.IncludeAllColumns]=y,D[v.ParameterId.ColumnsToIncludeById]=this.verifyIncludeColumnArray(b),D[v.ParameterId.MaxRows]=C,D[v.ParameterId.ShowDataTableFormat]=_.ExternalToInternalEnumMappings.showDataTableFormatType.convert(S),this.execute(E,D).then(function(p){var h=p.result;return T.processResultsTable(h.data,h.isSummary)})},t.prototype.getSummaryDataReaderAsync=function(p,h,m,g,y,b,I){var S,A=this,w=((S={})[v.ParameterId.FunctionName]="getSummaryDataReaderAsync",S[v.ParameterId.ViewDataTableCacheId]=this.getViewDataTableCacheId(),S[v.ParameterId.VisualId]=p,S[v.ParameterId.PageRowCount]=h,S[v.ParameterId.IgnoreAliases]=m,S[v.ParameterId.IgnoreSelection]=g,S[v.ParameterId.IncludeAllColumns]=y,S[v.ParameterId.ColumnsToIncludeById]=this.verifyIncludeColumnArray(b),S[v.ParameterId.ShowDataTableFormat]=_.ExternalToInternalEnumMappings.showDataTableFormatType.convert(I),S);return this.execute(v.VerbId.GetDataSummaryDataReader,w).then(function(p){var m=p.result;return new T.DataTableReader(m.id,m.totalRowCount,h,A._registryId)})},t.prototype.getSummaryColumnsInfoAsync=function(p){var h,m=v.VerbId.GetDataSummaryData,g=((h={})[v.ParameterId.FunctionName]="getSummaryColumnsInfoAsync",h[v.ParameterId.VisualId]=p,h[v.ParameterId.IgnoreAliases]=!0,h[v.ParameterId.IgnoreSelection]=!0,h[v.ParameterId.IncludeAllColumns]=!0,h[v.ParameterId.MaxRows]=1,h[v.ParameterId.ShowDataTableFormat]=v.ApiShowDataTableFormat.NativeValuesOnly,h);return this.execute(m,g).then(function(p){return p.result.data.headers.map(function(p){return new A.Column(p.fieldCaption,p.fieldName,p.dataType,p.isReferenced,p.index)})})},t.prototype.getSelectedMarksAsync=function(p){var h,m=this,g=((h={})[v.ParameterId.FunctionName]="getSelectedMarksAsync",h[v.ParameterId.VisualId]=p,h);return this.execute(v.VerbId.GetSelectedMarks,g).then(function(p){return{data:p.result.data.map(function(p){return m.processResultsTable(p,!0)})}})},t.prototype.getHighlightedMarksAsync=function(p){var h,m=this,g=((h={})[v.ParameterId.FunctionName]="getHighlightedMarksAsync",h[v.ParameterId.VisualId]=p,h);return this.execute(v.VerbId.GetHighlightedMarks,g).then(function(p){return{data:p.result.data.map(function(p){return m.processResultsTable(p,!0)})}})},t.prototype.getDataSourceDataAsync=function(p,h,m,g,y,b){var I,S=this,A=((I={})[v.ParameterId.FunctionName]="getDataSourceDataAsync",I[v.ParameterId.DataSourceId]=p,I[v.ParameterId.IgnoreAliases]=h,I[v.ParameterId.MaxRows]=this.getLimitedMaxRows(m),I[v.ParameterId.ColumnsToInclude]=this.verifyIncludeColumnArray(g),I[v.ParameterId.ColumnsToIncludeById]=this.verifyIncludeColumnArray(y),I[v.ParameterId.ShowDataTableFormat]=_.ExternalToInternalEnumMappings.showDataTableFormatType.convert(b),I);return this.execute(v.VerbId.GetDataSourceData,A).then(function(p){var h=p.result;return S.processResultsTable(h.data,!1)})},t.prototype.getLogicalTableDataAsync=function(p,h,m,g,y,b,I){var S,A=this,T=((S={})[v.ParameterId.FunctionName]="getLogicalTableDataAsync",S[v.ParameterId.ColumnsToInclude]=y,S[v.ParameterId.ColumnsToIncludeById]=this.verifyIncludeColumnArray(b),S[v.ParameterId.DataSourceId]=p,S[v.ParameterId.IgnoreAliases]=m,S[v.ParameterId.LogicalTableId]=h,S[v.ParameterId.MaxRows]=this.getLimitedMaxRows(g),S[v.ParameterId.ShowDataTableFormat]=_.ExternalToInternalEnumMappings.showDataTableFormatType.convert(I),S);return this.execute(v.VerbId.GetLogicalTableData,T).then(function(p){var h=p.result;return A.processResultsTable(h.data,!1)})},t.prototype.getLogicalTableDataReaderAsync=function(p,h,m,g,y,b){var I,S=this,A=((I={})[v.ParameterId.FunctionName]="getLogicalTableDataReaderAsync",I[v.ParameterId.ViewDataTableCacheId]=this.getViewDataTableCacheId(),I[v.ParameterId.DataSourceId]=p,I[v.ParameterId.LogicalTableId]=h,I[v.ParameterId.PageRowCount]=m,I[v.ParameterId.IgnoreAliases]=g,I[v.ParameterId.ColumnsToIncludeById]=this.verifyIncludeColumnArray(y),I[v.ParameterId.ShowDataTableFormat]=_.ExternalToInternalEnumMappings.showDataTableFormatType.convert(b),I);return this.execute(v.VerbId.GetLogicalTableDataReader,A).then(function(p){var h=p.result;return new T.DataTableReader(h.id,h.totalRowCount,m,S._registryId)})},t.prototype.getUnderlyingTableDataAsync=function(p,h,m,g,y,b,I,S){var A,T=this,w=((A={})[v.ParameterId.FunctionName]="getUnderlyingTableDataAsync",A[v.ParameterId.VisualId]=p,A[v.ParameterId.LogicalTableId]=h,A[v.ParameterId.IgnoreAliases]=m,A[v.ParameterId.IgnoreSelection]=g,A[v.ParameterId.IncludeAllColumns]=y,A[v.ParameterId.ColumnsToIncludeById]=this.verifyIncludeColumnArray(b),A[v.ParameterId.MaxRows]=this.getLimitedMaxRows(I),A[v.ParameterId.ShowDataTableFormat]=_.ExternalToInternalEnumMappings.showDataTableFormatType.convert(S),A);return this.execute(v.VerbId.GetUnderlyingTableData,w).then(function(p){var h=p.result;return T.processResultsTable(h.data,!1)})},t.prototype.getUnderlyingTableDataReaderAsync=function(p,h,m,g,y,b,I,S){var A,w=this,P=((A={})[v.ParameterId.FunctionName]="getUnderlyingTableDataReaderAsync",A[v.ParameterId.ViewDataTableCacheId]=this.getViewDataTableCacheId(),A[v.ParameterId.VisualId]=p,A[v.ParameterId.LogicalTableId]=h,A[v.ParameterId.IgnoreAliases]=g,A[v.ParameterId.IgnoreSelection]=y,A[v.ParameterId.IncludeAllColumns]=b,A[v.ParameterId.ColumnsToIncludeById]=this.verifyIncludeColumnArray(I),A[v.ParameterId.ShowDataTableFormat]=_.ExternalToInternalEnumMappings.showDataTableFormatType.convert(S),A[v.ParameterId.PageRowCount]=m,A);return this.execute(v.VerbId.GetUnderlyingTableDataReader,P).then(function(p){var h=p.result;return new T.DataTableReader(h.id,h.totalRowCount,m,w._registryId)})},t.prototype.getPageAsync=function(p,h,m){var g,y=this,b=((g={})[v.ParameterId.FunctionName]="getPageAsync",g[v.ParameterId.ViewDataTableCacheId]=this.getViewDataTableCacheId(),g[v.ParameterId.ViewDataTableId]=p,g[v.ParameterId.DataRowIndex]=h*m,g);return this.execute(v.VerbId.GetDataTableReaderPage,b).then(function(h){var m=h.result;return y.processResultsPage(m,p===t.summaryTableId)})},t.prototype.releaseAsync=function(p){var h,m=((h={})[v.ParameterId.FunctionName]="release",h[v.ParameterId.ViewDataTableCacheId]=this.getViewDataTableCacheId(),h[v.ParameterId.ViewDataTableId]=p,h);return this.execute(v.VerbId.ReleaseDataTableReader,m).then(function(p){})},t.prototype.verifyIncludeColumnArray=function(p){if(!Array.isArray(p))throw new S.TableauError(b.ErrorCodes.InvalidParameter,"columnsToInclude and columnsToIncludeById must be valid arrays");return Array.from(new Set(p))},t.prototype.processResultsTable=function(p,h){var m,g=p.headers.map(function(p){return new A.Column(p.fieldCaption,p.fieldName,p.dataType,p.isReferenced,p.index)});p.marks&&(m=p.marks.map(function(p){return new A.MarkInfo(p.type,p.color,p.tupleId)}));var y=!1===h&&p.dataTable.length===this.getMaxRowLimit()+1;y&&(p.dataTable.length-=1);var b=p.dataTable.map(function(p){return p.map(function(p,h){return w.DataValueFactory.MakeTableDataValue(p,g[h].dataType)})});return m?new A.DataTable(b,g,b.length,y,h,m):new A.DataTable(b,g,b.length,y,h)},t.prototype.processResultsPage=function(p,h){var m,g=p.headers.map(function(p){return new A.Column(p.fieldCaption,p.fieldName,p.dataType,p.isReferenced,p.index)});p.marks&&(m=p.marks.map(function(p){return new A.MarkInfo(p.type,p.color,p.tupleId)}));var y=p.dataTable.map(function(p){return p.map(function(p,h){return w.DataValueFactory.MakeTableDataValue(p,g[h].dataType)})});return m?new A.DataTable(y,g,y.length,!1,h,m):new A.DataTable(y,g,y.length,!1,h)},t.summaryTableId="",t}(m(1167).ServiceImplBase);h.GetDataServiceImpl=E},2294:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"notification-service"},enumerable:!0,configurable:!0}),t}(m(333).NotificationServiceImplBase);h.NotificationServiceImpl=b},333:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p,h){this._filterFn=p,this._callbackFn=h}return e.prototype.onNotification=function(p){this._filterFn(p)&&this._callbackFn(p)},e}();h.Registration=m;var g=function(){function e(p){this.dispatcher=p,this._handlers={},this.dispatcher.registerNotificationHandler(this.onNotification.bind(this))}return e.prototype.registerHandler=function(p,h,g){var y=this,b=this._handlers[p]||[],v=new m(h,g);return b.push(v),this._handlers[p]=b,function(){return y.removeRegistration(p,v)}},e.prototype.hasHandlersForNotificationType=function(p){return this._handlers.hasOwnProperty(p)},e.prototype.onNotification=function(p){this.hasHandlersForNotificationType(p.notificationId)&&this._handlers[p.notificationId].forEach(function(h){return h.onNotification(p.data)})},e.prototype.removeRegistration=function(p,h){this.hasHandlersForNotificationType(p)&&(this._handlers[p]=this._handlers[p].filter(function(p){return p!==h}))},e}();h.NotificationServiceImplBase=g},7658:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(4695),I=m(6560),S=m(1554),_=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"parameters-service"},enumerable:!0,configurable:!0}),t.prototype.getParametersForSheetAsync=function(p){var h,m=((h={})[v.ParameterId.FunctionName]="getParametersForSheetAsync",h[v.ParameterId.SheetPath]=p,h);return this.getParametersAsync(m)},t.prototype.getAllParametersAsync=function(){var p,h=((p={})[v.ParameterId.FunctionName]="getParametersForSheetAsync",p);return this.getParametersAsync(h)},t.prototype.getParametersAsync=function(p){var h=this;return this.execute(v.VerbId.GetParametersForSheet,p).then(function(p){return p.result.map(function(p){return new I.ParameterImpl(p,h._registryId)})})},t.prototype.changeParameterValueAsync=function(p,h){var m,g=((m={})[v.ParameterId.FunctionName]="changeParameterValueAsync",m[v.ParameterId.ParameterFieldName]=p,m[v.ParameterId.ParameterValue]=h,m);return this.execute(v.VerbId.ChangeParameterValue,g).then(function(p){return p.result})},t.prototype.findParameterByNameAsync=function(p){return this.findParameterAsync(p,void 0)},t.prototype.findParameterByGlobalFieldNameAsync=function(p){return this.findParameterAsync(void 0,p)},t.prototype.findParameterAsync=function(p,h){var m,g=this,y=((m={})[v.ParameterId.FunctionName]="findParameterAsync",m);if(void 0!==p)y[v.ParameterId.ParameterCaption]=p;else{if(void 0===h)throw new S.TableauError(b.ErrorCodes.InvalidParameter,"name or fieldName must be provided to find parameter");y[v.ParameterId.ParameterFieldName]=h}return this.execute(v.VerbId.FindParameter,y).then(function(p){if("fieldName"in p.result){var h=p.result;return new I.ParameterImpl(h,g._registryId)}})},t}(m(1167).ServiceImplBase);h.ParametersServiceImpl=_},7132:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(4695),I=m(1426),S=m(1554),_=m(6077),A=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"selection-service"},enumerable:!0,configurable:!0}),t.prototype.clearSelectedMarksAsync=function(p){var h,m=((h={})[v.ParameterId.FunctionName]="clearSelectedMarksAsync",h[v.ParameterId.VisualId]=p,h);return this.execute(v.VerbId.ClearSelectedMarks,m).then(function(p){})},t.prototype.selectMarksByValueAsync=function(p,h,m){var g,y=this;if(0===h.length)throw new S.TableauError(b.ErrorCodes.InvalidParameter,"Selection criteria missing for selecting marks by value");var I=this.validateSelectionUpdateType(m),_=this.parseSelectionMarks(h),A=((g={})[v.ParameterId.FunctionName]="selectMarksByValueAsync",g[v.ParameterId.VisualId]=p,g[v.ParameterId.SelectionUpdateType]=I,g);return _.hierModelArr&&_.hierModelArr.length&&(A[v.ParameterId.HierValSelectionModels]=_.hierModelArr),_.quantModelArr&&_.quantModelArr.length&&(A[v.ParameterId.QuantRangeSelectionModels]=_.quantModelArr),_.dimModelArr&&_.dimModelArr.length&&(A[v.ParameterId.DimValSelectionModels]=_.dimModelArr),this.execute(v.VerbId.SelectByValue,A).then(function(p){y.apiFilterHandlerCheckForCommandError(p.result)})},t.prototype.apiFilterHandlerCheckForCommandError=function(p){if(p[v.ParameterId.ParameterError]){if(p[v.ParameterId.InvalidFields])throw new S.TableauError(b.SharedErrorCodes.InvalidSelectionFieldName,p[v.ParameterId.InvalidFields]);if(p[v.ParameterId.InvalidValues])throw new S.TableauError(b.SharedErrorCodes.InvalidSelectionValue,p[v.ParameterId.InvalidValues]);if(p[v.ParameterId.InvalidDates])throw new S.TableauError(b.SharedErrorCodes.InvalidSelectionDate,p[v.ParameterId.InvalidDates])}},t.prototype.selectMarksByIdAsync=function(p,h,m){if(0===h.length)throw new S.TableauError(b.ErrorCodes.InvalidParameter,"Marks info missing for selecting marks by Id");var g,y=this.validateSelectionUpdateType(m),I=this.parseSelectionIds(h),_=((g={})[v.ParameterId.FunctionName]="selectMarksByIdAsync",g[v.ParameterId.VisualId]=p,g[v.ParameterId.SelectionUpdateType]=y,g[v.ParameterId.Selection]=I.selection,g);return this.execute(v.VerbId.SelectByValue,_).then(function(p){})},t.prototype.parseSelectionIds=function(p){for(var h=[],m=new I.SelectionModelsContainer,g=0;g<p.length;g++){var y=p[g].tupleId;if(null==y)throw new S.TableauError(b.ErrorCodes.InternalError,"tupleId parsing error");h.push(y.toString())}if(0!==h.length){var v=new I.TupleSelectionModel;v.selectionType="tuples",v.objectIds=h,m.selection=v}return m},t.prototype.parseSelectionMarks=function(p){for(var h=new I.SelectionModelsContainer,m=0;m<p.length;m++){var g=p[m];if(!g.fieldName||void 0===g.value||null===g.value)throw new S.TableauError(b.ErrorCodes.InternalError,"Selection Criteria parsing error");var y=RegExp("([[A-Za-z0-9]+]).*","g"),v=g.value;if(y.test(g.fieldName)){var _=this.addToParamsList(g.fieldName,g.value);h.hierModelArr.push(_)}else if(void 0!==v.min&&void 0!==v.max){var A=this.addToRangeParamsList(g.fieldName,v);h.quantModelArr.push(A)}else{var T=this.addToParamsList(g.fieldName,g.value);h.dimModelArr.push(T)}}return h},t.prototype.addToParamsList=function(p,h){var m=new I.ValueSelectionModel,g=[];if(h instanceof Array)for(var y=0;y<h.length;y++)g.push(_.Param.serializeParameterValue(h[y]));else g.push(_.Param.serializeParameterValue(h));return m.qualifiedFieldCaption=p,m.selectValues=g,m},t.prototype.addToRangeParamsList=function(p,h){var m=new I.RangeSelectionModel;return m.qualifiedFieldCaption=p,void 0!==h.max&&null!==h.max&&(m.maxValue=_.Param.serializeParameterValue(h.max)),void 0!==h.min&&null!==h.min&&(m.minValue=_.Param.serializeParameterValue(h.min)),m.included=this.validateNullOptionType(h.nullOption),m},t.prototype.validateSelectionUpdateType=function(p){return p===b.SelectionUpdateType.Replace?v.SelectionUpdateType.Replace:p===b.SelectionUpdateType.Add?v.SelectionUpdateType.Add:p===b.SelectionUpdateType.Remove?v.SelectionUpdateType.Remove:v.SelectionUpdateType.Replace},t.prototype.validateNullOptionType=function(p){if(p){if(p===b.FilterNullOption.NullValues)return v.QuantitativeIncludedValues.IncludeNull;if(p===b.FilterNullOption.NonNullValues)return v.QuantitativeIncludedValues.IncludeNonNull;b.FilterNullOption.AllValues}return v.QuantitativeIncludedValues.IncludeAll},t}(m(1167).ServiceImplBase);h.SelectionServiceImpl=A},1167:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(5126),y=m(1554),b=m(4406),v=function(){function e(p,h){this._dispatcher=p,this._registryId=h}return e.prototype.execute=function(p,h){return this._dispatcher.execute(p,h).catch(function(p){var h=g.InternalToExternalEnumMappings.errorCode.convert(p.errorCode,b.ShouldThrow.No);throw new y.TableauError(h,p.message)})},e}();h.ServiceImplBase=v},8226:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(4695),v=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"size-service"},enumerable:!0,configurable:!0}),t.prototype.changeSizeAsync=function(p,h){var m,g,y,v,I,S=((m={})[b.ParameterId.FunctionName]="changeSizeAsync",m[b.ParameterId.SheetName]=p,m[b.ParameterId.MinHeight]=(null===(g=h.minSize)||void 0===g?void 0:g.height)||0,m[b.ParameterId.MinWidth]=(null===(y=h.minSize)||void 0===y?void 0:y.width)||0,m[b.ParameterId.MaxHeight]=(null===(v=h.maxSize)||void 0===v?void 0:v.height)||0,m[b.ParameterId.MaxWidth]=(null===(I=h.maxSize)||void 0===I?void 0:I.width)||0,m);return this.execute(b.VerbId.SetSheetSize,S).then(function(p){})},t}(m(1167).ServiceImplBase);h.SizeServiceImpl=v},2812:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(4695),v=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"story-activation-service"},enumerable:!0,configurable:!0}),t.prototype.activateNextStoryPointAsync=function(){var p,h=b.VerbId.ActivateNextStoryPoint,m=((p={})[b.ParameterId.FunctionName]="activateNextStoryPointAsync",p);return this.execute(h,m).then(function(p){})},t.prototype.activatePreviousStoryPointAsync=function(){var p,h=b.VerbId.ActivatePreviousStoryPoint,m=((p={})[b.ParameterId.FunctionName]="activatePreviousStoryPointAsync",p);return this.execute(h,m).then(function(p){})},t.prototype.activateStoryPointAsync=function(p){var h,m=b.VerbId.ActivateStoryPoint,g=((h={})[b.ParameterId.FunctionName]="activateStoryPointAsync",h);return g[b.ParameterId.StoryPointIndex]=p,this.execute(m,g).then(function(p){})},t.prototype.revertStoryPointAsync=function(p){var h,m=b.VerbId.RevertStoryPoint,g=((h={})[b.ParameterId.FunctionName]="revertStoryPointAsync",h);return g[b.ParameterId.StoryPointIndex]=p,this.execute(m,g).then(function(p){return p.result})},t}(m(1167).ServiceImplBase);h.StoryActivationServiceImpl=v},8434:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(4695),v=m(2913),I=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"viz-service"},enumerable:!0,configurable:!0}),t.prototype.createVizImageAsync=function(p){var h,m=((h={})[b.ParameterId.FunctionName]="createVizImageAsync",h[b.ParameterId.VizAPIInputJson]=JSON.stringify(p),h);return this.execute(b.VerbId.VizAPI,m).then(function(p){return p.result})},t.prototype.activateSheetAsync=function(p){var h,m=((h={})[b.ParameterId.FunctionName]="activateSheetAsync",h[b.ParameterId.SwitchToSheetName]=p,h);return this.execute(b.VerbId.ActivateSheet,m).then(function(){})},t.prototype.getCustomViewsAsync=function(){var p,h=this,m=((p={})[b.ParameterId.FunctionName]="getCustomViewsAsync",p);return this.execute(b.VerbId.GetCustomViews,m).then(function(p){return p.result.map(function(p){return new v.CustomViewImpl(p,h._registryId)})})},t.prototype.showCustomViewAsync=function(p){var h,m=this,g=((h={})[b.ParameterId.FunctionName]="showCustomViewAsync",h[b.ParameterId.CustomViewName]=p,h);return this.execute(b.VerbId.ShowCustomView,g).then(function(p){var h=p.result;return new v.CustomViewImpl(h,m._registryId)})},t.prototype.removeCustomViewAsync=function(p){var h,m=this,g=((h={})[b.ParameterId.FunctionName]="removeCustomViewAsync",h[b.ParameterId.CustomViewName]=p,h);return this.execute(b.VerbId.RemoveCustomView,g).then(function(p){var h=p.result;return new v.CustomViewImpl(h,m._registryId)})},t.prototype.saveCustomViewAsync=function(p){var h,m=this,g=((h={})[b.ParameterId.FunctionName]="saveCustomViewAsync",h[b.ParameterId.CustomViewName]=p,h[b.ParameterId.CustomViewIsDefault]=!1,h);return this.execute(b.VerbId.SaveWorkbookAsCustomView,g).then(function(p){var h=p.result;return new v.CustomViewImpl(h,m._registryId)})},t.prototype.setActiveCustomViewAsDefaultAsync=function(){var p,h=((p={})[b.ParameterId.FunctionName]="setActiveCustomViewAsDefaultAsync",p);return this.execute(b.VerbId.SetActiveCustomViewAsDefault,h).then(function(){})},t.prototype.saveAsync=function(p){var h,m=this,g=((h={})[b.ParameterId.FunctionName]="saveAsync",h[b.ParameterId.CustomViewLuid]=p.luid,h[b.ParameterId.CustomViewName]=p.name,h[b.ParameterId.CustomViewIsDefault]=p.isDefault,h[b.ParameterId.CustomViewIsPublic]=p.shared,h);return this.execute(b.VerbId.UpdateCustomView,g).then(function(p){var h=p.result;return new v.CustomViewImpl(h,m._registryId)})},t.prototype.getCurrentSrcAsync=function(){var p,h=((p={})[b.ParameterId.FunctionName]="getCurrentSrcAsync",p);return this.execute(b.VerbId.GetCurrentSrc,h).then(function(p){return p.result})},t}(m(1167).ServiceImplBase);h.VizServiceImpl=I},8009:function(p,h,m){var g,y=this&&this.__extends||(g=function(p,h){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function r(){this.constructor=p}g(p,h),p.prototype=null===h?Object.create(h):(r.prototype=h.prototype,new r)});Object.defineProperty(h,"__esModule",{value:!0});var b=m(1750),v=m(4695),I=m(2336),S=m(316),_=m(6077),A=function(p){function t(){return null!==p&&p.apply(this,arguments)||this}return y(t,p),Object.defineProperty(t.prototype,"serviceName",{get:function(){return"zone-service"},enumerable:!0,configurable:!0}),t.prototype.setVisibilityAsync=function(p,h,m){var g,y=((g={})[v.ParameterId.FunctionName]="setVisibilityAsync",g[v.ParameterId.Dashboard]=p,g[v.ParameterId.ZoneIdsVisibilityMap]={},g);return _.Param.convertParameterToMap(m,"zoneVisibilityMap").forEach(function(p,m){S.ErrorHelpers.verifyZoneIsValid(h,Number.parseInt(m,10)),S.ErrorHelpers.verifyEnumValue(p,b.DashboardObjectVisibilityType,"DashboardObjectVisibilityType"),y[v.ParameterId.ZoneIdsVisibilityMap][m]=I.ExternalToInternalEnumMappings.setVisibilityType.convert(p)}),this.execute(v.VerbId.SetZoneVisibility,y).then(function(p){})},t.prototype.moveAndResizeAsync=function(p,h,m){var g,y=((g={})[v.ParameterId.Dashboard]=p,g[v.ParameterId.DashboardObjectPositionAndSizeUpdateList]=m,g);return m.forEach(function(p){S.ErrorHelpers.verifyZoneIsValidAndFloating(h,p.dashboardObjectID),S.ErrorHelpers.verifyWidthAndHeightOfDashboardObjectPositionAndSizeUpdate(p)}),this.execute(v.VerbId.MoveAndResizeZones,y).then(function(p){})},t}(m(1167).ServiceImplBase);h.ZoneServiceImpl=A},1738:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(p){this._tableInfo=p}return Object.defineProperty(e.prototype,"name",{get:function(){return this._tableInfo.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._tableInfo.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectionId",{get:function(){return this._tableInfo.connectionId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"customSQL",{get:function(){return this._tableInfo.customSQL},enumerable:!0,configurable:!0}),e}();h.TableSummary=m},1554:function(p,h){var m,g=this&&this.__extends||(m=function(p,h){return(m=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(p,h){p.__proto__=h}||function(p,h){for(var m in h)h.hasOwnProperty(m)&&(p[m]=h[m])})(p,h)},function(p,h){function n(){this.constructor=p}m(p,h),p.prototype=null===h?Object.create(h):(n.prototype=h.prototype,new n)});Object.defineProperty(h,"__esModule",{value:!0});var y=function(p){function t(h,m){var g=p.call(this,h+": "+m)||this;return g._errorCode=h,Object.setPrototypeOf(g,t.prototype),g}return g(t,p),Object.defineProperty(t.prototype,"errorCode",{get:function(){return this._errorCode},enumerable:!0,configurable:!0}),t}(Error);h.TableauError=y},8175:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(4695),y=m(4284),b=function(){function e(){}return e.MakeParameterDataValue=function(p,h){return new y.DataValue(p.value,g.DataTypeConverter.convertStringValueToNativeValue(p.value,h),p.formattedValue)},e.MakeFilterDataValue=function(p){return new y.DataValue(p.value,p.value,p.formattedValue)},e.MakeTableDataValue=function(p,h){return new y.DataValue(p.value,void 0!==p.value?g.DataTypeConverter.convertValueToNativeValue(p.value,h):void 0,p.formattedValue)},e}();h.DataValueFactory=b},9685:(p,h)=>{Object.defineProperty(h,"__esModule",{value:!0});var m=function(){function e(){var p=this;this._promise=new Promise(function(h,m){p._resolve=h,p._reject=m})}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!0,configurable:!0}),e.prototype.resolve=function(p){this._resolve&&this._resolve(p)},e.prototype.reject=function(p){this._reject&&this._reject(p)},e}();h.Deferred=m,h.UnregisterTimeoutInMilliseconds=3e4},4406:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g,y,b=m(1750),v=m(1554),I=function(){function e(p,h){this._mappings=p,this._defaultVal=h}return e.prototype.convert=function(p,h){if(void 0===h&&(h=y.Yes),this._mappings.hasOwnProperty(p))return this._mappings[p];if(void 0!==this._defaultVal&&h!==y.Yes)return this._defaultVal;throw new v.TableauError(b.ErrorCodes.InternalError,"Enum Mapping not found for: "+p)},e}();h.EnumConverter=I,(g=y=h.ShouldThrow||(h.ShouldThrow={})).Yes="yes",g.No="no"},316:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(1554),b=m(6077),v=function(){function e(){}return e.apiNotImplemented=function(p){return new y.TableauError(g.SharedErrorCodes.InternalError,p+" API not yet implemented.")},e.verifyInternalValue=function(p,h){if(null==p)throw new y.TableauError(g.SharedErrorCodes.InternalError,p+" is invalid value for: "+h)},e.verifyParameter=function(p,h){if(null==p)throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,p+" is invalid value for parameter: "+h)},e.verifyParameterType=function(p,h,m){if(typeof p!==h)throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,p+" has invalid type for parameter: "+m+".")},e.verifyStringParameter=function(p,h){if(null==p||""===p)throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,p+" is invalid value for paramter: "+h)},e.verifyEnumValue=function(p,h,m){var b=!1;if(Object.keys(h).forEach(function(m){h[m]===p.toString()&&(b=!0)}),!b)throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,p+" is invalid value for enum: "+m+".")},e.verifyRange=function(p,h,m){if(!(h<=p&&p<m))throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,p+" is invalid value for range: ["+h+".."+m+")")},e.verifyRangeParamType=function(p,h){if(!p&&!h)throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value, at least one of min or max is required.");if(p&&!b.Param.isTypeNumber(p)&&!b.Param.isTypeDate(p))throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value, only Date and number are allowed for parameter min.");if(h&&!b.Param.isTypeNumber(h)&&!b.Param.isTypeDate(h))throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value, only Date and number are allowed for parameter max.");if(p&&h&&typeof p!=typeof h)throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value, parameters min and max should be of the same type.")},e.verifyZoneIsValid=function(p,h){if(!p.has(h))throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value, Dashboard Object Id: "+h+" is not present in dashboard.")},e.verifyZoneIsValidAndFloating=function(p,h){if(!p.has(h)||!p.get(h).isFloating)throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value, Dashboard Object Id: "+h+" is not present or is a fixed zone in the dashboard.")},e.verifyWidthAndHeightOfDashboardObjectPositionAndSizeUpdate=function(p){if(p.width<0||p.height<0)throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,"Unexpected invalid param value for dashboard object ID "+p.dashboardObjectID+": negative widths and heights are not allowed.")},e.verifySheetName=function(p,h){if(!p.includes(h))throw new y.TableauError(g.SharedErrorCodes.InvalidSelectionSheet,"sheetName parameter must belong to a worksheet within the current view")},e.verifyExportDataOptions=function(p){if(!b.Param.isNullOrUndefined(p.ignoreAliases)&&!b.Param.isTypeBool(p.ignoreAliases)||!b.Param.isNullOrUndefined(p.columnsToIncludeById)&&!Array.isArray(p.columnsToIncludeById))throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,"options paramater must be of type ExportDataOptions")},e.verifySheetNamesForPDFAndPPT=function(p,h){if(!Array.isArray(p))throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,"sheetNames parameter must be an array");if(0===p.length)throw new y.TableauError(g.SharedErrorCodes.InternalError,"sheetNames should not be empty");if(!p.every(function(p){return h.exportableSheetNamesFromDashboard.includes(p)})&&!(p.every(function(p){return h.exportableSheetNamesFromWorkbook.includes(p)})||1===p.length&&p[0]===h.currentSheetName))throw new y.TableauError(g.SharedErrorCodes.InvalidSelectionSheet,"sheetNames parameter must have all its entries be exportable sheet names from the dashboard or all its entries be exportable sheet names from the workbook")},e.verifyExportPDFOptions=function(p){try{this.verifyEnumValue(p.orientation,g.PrintOrientation,"PrintOrientation"),this.verifyEnumValue(p.pageSize,g.PrintPageSize,"PrintPageSize"),this.verifyEnumValue(p.scaling,g.PrintScaling,"PrintScaling")}catch(p){throw new y.TableauError(g.SharedErrorCodes.InvalidParameter,"options parameter must be of type ExportPDFOptions")}},e}();h.ErrorHelpers=v},2561:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(4695),y=m(1750),b=m(1554),v=function(){function e(){}return e.updateInternalExportPDFOptions=function(p,h,m){p.currentSheet=m[0],this.updateExportLayoutOptions(p,h),this.updateSheetOptions(p,m)},e.updateExportLayoutOptions=function(p,h){var m=p.exportLayoutOptions;switch(m.imageHeight=this.DefaultLayoutOptions.imageHeight,m.imageWidth=this.DefaultLayoutOptions.imageWidth,h.orientation){case y.PrintOrientation.Landscape:m.pageOrientationOption=g.PageOrientation.Landscape;break;case y.PrintOrientation.Portrait:m.pageOrientationOption=g.PageOrientation.Portrait;break;default:throw new b.TableauError(y.SharedErrorCodes.InternalError,"invalid orientation for ExportPDFOption")}switch(h.pageSize){case y.PrintPageSize.A3:m.pageSizeOption=g.PageSizeOption.A3;break;case y.PrintPageSize.A4:m.pageSizeOption=g.PageSizeOption.A4;break;case y.PrintPageSize.A5:m.pageSizeOption=g.PageSizeOption.A5;break;case y.PrintPageSize.B4:m.pageSizeOption=g.PageSizeOption.B4;break;case y.PrintPageSize.B5:m.pageSizeOption=g.PageSizeOption.B5;break;case y.PrintPageSize.Executive:m.pageSizeOption=g.PageSizeOption.Executive;break;case y.PrintPageSize.Folio:m.pageSizeOption=g.PageSizeOption.Folio;break;case y.PrintPageSize.Ledger:m.pageSizeOption=g.PageSizeOption.Ledger;break;case y.PrintPageSize.Legal:m.pageSizeOption=g.PageSizeOption.Legal;break;case y.PrintPageSize.Letter:m.pageSizeOption=g.PageSizeOption.Letter;break;case y.PrintPageSize.Note:m.pageSizeOption=g.PageSizeOption.Note;break;case y.PrintPageSize.Quarto:m.pageSizeOption=g.PageSizeOption.Quarto;break;case y.PrintPageSize.Statement:m.pageSizeOption=g.PageSizeOption.Statement;break;case y.PrintPageSize.Tabloid:m.pageSizeOption=g.PageSizeOption.Tabloid;break;case y.PrintPageSize.Unspecified:m.pageSizeOption=g.PageSizeOption.Unspecified;break;default:throw new b.TableauError(y.SharedErrorCodes.InternalError,"invalid pageSize for ExportPDFOption")}switch(h.scaling){case y.PrintScaling.AtMost1PageHigh:this.setFitAndScaleValues(m,g.FitPages.FitOneHigh);break;case y.PrintScaling.AtMost1PageWide:this.setFitAndScaleValues(m,g.FitPages.FitOneWide);break;case y.PrintScaling.AtMost2PagesHigh:this.setFitAndScaleValues(m,g.FitPages.FitTwoHigh);break;case y.PrintScaling.AtMost2PagesWide:this.setFitAndScaleValues(m,g.FitPages.FitTwoWide);break;case y.PrintScaling.Automatic:this.setFitAndScaleValues(m,g.PageScalingOption.ScalePctAuto);break;case y.PrintScaling.Perc100:this.setFitAndScaleValues(m,g.PageScalingOption.ScalePct100);break;case y.PrintScaling.Perc200:this.setFitAndScaleValues(m,g.PageScalingOption.ScalePct200);break;case y.PrintScaling.Perc25:this.setFitAndScaleValues(m,g.PageScalingOption.ScalePct25);break;case y.PrintScaling.Perc400:this.setFitAndScaleValues(m,g.PageScalingOption.ScalePct400);break;case y.PrintScaling.Perc50:this.setFitAndScaleValues(m,g.PageScalingOption.ScalePct50);break;case y.PrintScaling.Perc60:this.setFitAndScaleValues(m,g.PageScalingOption.ScalePct60);break;case y.PrintScaling.Perc75:this.setFitAndScaleValues(m,g.PageScalingOption.ScalePct75);break;case y.PrintScaling.Perc80:this.setFitAndScaleValues(m,g.PageScalingOption.ScalePct80);break;case y.PrintScaling.Perc90:this.setFitAndScaleValues(m,g.PageScalingOption.ScalePct90);break;default:throw new b.TableauError(y.SharedErrorCodes.InternalError,"invalid scaling for ExportPDFOption")}},e.updateSheetOptions=function(p,h){for(var m=p.exportLayoutOptions,g=0,y=p.sheetOptions;g<y.length;g++){var b=y[g];b.exportLayoutOptions=m,b.isSelected=h.includes(b.sheet)}},e.setFitAndScaleValues=function(p,h){var m,y=this.DefaultLayoutOptions,b=y.pageFitHorizontal,v=y.pageFitVertical,I=y.pageScaleMode,S=y.pageScalePercent,_=this.fitRegex.exec(h),A=this.pctRegex.exec(h);_?(b=(m=_.slice(1).map(function(p){return Number(p)}))[0],v=m[1],I=g.ScaleMode.ScaleFitPages):A&&(S=A.slice(1).map(function(p){return Number(p)})[0],I=g.ScaleMode.ScalePercentage),p.pageFitHorizontal=b,p.pageFitVertical=v,p.pageScaleMode=I,p.pageScalePercent=S},e.DefaultDataOptions={ignoreAliases:!1,columnsToIncludeById:[]},e.DefaultPDFOptions={scaling:y.PrintScaling.Automatic,pageSize:y.PrintPageSize.Letter,orientation:y.PrintOrientation.Portrait},e.DefaultLayoutOptions={imageHeight:0,imageWidth:0,pageFitHorizontal:1,pageFitVertical:1,pageOrientationOption:g.PageOrientation.Portrait,pageScaleMode:g.ScaleMode.ScaleAuto,pageScalePercent:100,pageSizeOption:g.PageSizeOption.Letter},e.fitRegex=/fit([0-9]+)x([0-9]+)/,e.pctRegex=/pct([0-9]+)/,e}();h.ExportHelpers=v},6077:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(1554),b=m(316),v=function(){function e(){}return e.serializeDateForPlatform=function(p){return p.getUTCFullYear()+"-"+(p.getUTCMonth()+1)+"-"+p.getUTCDate()+" "+p.getUTCHours()+":"+p.getUTCMinutes()+":"+p.getUTCSeconds()},e.serializeBooleanForPlatform=function(p){return p?"true":"false"},e.serializeNumberForPlatform=function(p){return p.toString(10)},e.isTypeNumber=function(p){return"number"==typeof p||p instanceof Number},e.isTypeDate=function(p){return p instanceof Date},e.isTypeString=function(p){return"string"==typeof p||p instanceof String},e.isTypeBool=function(p){return"boolean"==typeof p||p instanceof Boolean},e.isNullOrUndefined=function(p){return null==p},e.serializeParameterValue=function(p){if(e.isTypeNumber(p))return e.serializeNumberForPlatform(p);if(e.isTypeDate(p))return e.serializeDateForPlatform(p);if(e.isTypeBool(p))return e.serializeBooleanForPlatform(p);if(e.isTypeString(p))return p;throw new y.TableauError(g.ErrorCodes.InternalError,"Unexpected invalid value for: "+p)},e.convertParameterToMap=function(p,h){if(b.ErrorHelpers.verifyParameterType(p,"object",h),Array.isArray(p))throw new y.TableauError(g.ErrorCodes.InvalidParameter,"Expecting object or Map for: "+h+".");return p instanceof Map?p:new Map(Object.entries(p))},e.tryParseNumber=function(p){if(e.isNullOrUndefined(p))return{success:!1};if(e.isTypeNumber(p))return{parsed:p,success:!0};var h=p.toString();if("NaN"===h)return{parsed:NaN,success:!0};var m=parseFloat(h);return isNaN(m)?{success:!1}:{parsed:m,success:!0}},e}();h.Param=v},489:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(4695),b=m(1554),v=function(){function e(){}return e.getSheetSizeFromSizeConstraints=function(p){var h=p.minWidth,m=p.minHeight,y=p.maxWidth,b=p.maxHeight;return 0===m&&0===h?0===b&&0===y?{behavior:g.SheetSizeBehavior.Automatic}:{behavior:g.SheetSizeBehavior.AtMost,maxSize:{width:y,height:b}}:0===b&&0===y?{behavior:g.SheetSizeBehavior.AtLeast,minSize:{width:h,height:m}}:b===m&&y===h&&h>0?{behavior:g.SheetSizeBehavior.Exactly,minSize:{width:h,height:m},maxSize:{width:h,height:m}}:{behavior:g.SheetSizeBehavior.Range,minSize:{width:h,height:m},maxSize:{width:0===h&&0===y?2147483647:y,height:b}}},e.createAutomaticSize=function(){return{behavior:g.SheetSizeBehavior.Automatic,minSize:{width:0,height:0},maxSize:{width:0,height:0}}},e.getPublishedSheetInfoByName=function(p,h){return h.find(function(h){return h.name===p})},e.getSheetTypeEnum=function(p){var h;switch(p){case y.SheetType.Worksheet:h=g.SheetType.Worksheet;break;case y.SheetType.Dashboard:h=g.SheetType.Dashboard;break;case y.SheetType.Story:h=g.SheetType.Story;break;default:throw new b.TableauError(g.SharedErrorCodes.ServerError,"Invalid SheetType")}return h},e.isValidSheetSize=function(p){return void 0!==p.behavior},e}();h.SheetUtils=v},8634:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(1554),b=m(9685),v=function(){function e(p){void 0===p&&(p=b.UnregisterTimeoutInMilliseconds),this._timeoutInMilliseconds=p}return e.prototype.getNewPromiseOrThrowIfBusy=function(){var p=this;if(this._deferred)throw new y.TableauError(g.SharedErrorCodes.ApiExecutionError,"This api cannot be executed till previous call is resolved.");return this._deferred=new b.Deferred,this._timeoutId=setTimeout(function(){var h=new y.TableauError(g.SharedErrorCodes.Timeout,"Api failed to complete in "+p._timeoutInMilliseconds/1e3+" seconds");p.reject(h)},this._timeoutInMilliseconds),this._deferred.promise},e.prototype.resolve=function(p){this._deferred&&(clearTimeout(this._timeoutId),this._deferred.resolve(p),this._deferred=void 0)},e.prototype.reject=function(p){this._deferred&&(clearTimeout(this._timeoutId),this._deferred.reject(p),this._deferred=void 0)},e}();h.ShortLivedDeferred=v},6081:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(1750),y=m(1554),b=function(){function e(p,h){var m=p.split("-");this.build=this.getBuildNumber(m[1]);var b=(p=m[0]).split(".").map(function(p){return parseInt(p,10)});if(3!==b.length)throw new y.TableauError(g.ErrorCodes.InternalError,"Invalid version number: "+p);this.major=b[0],this.minor=b[1],this.fix=b[2],this.isAlpha=h}return e.prototype.getBuildNumber=function(p){if(!p)return -1;var h=p.split(".");return h[1]?parseInt(h[1],10):-1},Object.defineProperty(e.prototype,"formattedValue",{get:function(){return this.major+"."+this.minor+"."+this.fix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullFormattedValue",{get:function(){return this.major+"."+this.minor+"."+this.fix+"-pre."+this.build},enumerable:!0,configurable:!0}),e}();h.VersionNumber=b},107:(p,h,m)=>{Object.defineProperty(h,"__esModule",{value:!0});var g=m(4695),y=function(){function e(p,h){var m=this;this._apiDelegateDispatcher=p,this._versionConverter=g.CreateExternalCompatibleVersionConverter(g.INTERNAL_CONTRACT_VERSION,h),this._notificationHandlers=[],p.registerNotificationHandler(function(p){if(0!==m._notificationHandlers.length){var h=m._versionConverter.upgradeNotification(p);m._notificationHandlers.forEach(function(p){p(h)})}})}return e.needsVersionConverter=function(p){return g.VersionLessThan(p,g.INTERNAL_CONTRACT_VERSION)},e.prototype.execute=function(p,h){var m=this;try{var g=this._versionConverter.downgradeExecuteCall(p,h);return this._apiDelegateDispatcher.execute(g.verb,g.parameters).then(function(g){return m._versionConverter.upgradeExecuteReturn(g,p,h)})}catch(p){return Promise.reject(p)}},e.prototype.registerNotificationHandler=function(p){this._notificationHandlers.push(p)},e.prototype.unregisterNotificationHandler=function(p){this._notificationHandlers=this._notificationHandlers.filter(function(h){return h!==p})},e}();h.VersionedExternalApiDispatcher=y},2725:p=>{p.exports=JSON.parse('{"major":1,"minor":131,"fix":0}')}},y={};function r(p){var h=y[p];if(void 0!==h)return h.exports;var m=y[p]={exports:{}};return g[p].call(m.exports,m,m.exports,r),m.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(p){return window}}();var b={};(()=>{Object.defineProperty(b,"X$",{value:!0});let p=r(1750),h=r(4007),m=r(53),g=r(123),y=r(4882),v="undefined"!=typeof VERSION_IS_ALPHA&&VERSION_IS_ALPHA;h.ApiVersion.SetVersionNumber("3.6.0-pre.19",v),window.customElements.define("tableau-viz",y.TableauViz),window.customElements.define("tableau-authoring-viz",g.TableauAuthoringViz),window.customElements.define("tableau-ask-data",m.TableauAskData);let I=Object.assign(Object.assign({},p.EmbeddingErrorCodes),p.SharedErrorCodes);b.SM=I;var S=r(1750);b.qP=S.AnalyticsObjectType,b.JJ=S.AnnotationType,b.qI=S.ApiMenuType,b.G3=S.ClassNameKey,b.QD=S.ColumnType,b.V9=S.CrosstabFileFormat,b.bZ=S.DashboardLayoutChange,b.LN=S.DashboardObjectType,b.g=S.DataType,b.NU=S.DateRangeType,b.Yi=S.DeviceType,b.Xb=S.EmbeddingTableauEventType,b.nF=S.EncodingType,b.TP=S.FieldAggregationType,b.yS=S.FieldRoleType,b.iV=S.FilterDomainType,b.JW=S.FilterNullOption,b.vA=S.FilterType,b._0=S.FilterUpdateType,b.Bd=S.HierarchicalLevelSelectionState,b.Sc=S.IncludeDataValuesOption,b.ZU=S.MarkType,b.fc=S.ParameterValueType,b.tN=S.PeriodType,b.Y4=S.PrintOrientation,b.yw=S.PrintPageSize,b.A1=S.PrintScaling,b.d=S.QuickTableCalcType,b.hP=S.SelectionUpdateType,b.Hx=S.SheetSizeBehavior,b.jy=S.SheetType,b.Sr=S.SortDirection,b.MU=S.TableauDialogType,b.o8=S.Toolbar,b.Tx=S.TrendLineModelType;var _=r(53);b.CG=_.TableauAskData;var A=r(123);b.Wx=A.TableauAuthoringViz;var T=r(4882);b.P4=T.TableauViz})();var v=b.qP,I=b.JJ,S=b.qI,_=b.G3,A=b.QD,T=b.V9,w=b.bZ,P=b.LN,E=b.g,C=b.NU,D=b.Yi,k=b.nF,x=b.SM,O=b.TP,V=b.yS,N=b.iV,M=b.JW,F=b.vA,R=b._0,z=b.Bd,j=b.Sc,U=b.ZU,L=b.fc,W=b.tN,H=b.Y4,B=b.yw,G=b.A1,Y=b.d,Z=b.hP,K=b.Hx,q=b.jy,J=b.Sr,Q=b.CG,X=b.Wx,$=b.MU,ee=b.Xb,et=b.P4,er=b.o8,ei=b.Tx,en=b.X$},9812:function(p,h,m){"use strict";var g=m(5893);let y={logo:(0,g.jsx)("span",{children:"Embedding Playbook"}),project:{link:"https://tab-se.github.io/embedding_playbook"},docsRepositoryBase:"https://github.com/Tab-SE/embedding_playbook",footer:{text:"Tableau Embedding Playbook"}};h.Z=y}},function(p){p.O(0,[774,361,888,179],function(){return p(p.s=3679)}),_N_E=p.O()}]);